import{j as e}from"./jsx-runtime.6940b965.js";import{r as c}from"./index.070054a4.js";import{C as h}from"./CheckIcon.1124cdab.js";import{a as N}from"./http.387f5009.js";import{MarkFavorite as w}from"./MarkFavorite.93211abf.js";import{S as I}from"./Spinner.799b0955.js";import{CreateRoadmapButton as C}from"./CreateRoadmapButton.e4cc72fd.js";import{C as T}from"./CreateRoadmapModal.dbd7d94b.js";import{M as E}from"./map.07b8754f.js";import{i as $}from"./jwt.ab9b7b25.js";import"./popup.a359f713.js";import"./use-toast.fb52de5d.js";import"./toast.1fe7142d.js";import"./index.a98c85f5.js";import"./classname.585fc13a.js";import"./plus.cedba9fe.js";import"./createLucideIcon.3c9fdece.js";import"./roadmap.9fae4e3a.js";import"./use-outside-click.d7ce4a3d.js";import"./use-keydown.bb1f91bb.js";import"./index.3e34842a.js";function f(a){return e.jsxs("a",{className:"rounded-md border border-dashed border-purple-700 px-3 py-1.5 text-purple-400 transition-colors hover:border-gray-700 hover:text-white",href:"/teams",children:[e.jsx("span",{className:"relative -top-[0.5px] mr-1 text-xs font-semibold uppercase text-white",children:"New"})," ",e.jsxs("span",{className:"hidden sm:inline",children:["Announcing roadmaps for teams. ",e.jsx("span",{className:"font-semibold",children:"Learn more!"})]}),e.jsx("span",{className:"inline sm:hidden",children:"Announcing roadmaps for teams!"})]})}function L(a){const{title:s="Start learning ..",message:i="Your progress and favorite roadmaps will show up here."}=a;return e.jsxs("div",{className:"relative flex min-h-full flex-col items-start justify-center py-6 sm:items-center",children:[e.jsxs("h2",{className:"mb-1.5 flex items-center text-lg text-gray-200 sm:text-2xl",children:[e.jsx(h,{additionalClasses:"mr-2 top-[0.5px] w-[16px] h-[16px] sm:w-[20px] sm:h-[20px]"}),s]}),e.jsx("p",{className:"text-sm text-gray-400 sm:text-base",children:i}),e.jsx("p",{className:"mt-5",children:e.jsx(f,{})})]})}function u(a){const{url:s,percentageDone:i,resourceType:t,resourceId:l,resourceTitle:n,isFavorite:r,allowFavorite:d=!0}=a;return e.jsxs("a",{href:s,className:"relative flex flex-col overflow-hidden rounded-md border border-slate-800 bg-slate-900 p-3 text-sm text-slate-400 hover:border-slate-600 hover:text-slate-300",children:[e.jsx("span",{className:"relative z-20",children:n}),e.jsx("span",{className:"absolute bottom-0 left-0 top-0 z-10 bg-[#172a3a]",style:{width:`${i}%`}}),d&&e.jsx(w,{resourceId:l,resourceType:t,favorite:r})]})}function x(a){const{isLoading:s=!1,title:i,icon:t}=a;return e.jsxs("p",{className:"mb-4 flex items-center text-sm text-gray-400",children:[!s&&t,s&&e.jsx("span",{className:"mr-1.5",children:e.jsx(I,{})}),i]})}function S(a){const{progress:s,isLoading:i=!1,customRoadmaps:t}=a,[l,n]=c.useState(!1);return e.jsxs("div",{className:"relative pb-12 pt-4 sm:pt-7",children:[e.jsx("p",{className:"mb-7 text-sm mt-2",children:e.jsx(f,{})}),l&&e.jsx(T,{onClose:()=>n(!1)}),e.jsx(x,{icon:e.jsx(h,{additionalClasses:"mr-1.5 h-[14px] w-[14px]"}),isLoading:i,title:"Your progress and favorite roadmaps."}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:s.map(r=>e.jsx(u,{resourceId:r.resourceId,resourceType:r.resourceType,resourceTitle:r.resourceTitle,isFavorite:r.isFavorite,percentageDone:(r.skipped+r.done)/r.total*100,url:r.resourceType==="roadmap"?`/${r.resourceId}`:`/best-practices/${r.resourceId}`},r.resourceId))}),e.jsxs("div",{className:"mt-5",children:[e.jsx(x,{icon:e.jsx(E,{className:"mr-1.5 h-[14px] w-[14px]"}),title:"Your custom roadmaps"}),t.length===0&&e.jsxs("p",{className:"rounded-md border border-dashed border-gray-800 p-2 text-sm text-gray-600",children:["You haven't created any custom roadmaps yet."," ",e.jsx("button",{className:"text-gray-500 underline underline-offset-2 hover:text-gray-400",onClick:()=>n(!0),children:"Create one!"})]}),t.length>0&&e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:[t.map(r=>e.jsx(u,{resourceId:r.resourceId,resourceType:"roadmap",resourceTitle:r.resourceTitle,percentageDone:(r.skipped+r.done)/r.total*100,url:`/r?id=${r.resourceId}`,allowFavorite:!1},r.resourceId)),e.jsx(C,{})]})]})]})}function F(a){a.forEach(s=>{const i=s.resourceType==="best-practice"?`/best-practices/${s.resourceId}`:`/${s.resourceId}`,t=document.querySelector(`a[href="${i}"]`);if(!t)return;window.dispatchEvent(new CustomEvent("mark-favorite",{detail:{resourceId:s.resourceId,resourceType:s.resourceType,isFavorite:s.isFavorite}}));const n=(s.done+s.skipped)/s.total*100,r=t.querySelector("[data-progress]");r&&(r.style.width=`${n}%`)})}function _(){if(!$())return null;const[s,i]=c.useState(!0),[t,l]=c.useState(!0),[n,r]=c.useState([]),[d,g]=c.useState(0);function j(){const o=document.getElementById("hero-text");o&&(o.classList.add("opacity-0"),setTimeout(()=>{o.parentElement?.removeChild(o),i(!1),setTimeout(()=>{g(100)},50)},0))}async function m(){l(!0);const{response:o,error:b}=await N("https://api.roadmap.sh/v1-get-hero-roadmaps");b||!o||(r(o),l(!1),j(),F(o))}if(c.useEffect(()=>{m().finally(()=>{l(!1)})},[]),c.useEffect(()=>(window.addEventListener("refresh-favorites",m),()=>window.removeEventListener("refresh-favorites",m)),[]),s)return null;const p=n?.length>0,v=n?.filter(o=>o.isCustomResource),y=n?.filter(o=>!o.isCustomResource);return e.jsx("div",{className:`transition-opacity duration-500  opacity-${d}`,children:e.jsx("div",{className:`flex min-h-[192px] bg-gradient-to-b sm:min-h-[280px] ${p&&"border-t border-t-[#1e293c]"}`,children:e.jsxs("div",{className:"container min-h-full",children:[!t&&n?.length==0&&e.jsx(L,{}),p&&e.jsx(S,{customRoadmaps:v,progress:y,isLoading:t})]})})})}export{_ as FavoriteRoadmaps};
