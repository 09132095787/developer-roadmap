import{h as c,p as u}from"./hooks.module.ee390651.js";import{a as w,T as f}from"./jwt.1d42f94f.js";import{a as I}from"./http.e11c6b00.js";import"./preact.module.e54f245b.js";const g="githubRedirectAt",l="githubLastPage";function v(S){const[b,t]=c(!1),[R,a]=c("");return u(()=>{const e=new URLSearchParams(window.location.search),m=e.get("code"),h=e.get("state"),d=e.get("provider");!m||!h||d!=="github"||(t(!0),I(`https://api.roadmap.sh/v1-github-callback${window.location.search}`).then(({response:o,error:p})=>{if(!o?.token){const r=p?.message||"Something went wrong.";a(r),t(!1);return}let n="/";const i=localStorage.getItem(g),s=localStorage.getItem(l);if(i&&s){const r=parseInt(i,10);Date.now()-r<30*1e3&&(n=s)}localStorage.removeItem(g),localStorage.removeItem(l),w.set(f,o.token),window.location.href=n}).catch(o=>{a("Something went wrong. Please try again later."),t(!1)}))},[]),null}export{v as GitHubButton};
