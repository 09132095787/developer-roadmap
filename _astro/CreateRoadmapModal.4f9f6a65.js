import{j as e}from"./jsx-runtime.6940b965.js";import{r as a}from"./index.070054a4.js";import{M as C,L as v}from"./roadmap.9c1903ec.js";import{u as R}from"./use-toast.fb52de5d.js";import{h as S}from"./http.387f5009.js";import{c as o}from"./classname.585fc13a.js";const T=["role","skill"];function z(N){const{onClose:n,onCreated:p,teamId:r,type:w="role"}=N,u=a.useRef(null),i=R(),[s,d]=a.useState(!1),[c,x]=a.useState(""),[l,h]=a.useState(""),[m,b]=a.useState(w),g=l?.trim().length>80;async function f(t,k=!0){if(t.preventDefault(),s)return;if(c.trim()===""||g||!m){i.error("Please fill all the fields");return}d(!0);const{response:y,error:j}=await S("https://api.roadmap.sh/v1-create-roadmap",{title:c,description:l,type:m,...r&&{teamId:r},nodes:[],edges:[]});if(j){d(!1),i.error(j?.message||"Something went wrong, please try again");return}if(i.success("Roadmap created successfully"),k){window.location.href=`https://draw.roadmap.sh/${y?._id}`;return}if(p){p(y);return}n(),x(""),h(""),b("role"),d(!1)}return a.useEffect(()=>{u.current?.focus()},[]),e.jsxs(C,{onClose:n,bodyClassName:"p-4",wrapperClassName:o(r&&"max-w-lg"),children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Create Roadmap"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Add a title and description to your roadmap."})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"title",className:"block text-xs uppercase text-gray-400",children:"Roadmap Title"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{ref:u,type:"text",name:"title",id:"title",required:!0,className:"block w-full rounded-md border border-gray-300 px-2.5 py-2 outline-none focus:border-black sm:text-sm",placeholder:"Enter Title",value:c,onChange:t=>x(t.target.value)})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"description",className:"block text-xs uppercase text-gray-400",children:"Description"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("textarea",{id:"description",name:"description",required:!0,className:o("block h-24 w-full resize-none rounded-md border border-gray-300 px-2.5 py-2 outline-none focus:border-black sm:text-sm",g&&"border-red-300 bg-red-100"),placeholder:"Enter Description",value:l,onChange:t=>h(t.target.value)}),e.jsxs("div",{className:"absolute bottom-2 right-2 text-xs text-gray-400",children:[l.length,"/80"]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"type",className:"block text-xs uppercase text-gray-400",children:"Type"}),e.jsx("div",{className:"mt-1",children:e.jsx("select",{id:"type",name:"type",required:!0,className:"block w-full rounded-md border border-gray-300 px-2.5 py-2 outline-none focus:border-black sm:text-sm",value:m,onChange:t=>b(t.target.value),children:T.map(t=>e.jsxs("option",{value:t,children:[t.charAt(0).toUpperCase()+t.slice(1)," Based Roadmap"]},t))})})]}),e.jsxs("div",{className:o("mt-4 flex justify-between gap-2",r&&"mt-8"),children:[e.jsx("button",{onClick:n,type:"button",className:o("block h-9 rounded-md border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-black outline-none hover:border-gray-300 hover:bg-gray-50 focus:border-gray-300 focus:bg-gray-100",!r&&"w-full"),children:"Cancel"}),e.jsxs("div",{className:o("flex items-center gap-2",!r&&"w-full"),children:[r&&!s&&e.jsx("button",{disabled:s,type:"button",onClick:t=>f(t,!1),className:"flex h-9 items-center justify-center rounded-md border border-black bg-white px-4 py-2 text-sm font-medium text-black outline-none hover:bg-black hover:text-white focus:bg-black focus:text-white",children:s?e.jsx(v,{size:16,className:"animate-spin"}):"Save as Placeholder"}),e.jsx("button",{disabled:s,type:"submit",className:o("flex h-9 items-center justify-center rounded-md border border-transparent bg-black px-4 py-2 text-sm font-medium text-white outline-none hover:bg-gray-800 focus:bg-gray-800",r?"hidden sm:flex":"w-full"),children:s?e.jsx(v,{size:16,className:"animate-spin"}):r?"Continue to Editor":"Create"})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"mt-4 hidden rounded-md border border-orange-200 bg-orange-50 p-2.5 text-sm text-orange-600 sm:block",children:["Preparing the roadmap might take some time, feel free to save it as a placeholder and anyone with the role ",e.jsx("strong",{children:"admin"})," ","or ",e.jsx("strong",{children:"manager"})," can prepare it later."]}),e.jsx("p",{className:"mt-4 rounded-md border border-orange-200 bg-orange-50 p-2.5 text-sm text-orange-600 sm:hidden",children:"Create a placeholder now and prepare it later."})]})]})]})}export{z as C};
