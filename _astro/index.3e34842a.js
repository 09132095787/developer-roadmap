import{a as r}from"./index.a98c85f5.js";const m=5,d=6,u=10;let v=(n,a,i,f)=>(n.events=n.events||{},n.events[i+u]||(n.events[i+u]=f(e=>{n.events[i].reduceRight((l,t)=>(t(l),l),{shared:{},...e})})),n.events[i]=n.events[i]||[],n.events[i].push(a),()=>{let e=n.events[i],l=e.indexOf(a);e.splice(l,1),e.length||(delete n.events[i],n.events[i+u](),delete n.events[i+u])}),p=1e3,T=(n,a)=>v(n,f=>{let e=a(f);e&&n.events[d].push(e)},m,f=>{let e=n.listen;n.listen=(...t)=>(!n.lc&&!n.active&&(n.active=!0,f()),e(...t));let l=n.off;return n.events[d]=[],n.off=()=>{l(),setTimeout(()=>{if(n.active&&!n.lc){n.active=!1;for(let t of n.events[d])t();n.events[d]=[]}},p)},()=>{n.listen=e,n.off=l}}),O=(n,a)=>{Array.isArray(n)||(n=[n]);let i,f=()=>{let l=n.map(t=>t.get());(i===void 0||l.some((t,s)=>t!==i[s]))&&(i=l,e.set(a(...l)))},e=r(void 0,Math.max(...n.map(l=>l.l))+1);return T(e,()=>{let l=n.map(t=>t.listen(f,e.l));return f(),()=>{for(let t of l)t()}}),e};export{O as c};
