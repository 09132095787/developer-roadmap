import{j as e}from"./jsx-runtime.6940b965.js";import{r as c}from"./index.070054a4.js";import{a as R,T as b}from"./jwt.5556697d.js";import{a as u}from"./http.3e3d4bea.js";import{S as v}from"./Spinner.799b0955.js";function E(d){const{className:a}=d;return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 90 92",fill:"none",className:a,children:[e.jsx("path",{d:"M90 47.1c0-3.1-.3-6.3-.8-9.3H45.9v17.7h24.8c-1 5.7-4.3 10.7-9.2 13.9l14.8 11.5C85 72.8 90 61 90 47.1z",fill:"#4280ef"}),e.jsx("path",{d:"M45.9 91.9c12.4 0 22.8-4.1 30.4-11.1L61.5 69.4c-4.1 2.8-9.4 4.4-15.6 4.4-12 0-22.1-8.1-25.8-18.9L4.9 66.6c7.8 15.5 23.6 25.3 41 25.3z",fill:"#34a353"}),e.jsx("path",{d:"M20.1 54.8c-1.9-5.7-1.9-11.9 0-17.6L4.9 25.4c-6.5 13-6.5 28.3 0 41.2l15.2-11.8z",fill:"#f6b704"}),e.jsx("path",{d:"M45.9 18.3c6.5-.1 12.9 2.4 17.6 6.9L76.6 12C68.3 4.2 57.3 0 45.9.1c-17.4 0-33.2 9.8-41 25.3l15.2 11.8c3.7-10.9 13.8-18.9 25.8-18.9z",fill:"#e54335"})]})}const g="googleRedirectAt",m="googleLastPage";function k(d){const[a,o]=c.useState(!1),[h,n]=c.useState("");c.useEffect(()=>{const t=new URLSearchParams(window.location.search),r=t.get("code"),i=t.get("state"),S=t.get("provider");!r||!i||S!=="google"||(o(!0),u(`https://api.roadmap.sh/v1-google-callback${window.location.search}`).then(({response:s,error:j})=>{if(!s?.token){n(j?.message||"Something went wrong."),o(!1);return}let l="/";const f=localStorage.getItem(g),p=localStorage.getItem(m);if(f&&p){const I=parseInt(f,10);Date.now()-I<30*1e3&&(l=p)}const w=localStorage.getItem("authRedirect");w&&(localStorage.removeItem("authRedirect"),l=w),localStorage.removeItem(g),localStorage.removeItem(m),R.set(b,s.token,{path:"/",expires:30,domain:".roadmap.sh"}),window.location.href=l}).catch(s=>{n("Something went wrong. Please try again later."),o(!1)}))},[]);const x=()=>{o(!0),u("https://api.roadmap.sh/v1-google-login").then(({response:t,error:r})=>{if(!t?.loginUrl){n(r?.message||"Something went wrong."),o(!1);return}if(!["/login","/signup"].includes(window.location.pathname)){const i=["/respond-invite","/befriend"].includes(window.location.pathname)?window.location.pathname+window.location.search:window.location.pathname;localStorage.setItem(g,Date.now().toString()),localStorage.setItem(m,i)}window.location.href=t.loginUrl}).catch(t=>{n("Something went wrong. Please try again later."),o(!1)})};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"inline-flex h-10 w-full items-center justify-center gap-2 rounded border border-slate-300 bg-white p-2 text-sm font-medium text-black outline-none focus:ring-2 focus:ring-[#333] focus:ring-offset-1 disabled:cursor-not-allowed disabled:opacity-60",disabled:a,onClick:x,children:[a?e.jsx(v,{className:"h-[18px] w-[18px]",isDualRing:!1}):e.jsx(E,{className:"h-[18px] w-[18px]"}),"Continue with Google"]}),h&&e.jsx("p",{className:"mb-2 mt-1 text-sm font-medium text-red-600",children:h})]})}export{k as GoogleButton};
