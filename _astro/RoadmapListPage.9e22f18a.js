import{j as e}from"./jsx-runtime.6940b965.js";import{r as m}from"./index.070054a4.js";import{c as v,a as N}from"./http.408ee04f.js";import{p as h}from"./page.2efb91d4.js";import{C as w}from"./CreateRoadmapModal.e596f358.js";import{u as g}from"./use-toast.dbd347db.js";import{R}from"./roadmap.98480e4e.js";import{M as S}from"./more-vertical.fd1e64f8.js";import{u as k}from"./use-outside-click.5adb83b9.js";import{M as C,L as b,S as I}from"./ShareOptionsModal.dff6012e.js";import{S as j}from"./shapes.18fdadc5.js";import{T as _}from"./trash-2.c5096478.js";import{P as M,E as y,G as D}from"./pen-square.d5418dc6.js";import{U as f}from"./users.9673a18c.js";import{M as L}from"./map.07b8754f.js";import"./jwt.ab9b7b25.js";import"./index.4b590221.js";import"./Modal.f242e82e.js";import"./use-keydown.bb1f91bb.js";import"./classname.fdb4949b.js";import"./tw-merge.ecc400cc.js";import"./loader-2.7ee93c0d.js";import"./createLucideIcon.3c9fdece.js";import"./toast.5b8c89b6.js";import"./use-copy-text.77785bb1.js";import"./copy.2caf0f52.js";import"./users-2.dc7091e7.js";import"./check-circle.045c0bed.js";function z(n){const{onDelete:s,onUpdateSharing:l,onCustomize:o}=n,t=m.useRef(null),[a,r]=m.useState(!1);return k(t,()=>{r(!1)}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{disabled:!1,onClick:()=>r(!a),className:"hidden items-center opacity-60 transition-opacity hover:opacity-100 disabled:cursor-not-allowed disabled:opacity-30 sm:flex",children:e.jsx("img",{alt:"menu",src:S.src,className:"h-4 w-4"})}),e.jsxs("button",{disabled:!1,onClick:()=>r(!a),className:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-none sm:hidden",children:[e.jsx(C,{size:14}),"Options"]}),a&&e.jsx("div",{ref:t,className:"align-right absolute right-auto top-full z-50 mt-1 w-[140px] rounded-md bg-slate-800 px-2 py-2 text-white shadow-md sm:right-0",children:e.jsxs("ul",{children:[l&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{r(!1),l()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(b,{size:14,className:"mr-2"}),"Sharing"]})}),o&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{r(!1),o()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(j,{size:14,className:"mr-2"}),"Customize"]})}),s&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{r(!1),s()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(_,{size:14,className:"mr-2"}),"Delete"]})})]})})]})}function $(n){const{roadmaps:s,onDelete:l,setAllRoadmaps:o}=n,t=g(),[a,r]=m.useState(null);async function p(i){const{response:d,error:c}=await v(`https://api.roadmap.sh/v1-delete-roadmap/${i}`);if(c||!d){console.error(c),t.error(c?.message||"Something went wrong, please try again");return}t.success("Roadmap deleted"),l(i)}async function x(i){h.set("Deleting roadmap"),p(i).finally(()=>{h.set("")})}const u=a&&e.jsx(I,{isDiscoverable:a.isDiscoverable,description:a.description,visibility:a.visibility,sharedFriendIds:a.sharedFriendIds,sharedTeamMemberIds:a.sharedTeamMemberIds,roadmapId:a._id,onClose:()=>r(null),onShareSettingsUpdate:i=>{o(d=>({...d,personalRoadmaps:d.personalRoadmaps.map(c=>c._id===a._id?{...c,...i}:c)}))}});return s.length===0?e.jsxs("div",{className:"flex flex-col items-center p-4 py-20",children:[e.jsx("img",{alt:"roadmap",src:R.src,className:"mb-4 h-24 w-24 opacity-10"}),e.jsx("h3",{className:"mb-1 text-2xl font-bold text-gray-900",children:"No roadmaps"}),e.jsx("p",{className:"text-base text-gray-500",children:"Create a roadmap to get started"})]}):e.jsxs("div",{children:[u,e.jsx("div",{className:"mb-3 flex items-center justify-between",children:e.jsxs("span",{className:"text-sm text-gray-400",children:[s.length," custom roadmap(s)"]})}),e.jsx("ul",{className:"flex flex-col divide-y rounded-md border",children:s.map(i=>e.jsx(T,{roadmap:i,onRemove:x,setSelectedRoadmap:r},i._id))})]})}function T(n){const{roadmap:s,onRemove:l,setSelectedRoadmap:o}=n,t=`https://draw.roadmap.sh/${s._id}`;return e.jsxs("li",{className:"grid grid-cols-1 p-2.5 sm:grid-cols-[auto_172px]",children:[e.jsxs("div",{className:"mb-3 grid grid-cols-1 sm:mb-0",children:[e.jsx("p",{className:"mb-1.5 truncate text-base font-medium leading-tight text-black",children:s.title}),e.jsxs("span",{className:"flex items-center text-xs leading-none text-gray-400",children:[e.jsx(F,{visibility:s.visibility,sharedFriendIds:s.sharedFriendIds}),e.jsx("span",{className:"mx-2 font-semibold",children:"Â·"}),e.jsx(j,{size:16,className:"mr-1 inline-block h-4 w-4"}),s.topics," topic"]})]}),e.jsxs("div",{className:"mr-1 flex items-center justify-start sm:justify-end",children:[e.jsx(z,{onUpdateSharing:()=>{o(s)},onCustomize:()=>{window.open(t,"_blank")},onDelete:()=>{confirm("Are you sure you want to remove this roadmap?")&&l(s._id).finally(()=>{})}}),e.jsxs("a",{href:t,className:"ml-2 flex items-center gap-2 rounded-md border border-gray-300 bg-white px-2.5 py-1.5 text-xs text-black hover:bg-gray-50 focus:outline-none",target:"_blank",children:[e.jsx(M,{className:"inline-block h-4 w-4"}),"Edit"]}),e.jsxs("a",{href:`/r?id=${s._id}`,className:"ml-2 flex items-center gap-2 rounded-md border border-blue-400 bg-white px-2 py-1.5 text-xs hover:bg-blue-50 focus:outline-none text-blue-600",target:"_blank",children:[e.jsx(y,{className:"inline-block h-4 w-4"}),"Visit"]})]})]},s._id)}const P={public:{icon:D,label:"Public"},me:{icon:b,label:"Only me"},team:{icon:f,label:"Team Member(s)"},friends:{icon:f,label:"Friend(s)"}};function F(n){const{visibility:s,sharedFriendIds:l=[]}=n,{label:o,icon:t}=P[s];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 whitespace-nowrap text-xs font-normal",children:[e.jsx(t,{className:"inline-block h-3 w-3"}),e.jsxs("div",{className:"flex items-center",children:[s==="friends"&&l?.length>0&&e.jsx("span",{className:"mr-1",children:l.length}),o]})]})}function E(n){const{roadmaps:s}=n,l=new Set(s.map(t=>t.creator.id)),o=[];for(const t of l){const a=s.find(r=>r.creator.id===t)?.creator;a&&o.push({creator:a,roadmaps:s.filter(r=>r.creator.id===t)})}return s.length===0?e.jsxs("div",{className:"flex flex-col items-center p-4 py-20",children:[e.jsx(L,{className:"mb-4 h-24 w-24 opacity-10"}),e.jsx("h3",{className:"mb-1 text-2xl font-bold text-gray-900",children:"No roadmaps"}),e.jsx("p",{className:"text-base text-gray-500",children:"Roadmaps from your friends will appear here"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-3 flex items-center justify-between",children:e.jsxs("span",{className:"text-sm text-gray-400",children:[s.length," shared roadmap(s)"]})}),e.jsx("div",{children:e.jsx("ul",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:o.map(t=>{const a=t.creator;return e.jsxs("li",{className:"flex flex-col items-start overflow-hidden rounded-md border border-gray-300",children:[e.jsxs("div",{className:"relative flex w-full items-center gap-3 p-3",children:[e.jsx("img",{src:a.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${a.avatar}`:"/images/default-avatar.png",alt:a.name||"",className:"h-8 w-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("h3",{className:"truncate font-medium",children:a.name}),e.jsxs("p",{className:"truncate text-sm text-gray-500",children:[t?.roadmaps?.length||0," shared roadmap(s)"]})]})]}),e.jsx("ul",{className:"w-full",children:t?.roadmaps?.map(r=>e.jsx("li",{className:"relative flex w-full border-t",children:e.jsxs("a",{href:`/r?id=${r._id}`,className:"group inline-grid w-full grid-cols-[auto,16px] items-center justify-between gap-2 px-3 py-2 text-sm text-gray-600 transition-colors hover:bg-gray-100 hover:text-black",target:"_blank",children:[e.jsx("span",{className:"w-full truncate",children:r.title}),e.jsx(y,{size:16,className:"opacity-20 transition-opacity group-hover:opacity-100"})]})},r._id))})]},a.id)})})})]})}const O=[{label:"Personal",value:"personal"},{label:"Shared by Friends",value:"shared"}];function ue(){const n=g(),[s,l]=m.useState(!0),[o,t]=m.useState(!1),[a,r]=m.useState("personal"),[p,x]=m.useState({personalRoadmaps:[],sharedRoadmaps:[]});async function u(){l(!0);const{response:i,error:d}=await N("https://api.roadmap.sh/v1-get-user-roadmap-list");if(d||!i){console.error(d),n.error(d?.message||"Something went wrong, please try again");return}x(i||{personalRoadmaps:[],sharedRoadmaps:[]})}return m.useEffect(()=>{u().finally(()=>{l(!1),h.set("")})},[]),s?null:e.jsxs("div",{children:[o&&e.jsx(w,{onClose:()=>t(!1)}),e.jsxs("div",{className:"mb-6 flex flex-col justify-between gap-2 sm:flex-row sm:items-center sm:gap-0",children:[e.jsx("div",{className:"flex grow items-center gap-2",children:O.map(i=>e.jsx("button",{className:`relative flex w-full items-center justify-center whitespace-nowrap rounded-md border p-1 px-3 text-sm sm:w-auto ${a===i.value?" border-gray-400 bg-gray-200 ":""} w-full sm:w-auto`,onClick:()=>r(i.value),children:i.label},i.value))}),e.jsx("button",{className:"relative flex w-full items-center justify-center rounded-md border p-1 px-3 text-sm sm:w-auto",onClick:()=>t(!0),children:"+ Create Roadmap"})]}),e.jsxs("div",{className:"mt-4",children:[a==="personal"&&e.jsx($,{roadmaps:p?.personalRoadmaps,setAllRoadmaps:x,onDelete:i=>{x({...p,personalRoadmaps:p.personalRoadmaps.filter(d=>d._id!==i)})}}),a==="shared"&&e.jsx(E,{roadmaps:p?.sharedRoadmaps})]})]})}export{ue as RoadmapListPage};
