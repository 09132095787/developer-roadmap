import{g as j}from"./browser.bcc09af3.js";import{h as n,p as E}from"./hooks.module.7cc4e70a.js";import{a as x,d as C}from"./http.82ebf0f1.js";import{p as d}from"./page.c1a8a472.js";import{E as L}from"./external-link.a7a2cda9.js";import{R as U}from"./roadmap.e17ba5ff.js";import{S as D,U as z}from"./SelectRoadmapModal.62b2331f.js";import{u as G}from"./index.c54070cf.js";import{a as Y}from"./team.12f2469e.js";import{u as q}from"./use-toast.fb52de5d.js";import{o as e}from"./jsxRuntime.module.afbf92fe.js";import"./preact.module.7b19fc78.js";import"./jwt.f0e0aa9c.js";import"./index.a98c85f5.js";import"./index.es.ebad3893.js";import"./Spinner.95905af5.js";import"./resource-progress.b09662c1.js";/* empty css                       */import"./use-outside-click.85d1a62f.js";import"./use-keydown.41d75069.js";import"./close.3a539829.js";import"./toast.1fe7142d.js";const B="/_astro/plus.1630ea32.svg";function pe(){const{t}=j(),m=G(Y),s=q(),[A,u]=n(!0),[b,g]=n(""),[I,f]=n(!1),[h,v]=n(""),[l,k]=n(),[c,p]=n([]),[R,T]=n([]);async function $(){const{error:r,response:o}=await x("/pages.json");if(r){s.error(r.message||"Something went wrong");return}if(!o)return[];const a=o.filter(i=>i.group==="Roadmaps").sort((i,y)=>i.title==="Android"?1:i.title.localeCompare(y.title));return T(a),o}async function M(r){const{response:o,error:a}=await x(`https://api.roadmap.sh/v1-get-team/${r}`);if(a||!o){s.error("Error loading team"),window.location.href="/account";return}k(o)}async function P(r){const{error:o,response:a}=await x(`https://api.roadmap.sh/v1-get-team-resource-config/${r}`);if(o||!Array.isArray(a)){console.error(o);return}p(a)}E(()=>{t&&(u(!0),Promise.all([M(t),P(t),$()]).finally(()=>{d.set(""),u(!1)}))},[t]);async function S(r){if(!l?._id)return;s.loading("Deleting roadmap"),d.set("Deleting roadmap from team");const{error:o,response:a}=await C(`https://api.roadmap.sh/v1-delete-team-resource-config/${l._id}`,{resourceId:r,resourceType:"roadmap"});if(o||!a){s.error(o?.message||"Something went wrong");return}s.success("Roadmap removed"),p(a)}async function _(r){if(!t)return;s.loading("Adding roadmap"),d.set("Adding roadmap"),u(!0);const{error:o,response:a}=await C(`https://api.roadmap.sh/v1-update-team-resource-config/${t}`,{teamId:t,resourceId:r,resourceType:"roadmap",removed:[]});if(o||!a){s.error(o?.message||"Error adding roadmap");return}p(a),s.success("Roadmap added")}async function N(r){d.set("Removing roadmap"),S(r).finally(()=>{d.set("")})}if(!l)return null;const w=I&&e(D,{onClose:()=>f(!1),teamResourceConfig:c,allRoadmaps:R,teamId:t,onRoadmapAdd:r=>{_(r).finally(()=>{d.set("")})},onRoadmapRemove:r=>{confirm("Are you sure you want to remove this roadmap?")&&N(r).finally(()=>{})}});return c.length===0&&!A?e("div",{className:"flex flex-col items-center p-4 py-20",children:[w,e("img",{alt:"roadmap",src:U,className:"mb-4 h-24 w-24 opacity-10"}),e("h3",{className:"mb-1 text-2xl font-bold text-gray-900",children:"No roadmaps"}),e("p",{className:"text-base text-gray-500",children:m?"Add a roadmap to start tracking your team":"Ask your team admin to add some roadmaps"}),m&&e("button",{className:"mt-4 rounded-lg bg-black px-4 py-2 font-medium text-white hover:bg-gray-900",onClick:()=>f(!0),children:"Add roadmap"})]}):e("div",{children:[w,e("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[h&&e(z,{onClose:()=>v(""),resourceId:h,resourceType:"roadmap",teamId:l?._id,setTeamResourceConfig:p,defaultRemovedItems:c.find(r=>r.resourceId===h)?.removed||[]}),c.map(r=>{const{resourceId:o,removed:a}=r,i=R.find(y=>y.id===o)?.title||"...";return e("div",{className:"flex flex-col items-start rounded-md border border-gray-300",children:[e("div",{className:"w-full px-3 py-4",children:[e("a",{href:`/${o}?t=${t}`,className:"group mb-0.5 flex items-center justify-between text-base font-medium leading-none text-black",target:"_blank",children:[i,e("img",{alt:"link",src:L,className:"ml-2 h-4 w-4 opacity-20 transition-opacity group-hover:opacity-100"})]}),a.length>0?e("span",{className:"text-xs leading-none text-gray-900",children:[a.length," topic",a.length>1?"s":""," removed"]}):e("span",{className:"text-xs italic leading-none text-gray-400/60",children:"No changes made .."})]}),m&&e("div",{className:"flex w-full justify-between px-3 pb-3 pt-2",children:[e("button",{type:"button",className:"text-xs text-gray-500 underline hover:text-black focus:outline-none",onClick:()=>{g(""),v(o)},children:"Customize"}),b!==o&&e("button",{type:"button",className:"text-xs text-red-500 underline hover:text-black focus:outline-none disabled:cursor-not-allowed disabled:opacity-40 disabled:hover:text-red-500",onClick:()=>g(o),children:"Remove"}),b===o&&e("span",{className:"text-xs",children:["Are you sure?"," ",e("button",{onClick:()=>N(o),className:"mx-0.5 text-red-500 underline underline-offset-1",children:"Yes"})," ",e("button",{onClick:()=>g(""),className:"text-red-500 underline underline-offset-1",children:"No"})]})]})]})}),m&&e("button",{onClick:()=>f(!0),className:"group flex min-h-[110px] flex-col items-center justify-center rounded-md border border-dashed border-gray-300 transition-colors hover:border-gray-600 hover:bg-gray-50",children:[e("img",{alt:"add",src:B,className:"mb-1 h-6 w-6 opacity-20 transition-opacity group-hover:opacity-100"}),e("span",{className:"text-sm text-gray-400 transition-colors focus:outline-none group-hover:text-black",children:"Add Roadmap"})]})]})]})}export{pe as TeamRoadmaps};
