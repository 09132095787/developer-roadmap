import{c as p}from"./createLucideIcon.3c9fdece.js";import{j as e}from"./jsx-runtime.6940b965.js";import{r as m}from"./index.070054a4.js";import{u as k}from"./use-toast.fb52de5d.js";import{c as y}from"./classname.585fc13a.js";import{a as L,b as A}from"./http.387f5009.js";import{U as R}from"./users.9673a18c.js";import{u as Q}from"./use-copy-text.77785bb1.js";import{C as X}from"./check-circle.045c0bed.js";import{M as $,L as V}from"./roadmap.9c1903ec.js";const Z=p("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),ee=p("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),se=p("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),E=p("Globe2",[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3v0a2 2 0 0 1 2 2v0c0 1.1.9 2 2 2v0a2 2 0 0 0 2-2v0c0-1.1.9-2 2-2h3.17",key:"1fi5u6"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2v0a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"xsiumc"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),B=p("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),be=p("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),je=p("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),F=p("Users2",[["path",{d:"M14 19a6 6 0 0 0-12 0",key:"vej9p1"}],["circle",{cx:"8",cy:"9",r:"4",key:"143rtg"}],["path",{d:"M22 19a6 6 0 0 0-6-6 4 4 0 1 0 0-8",key:"hqbn22"}]]);function H(d){const{user:l,onClick:s,isSelected:n}=d;return e.jsxs("button",{className:y("relative flex w-full items-center gap-2.5 rounded-lg border p-2.5",n&&"border-gray-500 bg-gray-300 text-black"),onClick:s,children:[e.jsx("img",{src:l.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${l.avatar}`:"/images/default-avatar.png",alt:l.name||"",className:"relative top-[1px] h-10 w-10 shrink-0 rounded-full"}),e.jsxs("div",{className:"inline-grid w-full",children:[e.jsx("h3",{className:"truncate text-left font-semibold",children:l.name}),e.jsx("p",{className:y("truncate text-left text-sm text-gray-500",n&&"text-gray-700"),children:l.email})]})]})}function ae(d){const{setFriends:l,friends:s,sharedFriendIds:n,setSharedFriendIds:i}=d,c=k(),[a,h]=m.useState(!0);async function u(){if(s.length>0)return;h(!0);const{response:t,error:r}=await L("https://api.roadmap.sh/v1-list-friends");if(r||!t){c.error(r?.message||"Something went wrong");return}l(t.filter(o=>o.status==="accepted"))}m.useEffect(()=>{u().finally(()=>{h(!1)})},[]);const x=a&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:[...Array(3)].map((t,r)=>e.jsxs("li",{className:"flex animate-pulse items-center gap-2.5 rounded-md border p-2",children:[e.jsx("div",{className:"relative top-[1px] h-10 w-10 shrink-0 rounded-full bg-gray-200"}),e.jsxs("div",{className:"inline-grid w-full",children:[e.jsx("div",{className:"h-5 w-2/4 rounded bg-gray-200"}),e.jsx("div",{className:"mt-1 h-5 w-3/4 rounded bg-gray-200"})]})]},r))});return e.jsxs(e.Fragment,{children:[(s.length>0||a)&&e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"text-sm",children:"Select Friends to share the roadmap with"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:n.length===s.length,onChange:t=>{t.target.checked?i(s.map(r=>r.userId)):i([])}}),e.jsx("span",{className:"text-sm",children:"Select all"})]})]}),x,s.length>0&&!a&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:s.map(t=>{const r=n?.includes(t.userId);return e.jsx("li",{children:e.jsx(H,{user:{name:t.name,avatar:t.avatar,email:t.email},isSelected:r,onClick:()=>{i(r?n.filter(o=>o!==t.userId):[...n,t.userId])}})},t.userId)})}),s.length===0&&!a&&e.jsxs("div",{className:"flex h-full flex-grow flex-col items-center justify-center rounded-md border bg-gray-50 text-center",children:[e.jsx(F,{className:"mb-3 h-10 w-10 text-gray-300"}),e.jsxs("p",{className:"font-semibold text-gray-500",children:["You do not have any friends yet. ",e.jsx("br",{})," ",e.jsx("a",{target:"_blank",className:"underline underline-offset-2",href:`${{}.PUBLIC_ROADMAP_WEB_URL}/account/friends`,children:"Invite your friends to share roadmaps with."})]})]})]})}function te(d){const{teams:l,setTeams:s,selectedTeamId:n,setSelectedTeamId:i}=d,c=k(),[a,h]=m.useState(!0);async function u(){if(l.length>0)return;const{response:t,error:r}=await L("https://api.roadmap.sh/v1-get-user-teams");if(r||!t){c.error(r?.message||"Something went wrong");return}s(t.filter(o=>["admin","manager"].includes(o.role)))}m.useEffect(()=>{u().finally(()=>h(!1))},[]);const x=a&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:[...Array(3)].map((t,r)=>e.jsx("li",{children:e.jsxs("div",{className:"relative flex w-full items-center gap-2 rounded-md border p-2",children:[e.jsx("div",{className:"h-6 w-6 shrink-0 animate-pulse rounded-full bg-gray-200"}),e.jsx("div",{className:"inline-grid w-full",children:e.jsx("div",{className:"h-4 animate-pulse rounded bg-gray-200"})})]})},r))});return e.jsxs(e.Fragment,{children:[(l.length>0||a)&&e.jsx("p",{className:"text-sm",children:"Select a team to transfer this roadmap to"}),x,l.length>0&&!a&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:l.map(t=>{const r=t._id===n;return e.jsx("li",{children:e.jsxs("button",{className:y("relative flex w-full items-center gap-2.5 rounded-lg border p-2.5",r&&"border-gray-500 bg-gray-100 text-black"),onClick:()=>{i(t._id)},children:[e.jsx("img",{src:t.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${t.avatar}`:"/images/default-avatar.png",alt:t.name||"",className:"h-6 w-6 shrink-0 rounded-full"}),e.jsx("div",{className:"inline-grid w-full",children:e.jsx("h3",{className:"truncate text-left font-normal",children:t.name})})]})},t._id)})}),l.length===0&&!a&&e.jsxs("div",{className:"flex grow flex-col items-center justify-center gap-2",children:[e.jsx(F,{className:"h-12 w-12 text-gray-500"}),e.jsx("p",{className:"text-gray-500",children:"You are not a member of any team."})]})]})}const re=[{id:"me",label:"Only me",long:"Only visible to me",icon:B},{id:"public",label:"Public",long:"Anyone can view",icon:E},{id:"friends",label:"Only friends",long:"Only friends can view",icon:R},{id:"team",label:"Only Members",long:"Visible to team members",icon:F}];function le(d){const{visibility:l,setVisibility:s,teamId:n,onChange:i}=d,c=a=>{s(a),i(a)};return e.jsxs("div",{className:"flex justify-between",children:[e.jsx("ul",{className:"flex w-full items-center gap-1.5",children:re.map(a=>{if(a.id==="friends"&&n)return null;if(a.id==="team"&&!n)return null;const h=a.id===l;return e.jsx("li",{children:e.jsx(O,{label:a.label,isActive:h,icon:a.icon,onClick:()=>{c(a.id)}})},a.id)})}),!n&&e.jsx("div",{className:"grow",children:e.jsx(O,{label:"Transfer to team",icon:Z,isActive:l==="team",onClick:()=>{c("team")},className:'border-red-300 text-red-600 hover:border-red-200 hover:bg-red-50 data-[active="true"]:border-red-600 data-[active="true"]:bg-red-600 data-[active="true"]:text-white'})})]})}function O(d){const{label:l,isActive:s,onClick:n,icon:i,className:c}=d;return e.jsxs("button",{className:y("flex items-center justify-center gap-2 rounded-md border px-3 py-2 text-sm text-black hover:border-gray-300 hover:bg-gray-100",'data-[active="true"]:border-gray-500 data-[active="true"]:bg-gray-200 data-[active="true"]:text-black',c),"data-active":s,disabled:s,onClick:n,children:[!s&&e.jsx(i,{className:"h-4 w-4"}),s&&e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{className:"whitespace-nowrap",children:l})]})}function ne(d){const{setMembers:l,members:s,sharedTeamMemberIds:n,setSharedTeamMemberIds:i,teamId:c}=d,a=k(),[h,u]=m.useState(!0);async function x(){if(s?.length>0)return;u(!0);const{response:r,error:o}=await L(`https://api.roadmap.sh/v1-get-team-member-list/${c}`);if(o||!r){a.error(o?.message||"Something went wrong");return}l(r)}m.useEffect(()=>{x().finally(()=>{u(!1)})},[]);const t=h&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-2.5",children:[...Array(3)].map((r,o)=>e.jsxs("li",{className:"flex min-h-[62px] animate-pulse items-center gap-2 rounded-md border p-2",children:[e.jsx("div",{className:"h-8 w-8 shrink-0 rounded-full bg-gray-200"}),e.jsxs("div",{className:"inline-grid w-full",children:[e.jsx("div",{className:"h-5 w-2/4 rounded bg-gray-200"}),e.jsx("div",{className:"mt-1 h-5 w-3/4 rounded bg-gray-200"})]})]},o))});return e.jsxs(e.Fragment,{children:[(s.length>0||h)&&e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"text-sm",children:"Select Members"}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:n.length===s.length,onChange:r=>{r.target.checked?i(s.map(o=>o._id)):i([])}}),e.jsx("span",{className:"text-sm",children:"Select all"})]})]}),t,s?.length>0&&!h&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-2.5",children:s?.map(r=>{const o=n?.includes(r._id?.toString());return e.jsx("li",{children:e.jsx(H,{user:{name:r.name,avatar:r.avatar,email:r.invitedEmail},isSelected:o,onClick:()=>{i(o?n.filter(S=>S!==r._id?.toString()):[...n,r._id?.toString()])}})},r.userId)})}),s.length===0&&!h&&e.jsxs("div",{className:"flex grow flex-col items-center justify-center gap-2",children:[e.jsx(R,{className:"h-12 w-12 text-gray-500"}),e.jsx("p",{className:"text-gray-500",children:"No members have been added yet."})]})]})}function ie(d){const{roadmapId:l,onClose:s}=d,n=`${{}.PUBLIC_ROADMAP_WEB_URL}/r?id=${l}`,{copyText:i,isCopied:c}=Q();return e.jsxs("div",{className:"flex grow flex-col justify-center",children:[e.jsxs("div",{className:"mt-5 flex grow flex-col items-center justify-center gap-1.5",children:[e.jsx(X,{className:"h-14 w-14 text-green-500"}),e.jsx("h3",{className:"text-xl font-medium",children:"Sharing Settings Updated"})]}),e.jsx("input",{type:"text",className:"mt-6 w-full rounded-md border bg-gray-50 p-2 px-2.5 text-gray-700 focus:outline-none",value:n,readOnly:!0,onClick:a=>{a.currentTarget.select(),i(n)}}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"You can share the above link with anyone who has access"}),e.jsxs("div",{className:"mt-4 flex flex-col items-center justify-end gap-2",children:[e.jsxs("button",{className:y("flex w-full items-center justify-center gap-1.5 rounded bg-black px-4 py-2.5 text-sm font-medium text-white hover:opacity-80",c&&"bg-green-300 text-green-800"),disabled:c,onClick:()=>{i(n)},children:[e.jsx(se,{className:"h-3.5 w-3.5 stroke-[2.5]"}),c?"Copied":"Copy"]}),e.jsx("button",{className:y("flex w-full items-center justify-center gap-1.5 rounded border border-black px-4 py-2 text-sm font-medium hover:bg-gray-100"),onClick:s,children:"Close"})]})]})}function we(d){const{roadmapId:l,onClose:s,visibility:n,sharedTeamMemberIds:i=[],sharedFriendIds:c=[],teamId:a,onShareSettingsUpdate:h}=d,u=k(),[x,t]=m.useState(!1),[r,o]=m.useState(!1),[S,D]=m.useState([]),[G,Y]=m.useState([]),[z,W]=m.useState([]),[g,q]=m.useState(n),[C,N]=m.useState(i),[I,j]=m.useState(c),[M,U]=m.useState(null),T=g==="team"&&!a;let w=!1;(g==="friends"&&I.length===0||T&&!M||g==="team"&&a&&C.length===0)&&(w=!0);const J=async({sharedFriendIds:f,visibility:v,sharedTeamMemberIds:b})=>{if(t(!0),v==="friends"&&f.length===0){u.error("Please select at least one friend");return}else if(v==="team"&&a&&b.length===0){u.error("Please select at least one member");return}const{response:ce,error:_}=await A(`https://api.roadmap.sh/v1-update-roadmap-visibility/${l}`,{visibility:v,sharedFriendIds:f,sharedTeamMemberIds:b});if(_){u.error(_?.message||"Something went wrong, please try again");return}t(!1),o(!0),h({sharedFriendIds:f,visibility:v,sharedTeamMemberIds:b})},K=m.useCallback(async f=>{if(!l)return;t(!0);const{response:v,error:b}=await A(`https://api.roadmap.sh/v1-transfer-roadmap/${l}`,{teamId:f});if(b){t(!1),u.error(b?.message||"Something went wrong, please try again");return}window.location.reload()},[l]);return r?e.jsx($,{onClose:s,wrapperClassName:"max-w-lg",bodyClassName:"p-4 flex flex-col",children:e.jsx(ie,{roadmapId:l,onClose:s})}):e.jsxs($,{onClose:()=>{x||s()},wrapperClassName:"max-w-3xl",bodyClassName:"p-4 flex flex-col min-h-[400px]",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"mb-1 text-xl font-semibold",children:"Update Sharing Settings"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Pick and modify who can access this roadmap."})]}),e.jsx(le,{visibility:g,setVisibility:q,teamId:a,onChange:f=>{U(null),["me","public"].includes(f)?(N([]),j([])):f==="friends"?j(c.length>0?c:[]):f==="team"&&a?(N(i?.length>0?i:[]),j([])):(j([]),N([]))}}),e.jsxs("div",{className:"mt-4 flex grow flex-col",children:[g==="public"&&e.jsxs("div",{className:"flex h-full flex-grow flex-col items-center justify-center rounded-md border bg-gray-50 text-center",children:[e.jsx(E,{className:"mb-3 h-10 w-10 text-gray-300"}),e.jsx("p",{className:"font-medium text-gray-500",children:"Anyone with the link can access."})]}),g==="me"&&e.jsxs("div",{className:"flex h-full flex-grow flex-col items-center justify-center rounded-md border bg-gray-50 text-center",children:[e.jsx(B,{className:"mb-3 h-10 w-10 text-gray-300"}),e.jsx("p",{className:"font-medium text-gray-500",children:"Only you will be able to access."})]}),g==="friends"&&e.jsx(ae,{friends:S,setFriends:D,sharedFriendIds:I,setSharedFriendIds:j}),T&&e.jsx(te,{teams:G,setTeams:Y,selectedTeamId:M,setSelectedTeamId:U}),g==="team"&&a&&e.jsx(ne,{teamId:a,sharedTeamMemberIds:C,setSharedTeamMemberIds:N,members:z,setMembers:W})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between gap-1.5",children:[e.jsx("button",{className:"flex items-center justify-center gap-1.5 rounded-md border px-3.5 py-1.5 hover:bg-gray-100 disabled:cursor-not-allowed disabled:opacity-75",disabled:x,onClick:s,children:"Close"}),T?e.jsxs(P,{disabled:w||x,onClick:()=>{K(M).then(()=>null)},children:[x&&e.jsx(V,{className:"h-4 w-4 animate-spin"}),"Transfer"]}):e.jsxs(P,{disabled:w||x,onClick:()=>{J({visibility:g,sharedTeamMemberIds:g==="team"?C:[],sharedFriendIds:g==="friends"?I:[]})},children:[x&&e.jsx(V,{className:"h-4 w-4 animate-spin"}),"Update Sharing Settings"]})]})]})}function P(d){const{onClick:l,disabled:s,children:n,className:i}=d;return e.jsx("button",{className:y("flex min-w-[120px] items-center justify-center gap-1.5 rounded-md border border-gray-900 bg-gray-900 px-4 py-2 text-white hover:bg-gray-800 disabled:cursor-not-allowed disabled:opacity-75",s&&"border-gray-700 bg-gray-700 text-white hover:bg-gray-700",i),disabled:s,onClick:l,children:n})}export{B as L,be as M,we as S,je as T};
