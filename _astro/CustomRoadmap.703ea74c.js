import{j as e}from"./jsx-runtime.6940b965.js";import{r as d}from"./index.070054a4.js";import{g as M}from"./browser.6245b9a5.js";import{d as $,c as D,a as U,h as B}from"./http.387f5009.js";import{c as w}from"./classname.585fc13a.js";import{u as x}from"./index.2d760e66.js";import{c as S}from"./index.3e34842a.js";import{a as L}from"./index.a98c85f5.js";import{S as k,M as P,L as R,T as E}from"./ShareOptionsModal.da258ac7.js";import{c as I}from"./createLucideIcon.3c9fdece.js";import{p as A}from"./page.c1a8a472.js";import{i as F}from"./jwt.ab9b7b25.js";/* empty css                       */import{u as _}from"./use-toast.fb52de5d.js";import{u as z}from"./use-outside-click.d7ce4a3d.js";import{S as T}from"./shapes.18fdadc5.js";import{R as H}from"./RoadmapRenderer.9b93aa0f.js";import{TopicDetail as O}from"./TopicDetail.c8f205c2.js";import{UserProgressModal as G}from"./UserProgressModal.4d7fbaed.js";import"./users-2.dc7091e7.js";import"./users.9673a18c.js";import"./use-copy-text.77785bb1.js";import"./check-circle.045c0bed.js";import"./copy.2caf0f52.js";import"./Modal.5d15d888.js";import"./use-keydown.bb1f91bb.js";import"./toast.1fe7142d.js";import"./renderer.b3c7ce1f.js";import"./index.5f60dc5b.js";import"./resource-progress.9335d95d.js";import"./close.bb7a0ac2.js";import"./spinner.6a5ba5e9.js";import"./popup.a359f713.js";import"./markdown.9aebbb7a.js";import"./index.es.ebad3893.js";import"./use-auth.86ed5fb5.js";import"./Spinner.799b0955.js";import"./ErrorIcon.977ee49a.js";const V=I("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),N=I("ShieldBan",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m4 5 14 12",key:"1ta6nf"}]]),m=L(void 0);S(m,a=>!a?.teamId);const C=S(m,a=>a?.canManage);function q(a){const{isSecondaryBanner:n=!1}=a,[s,t]=d.useState(!1),i=x(C),r=x(m);return e.jsxs(e.Fragment,{children:[s&&i&&r&&e.jsx(k,{isDiscoverable:r.isDiscoverable,description:r?.description,visibility:r?.visibility,teamId:r?.teamId,roadmapId:r?._id,sharedFriendIds:r?.sharedFriendIds||[],sharedTeamMemberIds:r?.sharedTeamMemberIds||[],onClose:()=>t(!1),onShareSettingsUpdate:o=>{m.set({...r,...o})}}),e.jsxs("div",{"data-progress-nums-container":"",className:w("striped-loader relative hidden items-center justify-between bg-white px-2 py-1.5 sm:flex",{"rounded-bl-md rounded-br-md":n,"rounded-md":!n}),children:[e.jsxs("p",{className:"flex text-sm opacity-0 transition-opacity duration-300","data-progress-nums":"",children:[e.jsxs("span",{className:"mr-2.5 rounded-sm bg-yellow-200 px-1 py-0.5 text-xs font-medium uppercase text-yellow-900",children:[e.jsx("span",{"data-progress-percentage":"",children:"0"}),"% Done"]}),e.jsxs("span",{className:"itesm-center hidden md:flex",children:[e.jsxs("span",{children:[e.jsx("span",{"data-progress-done":"",children:"0"})," completed"]}),e.jsx("span",{className:"mx-1.5 text-gray-400",children:"·"}),e.jsxs("span",{children:[e.jsx("span",{"data-progress-learning":"",children:"0"})," in progress"]}),e.jsx("span",{className:"mx-1.5 text-gray-400",children:"·"}),e.jsxs("span",{children:[e.jsx("span",{"data-progress-skipped":"",children:"0"})," skipped"]}),e.jsx("span",{className:"mx-1.5 text-gray-400",children:"·"}),e.jsxs("span",{children:[e.jsx("span",{"data-progress-total":"",children:"0"})," Total"]})]}),e.jsxs("span",{className:"md:hidden",children:[e.jsx("span",{"data-progress-done":"",children:"0"})," of"," ",e.jsx("span",{"data-progress-total":"",children:"0"})," Done"]})]}),e.jsx("div",{className:"flex items-center gap-3 opacity-0 transition-opacity duration-300","data-progress-nums":"",children:e.jsxs("button",{"data-popup":"progress-help",className:"flex items-center gap-1 text-sm font-medium text-gray-500 opacity-0 transition-opacity hover:text-black","data-progress-nums":"",children:[e.jsx(V,{className:"h-3.5 w-3.5 stroke-[2.5px]"}),"Track Progress"]})})]}),e.jsx("div",{"data-progress-nums-container":"",className:"striped-loader relative -mb-2 flex items-center justify-between rounded-md border bg-white px-2 py-1.5 text-sm text-gray-700 sm:hidden",children:e.jsxs("span",{"data-progress-nums":"",className:"text-gray-500 opacity-0 transition-opacity duration-300",children:[e.jsx("span",{"data-progress-done":"",children:"0"})," of"," ",e.jsx("span",{"data-progress-total":"",children:"0"})," Done"]})})]})}function J(a){const{roadmapTitle:n,roadmapId:s,hasTNSBanner:t=!1,tnsBannerLink:i=""}=a;return e.jsxs("div",{className:w("mb-0 mt-4 rounded-md border-0 sm:mt-7 sm:border",{"sm:-mb-[82px]":t,"sm:-mb-[65px]":!t}),children:[t&&e.jsx("div",{className:"hidden border-b bg-gray-100 px-2 py-1.5 sm:block",children:e.jsxs("p",{className:"text-sm",children:["Get the latest ",n," news from our sister site"," ",e.jsx("a",{href:i,target:"_blank",className:"font-semibold underline",children:"TheNewStack.io"})]})}),e.jsx(q,{isSecondaryBanner:t,resourceId:s,resourceType:"roadmap"})]})}function K(a){const{onDelete:n,onUpdateSharing:s,onCustomize:t}=a,i=d.useRef(null),[r,o]=d.useState(!1);return z(i,()=>{o(!1)}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{disabled:!1,onClick:()=>o(!r),className:"inline-flex items-center justify-center rounded-md bg-gray-500 py-1.5 pl-2 pr-2 text-xs font-medium text-white hover:bg-gray-600 sm:pl-1.5 sm:pr-3 sm:text-sm",children:[e.jsx(P,{className:"mr-0 h-4 w-4 stroke-[2.5] sm:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Actions"})]}),r&&e.jsx("div",{ref:i,className:"align-right absolute right-0 top-full z-50 mt-1 w-[140px] rounded-md bg-slate-800 px-2 py-2 text-white shadow-md",children:e.jsxs("ul",{children:[s&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{o(!1),s()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(R,{size:14,className:"mr-2"}),"Sharing"]})}),t&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{o(!1),t()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(T,{size:14,className:"mr-2"}),"Customize"]})}),n&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{o(!1),n()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(E,{size:14,className:"mr-2"}),"Delete"]})})]})})]})}function Q(a){const n=x(C),s=x(m),{title:t,description:i,_id:r,creator:o,team:h}=x(m)||{},[j,u]=d.useState(!1),p=_();async function c(){A.set("Deleting roadmap");const l=s?.teamId,y="https://api.roadmap.sh";let g,b;if(l?{error:g,response:b}=await $(`${y}/v1-delete-team-resource-config/${l}`,{resourceId:r,resourceType:"roadmap"}):{error:g,response:b}=await D(`${y}/v1-delete-roadmap/${r}`),g||!b){p.error(g?.message||"Something went wrong");return}p.success("Roadmap removed"),l?window.location.href=`/team/roadmaps?t=${l}`:window.location.href="/account/roadmaps"}const f=o?.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${o?.avatar}`:"/images/default-avatar.png";return e.jsx("div",{className:"border-b",children:e.jsxs("div",{className:"container relative py-5 sm:py-12",children:[o?.name&&e.jsxs("div",{className:"-mb-1 flex items-center gap-1.5 text-sm text-gray-500",children:[e.jsx("img",{alt:o.name,src:f,className:"h-5 w-5 rounded-full"}),e.jsxs("span",{children:["Created by ",e.jsx("span",{className:"font-semibold text-gray-900",children:o?.name}),h&&e.jsxs(e.Fragment,{children:[" in ",e.jsx("span",{className:"font-semibold text-gray-900",children:h?.name})]})]})]}),e.jsxs("div",{className:"mb-3 mt-4 sm:mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold sm:mb-2 sm:text-4xl",children:t}),e.jsx("p",{className:"mt-0.5 text-sm text-gray-500 sm:text-lg",children:i})]}),e.jsxs("div",{className:"flex justify-between gap-2 sm:gap-0",children:[e.jsxs("div",{className:"flex gap-1 sm:gap-2",children:[e.jsxs("a",{href:"/roadmaps",className:"rounded-md bg-gray-500 px-3 py-1.5 text-xs font-medium text-white hover:bg-gray-600 sm:text-sm","aria-label":"Back to All Roadmaps",children:["←",e.jsx("span",{className:"hidden sm:inline",children:" All Roadmaps"})]}),e.jsx("button",{"data-guest-required":!0,"data-popup":"login-popup",className:"inline-flex hidden items-center justify-center rounded-md bg-yellow-400 px-3 py-1.5 text-xs font-medium hover:bg-yellow-500 sm:text-sm","aria-label":"Subscribe for Updates",children:e.jsx("span",{className:"ml-2",children:"Subscribe"})})]}),n&&e.jsxs("div",{className:"flex items-center gap-2",children:[j&&s&&e.jsx(k,{isDiscoverable:s.isDiscoverable,description:s?.description,visibility:s?.visibility,teamId:s?.teamId,roadmapId:s?._id,sharedFriendIds:s?.sharedFriendIds||[],sharedTeamMemberIds:s?.sharedTeamMemberIds||[],onClose:()=>u(!1),onShareSettingsUpdate:l=>{m.set({...s,...l})}}),e.jsxs("a",{href:`https://draw.roadmap.sh/${s?._id}`,target:"_blank",className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white py-1.5 pl-2 pr-2 text-xs font-medium  text-black hover:border-gray-300 hover:bg-gray-300 sm:px-3 sm:text-sm",children:[e.jsx(T,{className:"mr-1.5 h-4 w-4 stroke-[2.5]"}),e.jsx("span",{className:"hidden sm:inline-block",children:"Edit Roadmap"}),e.jsx("span",{className:"sm:hidden",children:"Edit"})]}),e.jsxs("button",{onClick:()=>u(!0),className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white py-1.5 pl-2 pr-2 text-xs font-medium  text-black hover:border-gray-300 hover:bg-gray-300 sm:px-3 sm:text-sm",children:[e.jsx(R,{className:"mr-1.5 h-4 w-4 stroke-[2.5]"}),"Sharing"]}),e.jsx(K,{onDelete:()=>{window.confirm("Are you sure you want to delete this roadmap?")&&c().finally(()=>null)}})]})]}),e.jsx(J,{roadmapTitle:t,hasTNSBanner:!1,roadmapId:r})]})})}function W(a){const{error:n}=a;return n.status===404?e.jsx(v,{icon:e.jsx(N,{className:"h-16 w-16"}),title:"Roadmap not found",message:"The roadmap you are looking for does not exist or has been deleted."}):e.jsx(v,{icon:e.jsx(N,{className:"h-16 w-16"}),title:"Restricted Access",message:n?.message})}function v(a){const{title:n,message:s,icon:t}=a;return e.jsxs("div",{className:"flex grow flex-col items-center justify-center",children:[t,e.jsx("h2",{className:"mt-4 text-2xl font-semibold",children:n}),e.jsx("p",{children:s||"This roadmap is not available for public access."}),e.jsx("a",{href:"/",className:"mt-4 font-medium underline underline-offset-2 hover:no-underline",children:"← Go back to home"})]})}function X(){const a=document.querySelector("[data-roadmap-loader]");a&&a.remove()}function Pe(){const{id:a,secret:n}=M(),[s,t]=d.useState(!0),[i,r]=d.useState(null),[o,h]=d.useState();async function j(){t(!0);const p=new URL(`https://api.roadmap.sh/v1-get-roadmap/${a}`);n&&p.searchParams.set("secret",n);const{response:c,error:f}=await U(p.toString());if(f||!c){h(f),t(!1);return}document.title=`${c.title} - roadmap.sh`,r(c),m.set(c),t(!1)}async function u(){F()&&await B("https://api.roadmap.sh/v1-visit",{resourceId:a,resourceType:"roadmap"})}return d.useEffect(()=>{j().finally(()=>{X()}),u().then()},[]),s?null:o?e.jsx(W,{error:o}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsx(H,{roadmap:i}),e.jsx(O,{canSubmitContribution:!1}),e.jsx(G,{resourceId:i?._id,resourceType:"roadmap",isCustomResource:!0})]})}export{Pe as CustomRoadmap};
