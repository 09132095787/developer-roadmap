import{j as g}from"./jsx-runtime.BPj4-Rfu.js";import{g as Tn,r as U}from"./index.SSXOyoI7.js";/* empty css                       */import{u as Ye}from"./use-toast.CK2mpur1.js";import{q as St,o as Pt,w as Xe,x as fe,y as An,B as ge,D as jn,t as lt,A as Nn}from"./use-editor.Bp9uaBQ_.js";import{r as Pn}from"./dom.DTPLKm7E.js";import{b as Bt,c as xe,e as Ln,i as ft,r as Ze,v as Fn}from"./jwt.M546E6_Y.js";import{s as _t}from"./popup.CdCAhVM2.js";import{c as Ct}from"./classname.VuY_V_HN.js";import{M as Rn}from"./Modal.578cTUuR.js";import{h as Je,a as ye}from"./http.B-35sOsF.js";import{W as tn,T as On,A as _n}from"./AIRoadmapAlert.sMBaFfdE.js";import{B as re,F as Bn}from"./file-text.Qwr_EjgC.js";import{c as ie}from"./createLucideIcon.BSeNqbob.js";import{S as en}from"./Spinner.B1Yt5gOc.js";import{ShareRoadmapButton as vn}from"./ShareRoadmapButton.Be-_90xy.js";import{p as wt}from"./page.C3ddTGlS.js";import{g as Mn,d as Dn,s as Hn}from"./browser.DS5mYzWA.js";import{a as qn}from"./download-image.DugWrjuw.js";import{u as Un}from"./use-keydown.DCIacX8c.js";import{u as $n}from"./use-outside-click.BWzraQDw.js";import{m as Vn}from"./markdown.D6QkiFeC.js";import{X as be}from"./x.DeiB2ka7.js";import{S as Gn}from"./square-pen.Cmhk_zGy.js";import"./toast.BGQI3kl5.js";import"./index.CEvxOxeV.js";import"./index.v_sgd_GK.js";import"./bundle-mjs.CZZD-8Ii.js";import"./badge-check.BruBxokK.js";import"./use-copy-text.i66JXdki.js";import"./index.zDCl-MiS.js";import"./roadmap.SDi3zlny.js";import"./index.Bhz7cRIx.js";import"./linkedin.DcgRZAME.js";import"./copy.ox-RWvwE.js";/**
 * @license lucide-react v0.334.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=ie("Cog",[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]]);/**
 * @license lucide-react v0.334.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=ie("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.334.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=ie("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);function ke(t){if(t)throw t}var Rt=Object.prototype.hasOwnProperty,nn=Object.prototype.toString,we=Object.defineProperty,Se=Object.getOwnPropertyDescriptor,Ie=function(e){return typeof Array.isArray=="function"?Array.isArray(e):nn.call(e)==="[object Array]"},Ee=function(e){if(!e||nn.call(e)!=="[object Object]")return!1;var n=Rt.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&Rt.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;var i;for(i in e);return typeof i>"u"||Rt.call(e,i)},Ce=function(e,n){we&&n.name==="__proto__"?we(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},ze=function(e,n){if(n==="__proto__")if(Rt.call(e,n)){if(Se)return Se(e,n).value}else return;return e[n]},Kn=function t(){var e,n,r,i,s,a,o=arguments[0],u=1,l=arguments.length,h=!1;for(typeof o=="boolean"&&(h=o,o=arguments[1]||{},u=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});u<l;++u)if(e=arguments[u],e!=null)for(n in e)r=ze(o,n),i=ze(e,n),o!==i&&(h&&i&&(Ee(i)||(s=Ie(i)))?(s?(s=!1,a=r&&Ie(r)?r:[]):a=r&&Ee(r)?r:{},Ce(o,{name:n,newValue:t(h,a,i)})):typeof i<"u"&&Ce(o,{name:n,newValue:i}));return o};const Dt=Tn(Kn);function Xt(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function Yn(){const t=[],e={run:n,use:r};return e;function n(...i){let s=-1;const a=i.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);o(null,...i);function o(u,...l){const h=t[++s];let p=-1;if(u){a(u);return}for(;++p<i.length;)(l[p]===null||l[p]===void 0)&&(l[p]=i[p]);i=l,h?Xn(h,o)(...l):a(null,...l)}}function r(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return t.push(i),e}}function Xn(t,e){let n;return r;function r(...a){const o=t.length>a.length;let u;o&&a.push(i);try{u=t.apply(this,a)}catch(l){const h=l;if(o&&n)throw h;return i(h)}o||(u&&u.then&&typeof u.then=="function"?u.then(s,i):u instanceof Error?i(u):s(u))}function i(a,...o){n||(n=!0,e(a,...o))}function s(a){i(null,a)}}function jt(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?Te(t.position):"start"in t||"end"in t?Te(t):"line"in t||"column"in t?Zt(t):""}function Zt(t){return Ae(t&&t.line)+":"+Ae(t&&t.column)}function Te(t){return Zt(t&&t.start)+"-"+Zt(t&&t.end)}function Ae(t){return t&&typeof t=="number"?t:1}class tt extends Error{constructor(e,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let i="",s={},a=!1;if(n&&("line"in n&&"column"in n?s={place:n}:"start"in n&&"end"in n?s={place:n}:"type"in n?s={ancestors:[n],place:n.position}:s={...n}),typeof e=="string"?i=e:!s.cause&&e&&(a=!0,i=e.message,s.cause=e),!s.ruleId&&!s.source&&typeof r=="string"){const u=r.indexOf(":");u===-1?s.ruleId=r:(s.source=r.slice(0,u),s.ruleId=r.slice(u+1))}if(!s.place&&s.ancestors&&s.ancestors){const u=s.ancestors[s.ancestors.length-1];u&&(s.place=u.position)}const o=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file,this.message=i,this.line=o?o.line:void 0,this.name=jt(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=a&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual,this.expected,this.note,this.url}}tt.prototype.file="";tt.prototype.name="";tt.prototype.reason="";tt.prototype.message="";tt.prototype.stack="";tt.prototype.column=void 0;tt.prototype.line=void 0;tt.prototype.ancestors=void 0;tt.prototype.cause=void 0;tt.prototype.fatal=void 0;tt.prototype.place=void 0;tt.prototype.ruleId=void 0;tt.prototype.source=void 0;const ut={basename:Zn,dirname:Jn,extname:tr,join:er,sep:"/"};function Zn(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');Lt(t);let n=0,r=-1,i=t.length,s;if(e===void 0||e.length===0||e.length>t.length){for(;i--;)if(t.codePointAt(i)===47){if(s){n=i+1;break}}else r<0&&(s=!0,r=i+1);return r<0?"":t.slice(n,r)}if(e===t)return"";let a=-1,o=e.length-1;for(;i--;)if(t.codePointAt(i)===47){if(s){n=i+1;break}}else a<0&&(s=!0,a=i+1),o>-1&&(t.codePointAt(i)===e.codePointAt(o--)?o<0&&(r=i):(o=-1,r=a));return n===r?r=a:r<0&&(r=t.length),t.slice(n,r)}function Jn(t){if(Lt(t),t.length===0)return".";let e=-1,n=t.length,r;for(;--n;)if(t.codePointAt(n)===47){if(r){e=n;break}}else r||(r=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function tr(t){Lt(t);let e=t.length,n=-1,r=0,i=-1,s=0,a;for(;e--;){const o=t.codePointAt(e);if(o===47){if(a){r=e+1;break}continue}n<0&&(a=!0,n=e+1),o===46?i<0?i=e:s!==1&&(s=1):i>-1&&(s=-1)}return i<0||n<0||s===0||s===1&&i===n-1&&i===r+1?"":t.slice(i,n)}function er(...t){let e=-1,n;for(;++e<t.length;)Lt(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":nr(n)}function nr(t){Lt(t);const e=t.codePointAt(0)===47;let n=rr(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function rr(t,e){let n="",r=0,i=-1,s=0,a=-1,o,u;for(;++a<=t.length;){if(a<t.length)o=t.codePointAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(u=n.lastIndexOf("/"),u!==n.length-1){u<0?(n="",r=0):(n=n.slice(0,u),r=n.length-1-n.lastIndexOf("/")),i=a,s=0;continue}}else if(n.length>0){n="",r=0,i=a,s=0;continue}}e&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+t.slice(i+1,a):n=t.slice(i+1,a),r=a-i-1;i=a,s=0}else o===46&&s>-1?s++:s=-1}return n}function Lt(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const ir={cwd:sr};function sr(){return"/"}function Jt(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function ar(t){if(typeof t=="string")t=new URL(t);else if(!Jt(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return or(t)}function or(t){if(t.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const r=e.codePointAt(n+2);if(r===70||r===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(e)}const Ht=["history","path","basename","stem","extname","dirname"];class lr{constructor(e){let n;e?Jt(e)?n={path:e}:typeof e=="string"||ur(e)?n={value:e}:n=e:n={},this.cwd=ir.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Ht.length;){const s=Ht[r];s in n&&n[s]!==void 0&&n[s]!==null&&(this[s]=s==="history"?[...n[s]]:n[s])}let i;for(i in n)Ht.includes(i)||(this[i]=n[i])}get basename(){return typeof this.path=="string"?ut.basename(this.path):void 0}set basename(e){Ut(e,"basename"),qt(e,"basename"),this.path=ut.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?ut.dirname(this.path):void 0}set dirname(e){je(this.basename,"dirname"),this.path=ut.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?ut.extname(this.path):void 0}set extname(e){if(qt(e,"extname"),je(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=ut.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){Jt(e)&&(e=ar(e)),Ut(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?ut.basename(this.path,this.extname):void 0}set stem(e){Ut(e,"stem"),qt(e,"stem"),this.path=ut.join(this.dirname||"",e+(this.extname||""))}fail(e,n,r){const i=this.message(e,n,r);throw i.fatal=!0,i}info(e,n,r){const i=this.message(e,n,r);return i.fatal=void 0,i}message(e,n,r){const i=new tt(e,n,r);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function qt(t,e){if(t&&t.includes(ut.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+ut.sep+"`")}function Ut(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function je(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function ur(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const cr=function(t){const r=this.constructor.prototype,i=r[t],s=function(){return i.apply(s,arguments)};Object.setPrototypeOf(s,r);const a=Object.getOwnPropertyNames(i);for(const o of a){const u=Object.getOwnPropertyDescriptor(i,o);u&&Object.defineProperty(s,o,u)}return s},hr={}.hasOwnProperty;class ae extends cr{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=Yn()}copy(){const e=new ae;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];e.use(...r)}return e.data(Dt(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(Gt("data",this.frozen),this.namespace[e]=n,this):hr.call(this.namespace,e)&&this.namespace[e]||void 0:e?(Gt("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const i=n.call(e,...r);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=Ft(e),r=this.parser||this.Parser;return $t("parse",r),r(String(n),n)}process(e,n){const r=this;return this.freeze(),$t("process",this.parser||this.Parser),Vt("process",this.compiler||this.Compiler),n?i(void 0,n):new Promise(i);function i(s,a){const o=Ft(e),u=r.parse(o);r.run(u,o,function(h,p,f){if(h||!p||!f)return l(h);const c=p,C=r.stringify(c,f);mr(C)?f.value=C:f.result=C,l(h,f)});function l(h,p){h||!p?a(h):s?s(p):n(void 0,p)}}}processSync(e){let n=!1,r;return this.freeze(),$t("processSync",this.parser||this.Parser),Vt("processSync",this.compiler||this.Compiler),this.process(e,i),Pe("processSync","process",n),r;function i(s,a){n=!0,ke(s),r=a}}run(e,n,r){Ne(e),this.freeze();const i=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?s(void 0,r):new Promise(s);function s(a,o){const u=Ft(n);i.run(e,u,l);function l(h,p,f){const c=p||e;h?o(h):a?a(c):r(void 0,c,f)}}}runSync(e,n){let r=!1,i;return this.run(e,n,s),Pe("runSync","run",r),i;function s(a,o){ke(a),i=o,r=!0}}stringify(e,n){this.freeze();const r=Ft(n),i=this.compiler||this.Compiler;return Vt("stringify",i),Ne(e),i(e,r)}use(e,...n){const r=this.attachers,i=this.namespace;if(Gt("use",this.frozen),e!=null)if(typeof e=="function")u(e,n);else if(typeof e=="object")Array.isArray(e)?o(e):a(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function s(l){if(typeof l=="function")u(l,[]);else if(typeof l=="object")if(Array.isArray(l)){const[h,...p]=l;u(h,p)}else a(l);else throw new TypeError("Expected usable value, not `"+l+"`")}function a(l){if(!("plugins"in l)&&!("settings"in l))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(l.plugins),l.settings&&(i.settings=Dt(!0,i.settings,l.settings))}function o(l){let h=-1;if(l!=null)if(Array.isArray(l))for(;++h<l.length;){const p=l[h];s(p)}else throw new TypeError("Expected a list of plugins, not `"+l+"`")}function u(l,h){let p=-1,f=-1;for(;++p<r.length;)if(r[p][0]===l){f=p;break}if(f===-1)r.push([l,...h]);else if(h.length>0){let[c,...C]=h;const I=r[f][1];Xt(I)&&Xt(c)&&(c=Dt(!0,I,c)),r[f]=[l,c,...C]}}}}const pr=new ae().freeze();function $t(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function Vt(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function Gt(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Ne(t){if(!Xt(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function Pe(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function Ft(t){return dr(t)?t:new lr(t)}function dr(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function mr(t){return typeof t=="string"||fr(t)}function fr(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const gr={};function xr(t,e){const n=e||gr,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,i=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return rn(t,r,i)}function rn(t,e,n){if(yr(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return Le(t.children,e,n)}return Array.isArray(t)?Le(t,e,n):""}function Le(t,e,n){const r=[];let i=-1;for(;++i<t.length;)r[i]=rn(t[i],e,n);return r.join("")}function yr(t){return!!(t&&typeof t=="object")}const Fe=document.createElement("i");function oe(t){const e="&"+t+";";Fe.innerHTML=e;const n=Fe.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function ht(t,e,n,r){const i=t.length;let s=0,a;if(e<0?e=-e>i?0:i+e:e=e>i?i:e,n=n>0?n:0,r.length<1e4)a=Array.from(r),a.unshift(e,n),t.splice(...a);else for(n&&t.splice(e,n);s<r.length;)a=r.slice(s,s+1e4),a.unshift(e,0),t.splice(...a),s+=1e4,e+=1e4}function st(t,e){return t.length>0?(ht(t,t.length,0,e),t):e}const Re={}.hasOwnProperty;function br(t){const e={};let n=-1;for(;++n<t.length;)kr(e,t[n]);return e}function kr(t,e){let n;for(n in e){const i=(Re.call(t,n)?t[n]:void 0)||(t[n]={}),s=e[n];let a;if(s)for(a in s){Re.call(i,a)||(i[a]=[]);const o=s[a];wr(i[a],Array.isArray(o)?o:o?[o]:[])}}}function wr(t,e){let n=-1;const r=[];for(;++n<e.length;)(e[n].add==="after"?t:r).push(e[n]);ht(t,0,0,r)}function sn(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"�":String.fromCodePoint(n)}function Et(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const ct=gt(/[A-Za-z]/),ot=gt(/[\dA-Za-z]/),Sr=gt(/[#-'*+\--9=?A-Z^-~]/);function te(t){return t!==null&&(t<32||t===127)}const ee=gt(/\d/),Ir=gt(/[\dA-Fa-f]/),Er=gt(/[!-/:-@[-`{-~]/);function z(t){return t!==null&&t<-2}function J(t){return t!==null&&(t<0||t===32)}function R(t){return t===-2||t===-1||t===32}const Cr=gt(/\p{P}|\p{S}/u),zr=gt(/\s/);function gt(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function V(t,e,n,r){const i=r?r-1:Number.POSITIVE_INFINITY;let s=0;return a;function a(u){return R(u)?(t.enter(n),o(u)):e(u)}function o(u){return R(u)&&s++<i?(t.consume(u),o):(t.exit(n),e(u))}}const Tr={tokenize:Ar};function Ar(t){const e=t.attempt(this.parser.constructs.contentInitial,r,i);let n;return e;function r(o){if(o===null){t.consume(o);return}return t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),V(t,e,"linePrefix")}function i(o){return t.enter("paragraph"),s(o)}function s(o){const u=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=u),n=u,a(o)}function a(o){if(o===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(o);return}return z(o)?(t.consume(o),t.exit("chunkText"),s):(t.consume(o),a)}}const jr={tokenize:Nr},Oe={tokenize:Pr};function Nr(t){const e=this,n=[];let r=0,i,s,a;return o;function o(w){if(r<n.length){const P=n[r];return e.containerState=P[1],t.attempt(P[0].continuation,u,l)(w)}return l(w)}function u(w){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,i&&B();const P=e.events.length;let v=P,y;for(;v--;)if(e.events[v][0]==="exit"&&e.events[v][1].type==="chunkFlow"){y=e.events[v][1].end;break}b(r);let O=P;for(;O<e.events.length;)e.events[O][1].end=Object.assign({},y),O++;return ht(e.events,v+1,0,e.events.slice(P)),e.events.length=O,l(w)}return o(w)}function l(w){if(r===n.length){if(!i)return f(w);if(i.currentConstruct&&i.currentConstruct.concrete)return C(w);e.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(Oe,h,p)(w)}function h(w){return i&&B(),b(r),f(w)}function p(w){return e.parser.lazy[e.now().line]=r!==n.length,a=e.now().offset,C(w)}function f(w){return e.containerState={},t.attempt(Oe,c,C)(w)}function c(w){return r++,n.push([e.currentConstruct,e.containerState]),f(w)}function C(w){if(w===null){i&&B(),b(0),t.consume(w);return}return i=i||e.parser.flow(e.now()),t.enter("chunkFlow",{contentType:"flow",previous:s,_tokenizer:i}),I(w)}function I(w){if(w===null){F(t.exit("chunkFlow"),!0),b(0),t.consume(w);return}return z(w)?(t.consume(w),F(t.exit("chunkFlow")),r=0,e.interrupt=void 0,o):(t.consume(w),I)}function F(w,P){const v=e.sliceStream(w);if(P&&v.push(null),w.previous=s,s&&(s.next=w),s=w,i.defineSkip(w.start),i.write(v),e.parser.lazy[w.start.line]){let y=i.events.length;for(;y--;)if(i.events[y][1].start.offset<a&&(!i.events[y][1].end||i.events[y][1].end.offset>a))return;const O=e.events.length;let G=O,_,M;for(;G--;)if(e.events[G][0]==="exit"&&e.events[G][1].type==="chunkFlow"){if(_){M=e.events[G][1].end;break}_=!0}for(b(r),y=O;y<e.events.length;)e.events[y][1].end=Object.assign({},M),y++;ht(e.events,G+1,0,e.events.slice(O)),e.events.length=y}}function b(w){let P=n.length;for(;P-- >w;){const v=n[P];e.containerState=v[1],v[0].exit.call(e,t)}n.length=w}function B(){i.write([null]),s=void 0,i=void 0,e.containerState._closeFlow=void 0}}function Pr(t,e,n){return V(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function _e(t){if(t===null||J(t)||zr(t))return 1;if(Cr(t))return 2}function le(t,e,n){const r=[];let i=-1;for(;++i<t.length;){const s=t[i].resolveAll;s&&!r.includes(s)&&(e=s(e,n),r.push(s))}return e}const ne={name:"attention",tokenize:Fr,resolveAll:Lr};function Lr(t,e){let n=-1,r,i,s,a,o,u,l,h;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(r=n;r--;)if(t[r][0]==="exit"&&t[r][1].type==="attentionSequence"&&t[r][1]._open&&e.sliceSerialize(t[r][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[r][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[r][1].end.offset-t[r][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;u=t[r][1].end.offset-t[r][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const p=Object.assign({},t[r][1].end),f=Object.assign({},t[n][1].start);Be(p,-u),Be(f,u),a={type:u>1?"strongSequence":"emphasisSequence",start:p,end:Object.assign({},t[r][1].end)},o={type:u>1?"strongSequence":"emphasisSequence",start:Object.assign({},t[n][1].start),end:f},s={type:u>1?"strongText":"emphasisText",start:Object.assign({},t[r][1].end),end:Object.assign({},t[n][1].start)},i={type:u>1?"strong":"emphasis",start:Object.assign({},a.start),end:Object.assign({},o.end)},t[r][1].end=Object.assign({},a.start),t[n][1].start=Object.assign({},o.end),l=[],t[r][1].end.offset-t[r][1].start.offset&&(l=st(l,[["enter",t[r][1],e],["exit",t[r][1],e]])),l=st(l,[["enter",i,e],["enter",a,e],["exit",a,e],["enter",s,e]]),l=st(l,le(e.parser.constructs.insideSpan.null,t.slice(r+1,n),e)),l=st(l,[["exit",s,e],["enter",o,e],["exit",o,e],["exit",i,e]]),t[n][1].end.offset-t[n][1].start.offset?(h=2,l=st(l,[["enter",t[n][1],e],["exit",t[n][1],e]])):h=0,ht(t,r-1,n-r+3,l),n=r+l.length-h-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function Fr(t,e){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,i=_e(r);let s;return a;function a(u){return s=u,t.enter("attentionSequence"),o(u)}function o(u){if(u===s)return t.consume(u),o;const l=t.exit("attentionSequence"),h=_e(u),p=!h||h===2&&i||n.includes(u),f=!i||i===2&&h||n.includes(r);return l._open=!!(s===42?p:p&&(i||!f)),l._close=!!(s===42?f:f&&(h||!p)),e(u)}}function Be(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const Rr={name:"autolink",tokenize:Or};function Or(t,e,n){let r=0;return i;function i(c){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(c),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),s}function s(c){return ct(c)?(t.consume(c),a):l(c)}function a(c){return c===43||c===45||c===46||ot(c)?(r=1,o(c)):l(c)}function o(c){return c===58?(t.consume(c),r=0,u):(c===43||c===45||c===46||ot(c))&&r++<32?(t.consume(c),o):(r=0,l(c))}function u(c){return c===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(c),t.exit("autolinkMarker"),t.exit("autolink"),e):c===null||c===32||c===60||te(c)?n(c):(t.consume(c),u)}function l(c){return c===64?(t.consume(c),h):Sr(c)?(t.consume(c),l):n(c)}function h(c){return ot(c)?p(c):n(c)}function p(c){return c===46?(t.consume(c),r=0,h):c===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(c),t.exit("autolinkMarker"),t.exit("autolink"),e):f(c)}function f(c){if((c===45||ot(c))&&r++<63){const C=c===45?f:p;return t.consume(c),C}return n(c)}}const vt={tokenize:_r,partial:!0};function _r(t,e,n){return r;function r(s){return R(s)?V(t,i,"linePrefix")(s):i(s)}function i(s){return s===null||z(s)?e(s):n(s)}}const an={name:"blockQuote",tokenize:Br,continuation:{tokenize:vr},exit:Mr};function Br(t,e,n){const r=this;return i;function i(a){if(a===62){const o=r.containerState;return o.open||(t.enter("blockQuote",{_container:!0}),o.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(a),t.exit("blockQuoteMarker"),s}return n(a)}function s(a){return R(a)?(t.enter("blockQuotePrefixWhitespace"),t.consume(a),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(a))}}function vr(t,e,n){const r=this;return i;function i(a){return R(a)?V(t,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):s(a)}function s(a){return t.attempt(an,e,n)(a)}}function Mr(t){t.exit("blockQuote")}const on={name:"characterEscape",tokenize:Dr};function Dr(t,e,n){return r;function r(s){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(s),t.exit("escapeMarker"),i}function i(s){return Er(s)?(t.enter("characterEscapeValue"),t.consume(s),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(s)}}const ln={name:"characterReference",tokenize:Hr};function Hr(t,e,n){const r=this;let i=0,s,a;return o;function o(p){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(p),t.exit("characterReferenceMarker"),u}function u(p){return p===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(p),t.exit("characterReferenceMarkerNumeric"),l):(t.enter("characterReferenceValue"),s=31,a=ot,h(p))}function l(p){return p===88||p===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(p),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),s=6,a=Ir,h):(t.enter("characterReferenceValue"),s=7,a=ee,h(p))}function h(p){if(p===59&&i){const f=t.exit("characterReferenceValue");return a===ot&&!oe(r.sliceSerialize(f))?n(p):(t.enter("characterReferenceMarker"),t.consume(p),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return a(p)&&i++<s?(t.consume(p),h):n(p)}}const ve={tokenize:Ur,partial:!0},Me={name:"codeFenced",tokenize:qr,concrete:!0};function qr(t,e,n){const r=this,i={tokenize:v,partial:!0};let s=0,a=0,o;return u;function u(y){return l(y)}function l(y){const O=r.events[r.events.length-1];return s=O&&O[1].type==="linePrefix"?O[2].sliceSerialize(O[1],!0).length:0,o=y,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),h(y)}function h(y){return y===o?(a++,t.consume(y),h):a<3?n(y):(t.exit("codeFencedFenceSequence"),R(y)?V(t,p,"whitespace")(y):p(y))}function p(y){return y===null||z(y)?(t.exit("codeFencedFence"),r.interrupt?e(y):t.check(ve,I,P)(y)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),f(y))}function f(y){return y===null||z(y)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),p(y)):R(y)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),V(t,c,"whitespace")(y)):y===96&&y===o?n(y):(t.consume(y),f)}function c(y){return y===null||z(y)?p(y):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),C(y))}function C(y){return y===null||z(y)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),p(y)):y===96&&y===o?n(y):(t.consume(y),C)}function I(y){return t.attempt(i,P,F)(y)}function F(y){return t.enter("lineEnding"),t.consume(y),t.exit("lineEnding"),b}function b(y){return s>0&&R(y)?V(t,B,"linePrefix",s+1)(y):B(y)}function B(y){return y===null||z(y)?t.check(ve,I,P)(y):(t.enter("codeFlowValue"),w(y))}function w(y){return y===null||z(y)?(t.exit("codeFlowValue"),B(y)):(t.consume(y),w)}function P(y){return t.exit("codeFenced"),e(y)}function v(y,O,G){let _=0;return M;function M(N){return y.enter("lineEnding"),y.consume(N),y.exit("lineEnding"),E}function E(N){return y.enter("codeFencedFence"),R(N)?V(y,S,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(N):S(N)}function S(N){return N===o?(y.enter("codeFencedFenceSequence"),H(N)):G(N)}function H(N){return N===o?(_++,y.consume(N),H):_>=a?(y.exit("codeFencedFenceSequence"),R(N)?V(y,W,"whitespace")(N):W(N)):G(N)}function W(N){return N===null||z(N)?(y.exit("codeFencedFence"),O(N)):G(N)}}}function Ur(t,e,n){const r=this;return i;function i(a){return a===null?n(a):(t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),s)}function s(a){return r.parser.lazy[r.now().line]?n(a):e(a)}}const Wt={name:"codeIndented",tokenize:Vr},$r={tokenize:Gr,partial:!0};function Vr(t,e,n){const r=this;return i;function i(l){return t.enter("codeIndented"),V(t,s,"linePrefix",5)(l)}function s(l){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?a(l):n(l)}function a(l){return l===null?u(l):z(l)?t.attempt($r,a,u)(l):(t.enter("codeFlowValue"),o(l))}function o(l){return l===null||z(l)?(t.exit("codeFlowValue"),a(l)):(t.consume(l),o)}function u(l){return t.exit("codeIndented"),e(l)}}function Gr(t,e,n){const r=this;return i;function i(a){return r.parser.lazy[r.now().line]?n(a):z(a)?(t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),i):V(t,s,"linePrefix",5)(a)}function s(a){const o=r.events[r.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?e(a):z(a)?i(a):n(a)}}const Wr={name:"codeText",tokenize:Yr,resolve:Qr,previous:Kr};function Qr(t){let e=t.length-4,n=3,r,i;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(r=n;++r<e;)if(t[r][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(r=n-1,e++;++r<=e;)i===void 0?r!==e&&t[r][1].type!=="lineEnding"&&(i=r):(r===e||t[r][1].type==="lineEnding")&&(t[i][1].type="codeTextData",r!==i+2&&(t[i][1].end=t[r-1][1].end,t.splice(i+2,r-i-2),e-=r-i-2,r=i+2),i=void 0);return t}function Kr(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Yr(t,e,n){let r=0,i,s;return a;function a(p){return t.enter("codeText"),t.enter("codeTextSequence"),o(p)}function o(p){return p===96?(t.consume(p),r++,o):(t.exit("codeTextSequence"),u(p))}function u(p){return p===null?n(p):p===32?(t.enter("space"),t.consume(p),t.exit("space"),u):p===96?(s=t.enter("codeTextSequence"),i=0,h(p)):z(p)?(t.enter("lineEnding"),t.consume(p),t.exit("lineEnding"),u):(t.enter("codeTextData"),l(p))}function l(p){return p===null||p===32||p===96||z(p)?(t.exit("codeTextData"),u(p)):(t.consume(p),l)}function h(p){return p===96?(t.consume(p),i++,h):i===r?(t.exit("codeTextSequence"),t.exit("codeText"),e(p)):(s.type="codeTextData",l(p))}}function un(t){const e={};let n=-1,r,i,s,a,o,u,l;for(;++n<t.length;){for(;n in e;)n=e[n];if(r=t[n],n&&r[1].type==="chunkFlow"&&t[n-1][1].type==="listItemPrefix"&&(u=r[1]._tokenizer.events,s=0,s<u.length&&u[s][1].type==="lineEndingBlank"&&(s+=2),s<u.length&&u[s][1].type==="content"))for(;++s<u.length&&u[s][1].type!=="content";)u[s][1].type==="chunkText"&&(u[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,Xr(t,n)),n=e[n],l=!0);else if(r[1]._container){for(s=n,i=void 0;s--&&(a=t[s],a[1].type==="lineEnding"||a[1].type==="lineEndingBlank");)a[0]==="enter"&&(i&&(t[i][1].type="lineEndingBlank"),a[1].type="lineEnding",i=s);i&&(r[1].end=Object.assign({},t[i][1].start),o=t.slice(i,n),o.unshift(r),ht(t,i,n-i+1,o))}}return!l}function Xr(t,e){const n=t[e][1],r=t[e][2];let i=e-1;const s=[],a=n._tokenizer||r.parser[n.contentType](n.start),o=a.events,u=[],l={};let h,p,f=-1,c=n,C=0,I=0;const F=[I];for(;c;){for(;t[++i][1]!==c;);s.push(i),c._tokenizer||(h=r.sliceStream(c),c.next||h.push(null),p&&a.defineSkip(c.start),c._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(h),c._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),p=c,c=c.next}for(c=n;++f<o.length;)o[f][0]==="exit"&&o[f-1][0]==="enter"&&o[f][1].type===o[f-1][1].type&&o[f][1].start.line!==o[f][1].end.line&&(I=f+1,F.push(I),c._tokenizer=void 0,c.previous=void 0,c=c.next);for(a.events=[],c?(c._tokenizer=void 0,c.previous=void 0):F.pop(),f=F.length;f--;){const b=o.slice(F[f],F[f+1]),B=s.pop();u.unshift([B,B+b.length-1]),ht(t,B,2,b)}for(f=-1;++f<u.length;)l[C+u[f][0]]=C+u[f][1],C+=u[f][1]-u[f][0]-1;return l}const Zr={tokenize:ei,resolve:ti},Jr={tokenize:ni,partial:!0};function ti(t){return un(t),t}function ei(t,e){let n;return r;function r(o){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),i(o)}function i(o){return o===null?s(o):z(o)?t.check(Jr,a,s)(o):(t.consume(o),i)}function s(o){return t.exit("chunkContent"),t.exit("content"),e(o)}function a(o){return t.consume(o),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,i}}function ni(t,e,n){const r=this;return i;function i(a){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),V(t,s,"linePrefix")}function s(a){if(a===null||z(a))return n(a);const o=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?e(a):t.interrupt(r.parser.constructs.flow,n,e)(a)}}function cn(t,e,n,r,i,s,a,o,u){const l=u||Number.POSITIVE_INFINITY;let h=0;return p;function p(b){return b===60?(t.enter(r),t.enter(i),t.enter(s),t.consume(b),t.exit(s),f):b===null||b===32||b===41||te(b)?n(b):(t.enter(r),t.enter(a),t.enter(o),t.enter("chunkString",{contentType:"string"}),I(b))}function f(b){return b===62?(t.enter(s),t.consume(b),t.exit(s),t.exit(i),t.exit(r),e):(t.enter(o),t.enter("chunkString",{contentType:"string"}),c(b))}function c(b){return b===62?(t.exit("chunkString"),t.exit(o),f(b)):b===null||b===60||z(b)?n(b):(t.consume(b),b===92?C:c)}function C(b){return b===60||b===62||b===92?(t.consume(b),c):c(b)}function I(b){return!h&&(b===null||b===41||J(b))?(t.exit("chunkString"),t.exit(o),t.exit(a),t.exit(r),e(b)):h<l&&b===40?(t.consume(b),h++,I):b===41?(t.consume(b),h--,I):b===null||b===32||b===40||te(b)?n(b):(t.consume(b),b===92?F:I)}function F(b){return b===40||b===41||b===92?(t.consume(b),I):I(b)}}function hn(t,e,n,r,i,s){const a=this;let o=0,u;return l;function l(c){return t.enter(r),t.enter(i),t.consume(c),t.exit(i),t.enter(s),h}function h(c){return o>999||c===null||c===91||c===93&&!u||c===94&&!o&&"_hiddenFootnoteSupport"in a.parser.constructs?n(c):c===93?(t.exit(s),t.enter(i),t.consume(c),t.exit(i),t.exit(r),e):z(c)?(t.enter("lineEnding"),t.consume(c),t.exit("lineEnding"),h):(t.enter("chunkString",{contentType:"string"}),p(c))}function p(c){return c===null||c===91||c===93||z(c)||o++>999?(t.exit("chunkString"),h(c)):(t.consume(c),u||(u=!R(c)),c===92?f:p)}function f(c){return c===91||c===92||c===93?(t.consume(c),o++,p):p(c)}}function pn(t,e,n,r,i,s){let a;return o;function o(f){return f===34||f===39||f===40?(t.enter(r),t.enter(i),t.consume(f),t.exit(i),a=f===40?41:f,u):n(f)}function u(f){return f===a?(t.enter(i),t.consume(f),t.exit(i),t.exit(r),e):(t.enter(s),l(f))}function l(f){return f===a?(t.exit(s),u(a)):f===null?n(f):z(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),V(t,l,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),h(f))}function h(f){return f===a||f===null||z(f)?(t.exit("chunkString"),l(f)):(t.consume(f),f===92?p:h)}function p(f){return f===a||f===92?(t.consume(f),h):h(f)}}function Nt(t,e){let n;return r;function r(i){return z(i)?(t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),n=!0,r):R(i)?V(t,r,n?"linePrefix":"lineSuffix")(i):e(i)}}const ri={name:"definition",tokenize:si},ii={tokenize:ai,partial:!0};function si(t,e,n){const r=this;let i;return s;function s(c){return t.enter("definition"),a(c)}function a(c){return hn.call(r,t,o,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(c)}function o(c){return i=Et(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),c===58?(t.enter("definitionMarker"),t.consume(c),t.exit("definitionMarker"),u):n(c)}function u(c){return J(c)?Nt(t,l)(c):l(c)}function l(c){return cn(t,h,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(c)}function h(c){return t.attempt(ii,p,p)(c)}function p(c){return R(c)?V(t,f,"whitespace")(c):f(c)}function f(c){return c===null||z(c)?(t.exit("definition"),r.parser.defined.push(i),e(c)):n(c)}}function ai(t,e,n){return r;function r(o){return J(o)?Nt(t,i)(o):n(o)}function i(o){return pn(t,s,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function s(o){return R(o)?V(t,a,"whitespace")(o):a(o)}function a(o){return o===null||z(o)?e(o):n(o)}}const oi={name:"hardBreakEscape",tokenize:li};function li(t,e,n){return r;function r(s){return t.enter("hardBreakEscape"),t.consume(s),i}function i(s){return z(s)?(t.exit("hardBreakEscape"),e(s)):n(s)}}const ui={name:"headingAtx",tokenize:hi,resolve:ci};function ci(t,e){let n=t.length-2,r=3,i,s;return t[r][1].type==="whitespace"&&(r+=2),n-2>r&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&t[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(i={type:"atxHeadingText",start:t[r][1].start,end:t[n][1].end},s={type:"chunkText",start:t[r][1].start,end:t[n][1].end,contentType:"text"},ht(t,r,n-r+1,[["enter",i,e],["enter",s,e],["exit",s,e],["exit",i,e]])),t}function hi(t,e,n){let r=0;return i;function i(h){return t.enter("atxHeading"),s(h)}function s(h){return t.enter("atxHeadingSequence"),a(h)}function a(h){return h===35&&r++<6?(t.consume(h),a):h===null||J(h)?(t.exit("atxHeadingSequence"),o(h)):n(h)}function o(h){return h===35?(t.enter("atxHeadingSequence"),u(h)):h===null||z(h)?(t.exit("atxHeading"),e(h)):R(h)?V(t,o,"whitespace")(h):(t.enter("atxHeadingText"),l(h))}function u(h){return h===35?(t.consume(h),u):(t.exit("atxHeadingSequence"),o(h))}function l(h){return h===null||h===35||J(h)?(t.exit("atxHeadingText"),o(h)):(t.consume(h),l)}}const pi=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],De=["pre","script","style","textarea"],di={name:"htmlFlow",tokenize:xi,resolveTo:gi,concrete:!0},mi={tokenize:bi,partial:!0},fi={tokenize:yi,partial:!0};function gi(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function xi(t,e,n){const r=this;let i,s,a,o,u;return l;function l(d){return h(d)}function h(d){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(d),p}function p(d){return d===33?(t.consume(d),f):d===47?(t.consume(d),s=!0,I):d===63?(t.consume(d),i=3,r.interrupt?e:m):ct(d)?(t.consume(d),a=String.fromCharCode(d),F):n(d)}function f(d){return d===45?(t.consume(d),i=2,c):d===91?(t.consume(d),i=5,o=0,C):ct(d)?(t.consume(d),i=4,r.interrupt?e:m):n(d)}function c(d){return d===45?(t.consume(d),r.interrupt?e:m):n(d)}function C(d){const j="CDATA[";return d===j.charCodeAt(o++)?(t.consume(d),o===j.length?r.interrupt?e:S:C):n(d)}function I(d){return ct(d)?(t.consume(d),a=String.fromCharCode(d),F):n(d)}function F(d){if(d===null||d===47||d===62||J(d)){const j=d===47,Q=a.toLowerCase();return!j&&!s&&De.includes(Q)?(i=1,r.interrupt?e(d):S(d)):pi.includes(a.toLowerCase())?(i=6,j?(t.consume(d),b):r.interrupt?e(d):S(d)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(d):s?B(d):w(d))}return d===45||ot(d)?(t.consume(d),a+=String.fromCharCode(d),F):n(d)}function b(d){return d===62?(t.consume(d),r.interrupt?e:S):n(d)}function B(d){return R(d)?(t.consume(d),B):M(d)}function w(d){return d===47?(t.consume(d),M):d===58||d===95||ct(d)?(t.consume(d),P):R(d)?(t.consume(d),w):M(d)}function P(d){return d===45||d===46||d===58||d===95||ot(d)?(t.consume(d),P):v(d)}function v(d){return d===61?(t.consume(d),y):R(d)?(t.consume(d),v):w(d)}function y(d){return d===null||d===60||d===61||d===62||d===96?n(d):d===34||d===39?(t.consume(d),u=d,O):R(d)?(t.consume(d),y):G(d)}function O(d){return d===u?(t.consume(d),u=null,_):d===null||z(d)?n(d):(t.consume(d),O)}function G(d){return d===null||d===34||d===39||d===47||d===60||d===61||d===62||d===96||J(d)?v(d):(t.consume(d),G)}function _(d){return d===47||d===62||R(d)?w(d):n(d)}function M(d){return d===62?(t.consume(d),E):n(d)}function E(d){return d===null||z(d)?S(d):R(d)?(t.consume(d),E):n(d)}function S(d){return d===45&&i===2?(t.consume(d),Y):d===60&&i===1?(t.consume(d),K):d===62&&i===4?(t.consume(d),T):d===63&&i===3?(t.consume(d),m):d===93&&i===5?(t.consume(d),rt):z(d)&&(i===6||i===7)?(t.exit("htmlFlowData"),t.check(mi,q,H)(d)):d===null||z(d)?(t.exit("htmlFlowData"),H(d)):(t.consume(d),S)}function H(d){return t.check(fi,W,q)(d)}function W(d){return t.enter("lineEnding"),t.consume(d),t.exit("lineEnding"),N}function N(d){return d===null||z(d)?H(d):(t.enter("htmlFlowData"),S(d))}function Y(d){return d===45?(t.consume(d),m):S(d)}function K(d){return d===47?(t.consume(d),a="",et):S(d)}function et(d){if(d===62){const j=a.toLowerCase();return De.includes(j)?(t.consume(d),T):S(d)}return ct(d)&&a.length<8?(t.consume(d),a+=String.fromCharCode(d),et):S(d)}function rt(d){return d===93?(t.consume(d),m):S(d)}function m(d){return d===62?(t.consume(d),T):d===45&&i===2?(t.consume(d),m):S(d)}function T(d){return d===null||z(d)?(t.exit("htmlFlowData"),q(d)):(t.consume(d),T)}function q(d){return t.exit("htmlFlow"),e(d)}}function yi(t,e,n){const r=this;return i;function i(a){return z(a)?(t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),s):n(a)}function s(a){return r.parser.lazy[r.now().line]?n(a):e(a)}}function bi(t,e,n){return r;function r(i){return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),t.attempt(vt,e,n)}}const ki={name:"htmlText",tokenize:wi};function wi(t,e,n){const r=this;let i,s,a;return o;function o(m){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(m),u}function u(m){return m===33?(t.consume(m),l):m===47?(t.consume(m),v):m===63?(t.consume(m),w):ct(m)?(t.consume(m),G):n(m)}function l(m){return m===45?(t.consume(m),h):m===91?(t.consume(m),s=0,C):ct(m)?(t.consume(m),B):n(m)}function h(m){return m===45?(t.consume(m),c):n(m)}function p(m){return m===null?n(m):m===45?(t.consume(m),f):z(m)?(a=p,K(m)):(t.consume(m),p)}function f(m){return m===45?(t.consume(m),c):p(m)}function c(m){return m===62?Y(m):m===45?f(m):p(m)}function C(m){const T="CDATA[";return m===T.charCodeAt(s++)?(t.consume(m),s===T.length?I:C):n(m)}function I(m){return m===null?n(m):m===93?(t.consume(m),F):z(m)?(a=I,K(m)):(t.consume(m),I)}function F(m){return m===93?(t.consume(m),b):I(m)}function b(m){return m===62?Y(m):m===93?(t.consume(m),b):I(m)}function B(m){return m===null||m===62?Y(m):z(m)?(a=B,K(m)):(t.consume(m),B)}function w(m){return m===null?n(m):m===63?(t.consume(m),P):z(m)?(a=w,K(m)):(t.consume(m),w)}function P(m){return m===62?Y(m):w(m)}function v(m){return ct(m)?(t.consume(m),y):n(m)}function y(m){return m===45||ot(m)?(t.consume(m),y):O(m)}function O(m){return z(m)?(a=O,K(m)):R(m)?(t.consume(m),O):Y(m)}function G(m){return m===45||ot(m)?(t.consume(m),G):m===47||m===62||J(m)?_(m):n(m)}function _(m){return m===47?(t.consume(m),Y):m===58||m===95||ct(m)?(t.consume(m),M):z(m)?(a=_,K(m)):R(m)?(t.consume(m),_):Y(m)}function M(m){return m===45||m===46||m===58||m===95||ot(m)?(t.consume(m),M):E(m)}function E(m){return m===61?(t.consume(m),S):z(m)?(a=E,K(m)):R(m)?(t.consume(m),E):_(m)}function S(m){return m===null||m===60||m===61||m===62||m===96?n(m):m===34||m===39?(t.consume(m),i=m,H):z(m)?(a=S,K(m)):R(m)?(t.consume(m),S):(t.consume(m),W)}function H(m){return m===i?(t.consume(m),i=void 0,N):m===null?n(m):z(m)?(a=H,K(m)):(t.consume(m),H)}function W(m){return m===null||m===34||m===39||m===60||m===61||m===96?n(m):m===47||m===62||J(m)?_(m):(t.consume(m),W)}function N(m){return m===47||m===62||J(m)?_(m):n(m)}function Y(m){return m===62?(t.consume(m),t.exit("htmlTextData"),t.exit("htmlText"),e):n(m)}function K(m){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(m),t.exit("lineEnding"),et}function et(m){return R(m)?V(t,rt,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(m):rt(m)}function rt(m){return t.enter("htmlTextData"),a(m)}}const ue={name:"labelEnd",tokenize:Ti,resolveTo:zi,resolveAll:Ci},Si={tokenize:Ai},Ii={tokenize:ji},Ei={tokenize:Ni};function Ci(t){let e=-1;for(;++e<t.length;){const n=t[e][1];(n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd")&&(t.splice(e+1,n.type==="labelImage"?4:2),n.type="data",e++)}return t}function zi(t,e){let n=t.length,r=0,i,s,a,o;for(;n--;)if(i=t[n][1],s){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;t[n][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(a){if(t[n][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(s=n,i.type!=="labelLink")){r=2;break}}else i.type==="labelEnd"&&(a=n);const u={type:t[s][1].type==="labelLink"?"link":"image",start:Object.assign({},t[s][1].start),end:Object.assign({},t[t.length-1][1].end)},l={type:"label",start:Object.assign({},t[s][1].start),end:Object.assign({},t[a][1].end)},h={type:"labelText",start:Object.assign({},t[s+r+2][1].end),end:Object.assign({},t[a-2][1].start)};return o=[["enter",u,e],["enter",l,e]],o=st(o,t.slice(s+1,s+r+3)),o=st(o,[["enter",h,e]]),o=st(o,le(e.parser.constructs.insideSpan.null,t.slice(s+r+4,a-3),e)),o=st(o,[["exit",h,e],t[a-2],t[a-1],["exit",l,e]]),o=st(o,t.slice(a+1)),o=st(o,[["exit",u,e]]),ht(t,s,t.length,o),t}function Ti(t,e,n){const r=this;let i=r.events.length,s,a;for(;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){s=r.events[i][1];break}return o;function o(f){return s?s._inactive?p(f):(a=r.parser.defined.includes(Et(r.sliceSerialize({start:s.end,end:r.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(f),t.exit("labelMarker"),t.exit("labelEnd"),u):n(f)}function u(f){return f===40?t.attempt(Si,h,a?h:p)(f):f===91?t.attempt(Ii,h,a?l:p)(f):a?h(f):p(f)}function l(f){return t.attempt(Ei,h,p)(f)}function h(f){return e(f)}function p(f){return s._balanced=!0,n(f)}}function Ai(t,e,n){return r;function r(p){return t.enter("resource"),t.enter("resourceMarker"),t.consume(p),t.exit("resourceMarker"),i}function i(p){return J(p)?Nt(t,s)(p):s(p)}function s(p){return p===41?h(p):cn(t,a,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(p)}function a(p){return J(p)?Nt(t,u)(p):h(p)}function o(p){return n(p)}function u(p){return p===34||p===39||p===40?pn(t,l,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(p):h(p)}function l(p){return J(p)?Nt(t,h)(p):h(p)}function h(p){return p===41?(t.enter("resourceMarker"),t.consume(p),t.exit("resourceMarker"),t.exit("resource"),e):n(p)}}function ji(t,e,n){const r=this;return i;function i(o){return hn.call(r,t,s,a,"reference","referenceMarker","referenceString")(o)}function s(o){return r.parser.defined.includes(Et(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(o):n(o)}function a(o){return n(o)}}function Ni(t,e,n){return r;function r(s){return t.enter("reference"),t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),i}function i(s){return s===93?(t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),t.exit("reference"),e):n(s)}}const Pi={name:"labelStartImage",tokenize:Li,resolveAll:ue.resolveAll};function Li(t,e,n){const r=this;return i;function i(o){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(o),t.exit("labelImageMarker"),s}function s(o){return o===91?(t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelImage"),a):n(o)}function a(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):e(o)}}const Fi={name:"labelStartLink",tokenize:Ri,resolveAll:ue.resolveAll};function Ri(t,e,n){const r=this;return i;function i(a){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(a),t.exit("labelMarker"),t.exit("labelLink"),s}function s(a){return a===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(a):e(a)}}const Qt={name:"lineEnding",tokenize:Oi};function Oi(t,e){return n;function n(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),V(t,e,"linePrefix")}}const Ot={name:"thematicBreak",tokenize:_i};function _i(t,e,n){let r=0,i;return s;function s(l){return t.enter("thematicBreak"),a(l)}function a(l){return i=l,o(l)}function o(l){return l===i?(t.enter("thematicBreakSequence"),u(l)):r>=3&&(l===null||z(l))?(t.exit("thematicBreak"),e(l)):n(l)}function u(l){return l===i?(t.consume(l),r++,u):(t.exit("thematicBreakSequence"),R(l)?V(t,o,"whitespace")(l):o(l))}}const Z={name:"list",tokenize:Mi,continuation:{tokenize:Di},exit:qi},Bi={tokenize:Ui,partial:!0},vi={tokenize:Hi,partial:!0};function Mi(t,e,n){const r=this,i=r.events[r.events.length-1];let s=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,a=0;return o;function o(c){const C=r.containerState.type||(c===42||c===43||c===45?"listUnordered":"listOrdered");if(C==="listUnordered"?!r.containerState.marker||c===r.containerState.marker:ee(c)){if(r.containerState.type||(r.containerState.type=C,t.enter(C,{_container:!0})),C==="listUnordered")return t.enter("listItemPrefix"),c===42||c===45?t.check(Ot,n,l)(c):l(c);if(!r.interrupt||c===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),u(c)}return n(c)}function u(c){return ee(c)&&++a<10?(t.consume(c),u):(!r.interrupt||a<2)&&(r.containerState.marker?c===r.containerState.marker:c===41||c===46)?(t.exit("listItemValue"),l(c)):n(c)}function l(c){return t.enter("listItemMarker"),t.consume(c),t.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||c,t.check(vt,r.interrupt?n:h,t.attempt(Bi,f,p))}function h(c){return r.containerState.initialBlankLine=!0,s++,f(c)}function p(c){return R(c)?(t.enter("listItemPrefixWhitespace"),t.consume(c),t.exit("listItemPrefixWhitespace"),f):n(c)}function f(c){return r.containerState.size=s+r.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(c)}}function Di(t,e,n){const r=this;return r.containerState._closeFlow=void 0,t.check(vt,i,s);function i(o){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,V(t,e,"listItemIndent",r.containerState.size+1)(o)}function s(o){return r.containerState.furtherBlankLines||!R(o)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,a(o)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,t.attempt(vi,e,a)(o))}function a(o){return r.containerState._closeFlow=!0,r.interrupt=void 0,V(t,t.attempt(Z,e,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function Hi(t,e,n){const r=this;return V(t,i,"listItemIndent",r.containerState.size+1);function i(s){const a=r.events[r.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===r.containerState.size?e(s):n(s)}}function qi(t){t.exit(this.containerState.type)}function Ui(t,e,n){const r=this;return V(t,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(s){const a=r.events[r.events.length-1];return!R(s)&&a&&a[1].type==="listItemPrefixWhitespace"?e(s):n(s)}}const He={name:"setextUnderline",tokenize:Vi,resolveTo:$i};function $i(t,e){let n=t.length,r,i,s;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){r=n;break}t[n][1].type==="paragraph"&&(i=n)}else t[n][1].type==="content"&&t.splice(n,1),!s&&t[n][1].type==="definition"&&(s=n);const a={type:"setextHeading",start:Object.assign({},t[i][1].start),end:Object.assign({},t[t.length-1][1].end)};return t[i][1].type="setextHeadingText",s?(t.splice(i,0,["enter",a,e]),t.splice(s+1,0,["exit",t[r][1],e]),t[r][1].end=Object.assign({},t[s][1].end)):t[r][1]=a,t.push(["exit",a,e]),t}function Vi(t,e,n){const r=this;let i;return s;function s(l){let h=r.events.length,p;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){p=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||p)?(t.enter("setextHeadingLine"),i=l,a(l)):n(l)}function a(l){return t.enter("setextHeadingLineSequence"),o(l)}function o(l){return l===i?(t.consume(l),o):(t.exit("setextHeadingLineSequence"),R(l)?V(t,u,"lineSuffix")(l):u(l))}function u(l){return l===null||z(l)?(t.exit("setextHeadingLine"),e(l)):n(l)}}const Gi={tokenize:Wi};function Wi(t){const e=this,n=t.attempt(vt,r,t.attempt(this.parser.constructs.flowInitial,i,V(t,t.attempt(this.parser.constructs.flow,i,t.attempt(Zr,i)),"linePrefix")));return n;function r(s){if(s===null){t.consume(s);return}return t.enter("lineEndingBlank"),t.consume(s),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function i(s){if(s===null){t.consume(s);return}return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const Qi={resolveAll:mn()},Ki=dn("string"),Yi=dn("text");function dn(t){return{tokenize:e,resolveAll:mn(t==="text"?Xi:void 0)};function e(n){const r=this,i=this.parser.constructs[t],s=n.attempt(i,a,o);return a;function a(h){return l(h)?s(h):o(h)}function o(h){if(h===null){n.consume(h);return}return n.enter("data"),n.consume(h),u}function u(h){return l(h)?(n.exit("data"),s(h)):(n.consume(h),u)}function l(h){if(h===null)return!0;const p=i[h];let f=-1;if(p)for(;++f<p.length;){const c=p[f];if(!c.previous||c.previous.call(r,r.previous))return!0}return!1}}}function mn(t){return e;function e(n,r){let i=-1,s;for(;++i<=n.length;)s===void 0?n[i]&&n[i][1].type==="data"&&(s=i,i++):(!n[i]||n[i][1].type!=="data")&&(i!==s+2&&(n[s][1].end=n[i-1][1].end,n.splice(s+2,i-s-2),i=s+2),s=void 0);return t?t(n,r):n}}function Xi(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const r=t[n-1][1],i=e.sliceStream(r);let s=i.length,a=-1,o=0,u;for(;s--;){const l=i[s];if(typeof l=="string"){for(a=l.length;l.charCodeAt(a-1)===32;)o++,a--;if(a)break;a=-1}else if(l===-2)u=!0,o++;else if(l!==-1){s++;break}}if(o){const l={type:n===t.length||u||o<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-o,offset:r.end.offset-o,_index:r.start._index+s,_bufferIndex:s?a:r.start._bufferIndex+a},end:Object.assign({},r.end)};r.end=Object.assign({},l.start),r.start.offset===r.end.offset?Object.assign(r,l):(t.splice(n,0,["enter",l,e],["exit",l,e]),n+=2)}n++}return t}function Zi(t,e,n){let r=Object.assign(n?Object.assign({},n):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1});const i={},s=[];let a=[],o=[];const u={consume:B,enter:w,exit:P,attempt:O(v),check:O(y),interrupt:O(y,{interrupt:!0})},l={previous:null,code:null,containerState:{},events:[],parser:t,sliceStream:c,sliceSerialize:f,now:C,defineSkip:I,write:p};let h=e.tokenize.call(l,u);return e.resolveAll&&s.push(e),l;function p(E){return a=st(a,E),F(),a[a.length-1]!==null?[]:(G(e,0),l.events=le(s,l.events,l),l.events)}function f(E,S){return ts(c(E),S)}function c(E){return Ji(a,E)}function C(){const{line:E,column:S,offset:H,_index:W,_bufferIndex:N}=r;return{line:E,column:S,offset:H,_index:W,_bufferIndex:N}}function I(E){i[E.line]=E.column,M()}function F(){let E;for(;r._index<a.length;){const S=a[r._index];if(typeof S=="string")for(E=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===E&&r._bufferIndex<S.length;)b(S.charCodeAt(r._bufferIndex));else b(S)}}function b(E){h=h(E)}function B(E){z(E)?(r.line++,r.column=1,r.offset+=E===-3?2:1,M()):E!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===a[r._index].length&&(r._bufferIndex=-1,r._index++)),l.previous=E}function w(E,S){const H=S||{};return H.type=E,H.start=C(),l.events.push(["enter",H,l]),o.push(H),H}function P(E){const S=o.pop();return S.end=C(),l.events.push(["exit",S,l]),S}function v(E,S){G(E,S.from)}function y(E,S){S.restore()}function O(E,S){return H;function H(W,N,Y){let K,et,rt,m;return Array.isArray(W)?q(W):"tokenize"in W?q([W]):T(W);function T($){return xt;function xt(it){const yt=it!==null&&$[it],bt=it!==null&&$.null,Mt=[...Array.isArray(yt)?yt:yt?[yt]:[],...Array.isArray(bt)?bt:bt?[bt]:[]];return q(Mt)(it)}}function q($){return K=$,et=0,$.length===0?Y:d($[et])}function d($){return xt;function xt(it){return m=_(),rt=$,$.partial||(l.currentConstruct=$),$.name&&l.parser.constructs.disable.null.includes($.name)?Q():$.tokenize.call(S?Object.assign(Object.create(l),S):l,u,j,Q)(it)}}function j($){return E(rt,m),N}function Q($){return m.restore(),++et<K.length?d(K[et]):Y}}}function G(E,S){E.resolveAll&&!s.includes(E)&&s.push(E),E.resolve&&ht(l.events,S,l.events.length-S,E.resolve(l.events.slice(S),l)),E.resolveTo&&(l.events=E.resolveTo(l.events,l))}function _(){const E=C(),S=l.previous,H=l.currentConstruct,W=l.events.length,N=Array.from(o);return{restore:Y,from:W};function Y(){r=E,l.previous=S,l.currentConstruct=H,l.events.length=W,o=N,M()}}function M(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function Ji(t,e){const n=e.start._index,r=e.start._bufferIndex,i=e.end._index,s=e.end._bufferIndex;let a;if(n===i)a=[t[n].slice(r,s)];else{if(a=t.slice(n,i),r>-1){const o=a[0];typeof o=="string"?a[0]=o.slice(r):a.shift()}s>0&&a.push(t[i].slice(0,s))}return a}function ts(t,e){let n=-1;const r=[];let i;for(;++n<t.length;){const s=t[n];let a;if(typeof s=="string")a=s;else switch(s){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=e?" ":"	";break}case-1:{if(!e&&i)continue;a=" ";break}default:a=String.fromCharCode(s)}i=s===-2,r.push(a)}return r.join("")}const es={42:Z,43:Z,45:Z,48:Z,49:Z,50:Z,51:Z,52:Z,53:Z,54:Z,55:Z,56:Z,57:Z,62:an},ns={91:ri},rs={[-2]:Wt,[-1]:Wt,32:Wt},is={35:ui,42:Ot,45:[He,Ot],60:di,61:He,95:Ot,96:Me,126:Me},ss={38:ln,92:on},as={[-5]:Qt,[-4]:Qt,[-3]:Qt,33:Pi,38:ln,42:ne,60:[Rr,ki],91:Fi,92:[oi,on],93:ue,95:ne,96:Wr},os={null:[ne,Qi]},ls={null:[42,95]},us={null:[]},cs=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:ls,contentInitial:ns,disable:us,document:es,flow:is,flowInitial:rs,insideSpan:os,string:ss,text:as},Symbol.toStringTag,{value:"Module"}));function hs(t){const n=br([cs,...(t||{}).extensions||[]]),r={defined:[],lazy:{},constructs:n,content:i(Tr),document:i(jr),flow:i(Gi),string:i(Ki),text:i(Yi)};return r;function i(s){return a;function a(o){return Zi(r,s,o)}}}function ps(t){for(;!un(t););return t}const qe=/[\0\t\n\r]/g;function ds(){let t=1,e="",n=!0,r;return i;function i(s,a,o){const u=[];let l,h,p,f,c;for(s=e+(typeof s=="string"?s.toString():new TextDecoder(a||void 0).decode(s)),p=0,e="",n&&(s.charCodeAt(0)===65279&&p++,n=void 0);p<s.length;){if(qe.lastIndex=p,l=qe.exec(s),f=l&&l.index!==void 0?l.index:s.length,c=s.charCodeAt(f),!l){e=s.slice(p);break}if(c===10&&p===f&&r)u.push(-3),r=void 0;else switch(r&&(u.push(-5),r=void 0),p<f&&(u.push(s.slice(p,f)),t+=f-p),c){case 0:{u.push(65533),t++;break}case 9:{for(h=Math.ceil(t/4)*4,u.push(-2);t++<h;)u.push(-1);break}case 10:{u.push(-4),t=1;break}default:r=!0,t=1}p=f+1}return o&&(r&&u.push(-5),e&&u.push(e),u.push(null)),u}}const ms=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function fs(t){return t.replace(ms,gs)}function gs(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const i=n.charCodeAt(1),s=i===120||i===88;return sn(n.slice(s?2:1),s?16:10)}return oe(n)||t}const fn={}.hasOwnProperty;function xs(t,e,n){return typeof e!="string"&&(n=e,e=void 0),ys(n)(ps(hs(n).document().write(ds()(t,e,!0))))}function ys(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(de),autolinkProtocol:_,autolinkEmail:_,atxHeading:s(ce),blockQuote:s(yt),characterEscape:_,characterReference:_,codeFenced:s(bt),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:s(bt,a),codeText:s(Mt,a),codeTextData:_,data:_,codeFlowValue:_,definition:s(bn),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:s(kn),hardBreakEscape:s(he),hardBreakTrailing:s(he),htmlFlow:s(pe,a),htmlFlowData:_,htmlText:s(pe,a),htmlTextData:_,image:s(wn),label:a,link:s(de),listItem:s(Sn),listItemValue:f,listOrdered:s(me,p),listUnordered:s(me),paragraph:s(In),reference:d,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:s(ce),strong:s(En),thematicBreak:s(zn)},exit:{atxHeading:u(),atxHeadingSequence:v,autolink:u(),autolinkEmail:it,autolinkProtocol:xt,blockQuote:u(),characterEscapeValue:M,characterReferenceMarkerHexadecimal:Q,characterReferenceMarkerNumeric:Q,characterReferenceValue:$,codeFenced:u(F),codeFencedFence:I,codeFencedFenceInfo:c,codeFencedFenceMeta:C,codeFlowValue:M,codeIndented:u(b),codeText:u(N),codeTextData:M,data:M,definition:u(),definitionDestinationString:P,definitionLabelString:B,definitionTitleString:w,emphasis:u(),hardBreakEscape:u(S),hardBreakTrailing:u(S),htmlFlow:u(H),htmlFlowData:M,htmlText:u(W),htmlTextData:M,image:u(K),label:rt,labelText:et,lineEnding:E,link:u(Y),listItem:u(),listOrdered:u(),listUnordered:u(),paragraph:u(),referenceString:j,resourceDestinationString:m,resourceTitleString:T,resource:q,setextHeading:u(G),setextHeadingLineSequence:O,setextHeadingText:y,strong:u(),thematicBreak:u()}};gn(e,(t||{}).mdastExtensions||[]);const n={};return r;function r(x){let k={type:"root",children:[]};const A={stack:[k],tokenStack:[],config:e,enter:o,exit:l,buffer:a,resume:h,data:n},L=[];let D=-1;for(;++D<x.length;)if(x[D][1].type==="listOrdered"||x[D][1].type==="listUnordered")if(x[D][0]==="enter")L.push(D);else{const at=L.pop();D=i(x,at,D)}for(D=-1;++D<x.length;){const at=e[x[D][0]];fn.call(at,x[D][1].type)&&at[x[D][1].type].call(Object.assign({sliceSerialize:x[D][2].sliceSerialize},A),x[D][1])}if(A.tokenStack.length>0){const at=A.tokenStack[A.tokenStack.length-1];(at[1]||Ue).call(A,void 0,at[0])}for(k.position={start:mt(x.length>0?x[0][1].start:{line:1,column:1,offset:0}),end:mt(x.length>0?x[x.length-2][1].end:{line:1,column:1,offset:0})},D=-1;++D<e.transforms.length;)k=e.transforms[D](k)||k;return k}function i(x,k,A){let L=k-1,D=-1,at=!1,kt,pt,zt,Tt;for(;++L<=A;){const nt=x[L];switch(nt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{nt[0]==="enter"?D++:D--,Tt=void 0;break}case"lineEndingBlank":{nt[0]==="enter"&&(kt&&!Tt&&!D&&!zt&&(zt=L),Tt=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Tt=void 0}if(!D&&nt[0]==="enter"&&nt[1].type==="listItemPrefix"||D===-1&&nt[0]==="exit"&&(nt[1].type==="listUnordered"||nt[1].type==="listOrdered")){if(kt){let It=L;for(pt=void 0;It--;){const dt=x[It];if(dt[1].type==="lineEnding"||dt[1].type==="lineEndingBlank"){if(dt[0]==="exit")continue;pt&&(x[pt][1].type="lineEndingBlank",at=!0),dt[1].type="lineEnding",pt=It}else if(!(dt[1].type==="linePrefix"||dt[1].type==="blockQuotePrefix"||dt[1].type==="blockQuotePrefixWhitespace"||dt[1].type==="blockQuoteMarker"||dt[1].type==="listItemIndent"))break}zt&&(!pt||zt<pt)&&(kt._spread=!0),kt.end=Object.assign({},pt?x[pt][1].start:nt[1].end),x.splice(pt||L,0,["exit",kt,nt[2]]),L++,A++}if(nt[1].type==="listItemPrefix"){const It={type:"listItem",_spread:!1,start:Object.assign({},nt[1].start),end:void 0};kt=It,x.splice(L,0,["enter",It,nt[2]]),L++,A++,zt=void 0,Tt=!0}}}return x[k][1]._spread=at,A}function s(x,k){return A;function A(L){o.call(this,x(L),L),k&&k.call(this,L)}}function a(){this.stack.push({type:"fragment",children:[]})}function o(x,k,A){this.stack[this.stack.length-1].children.push(x),this.stack.push(x),this.tokenStack.push([k,A]),x.position={start:mt(k.start),end:void 0}}function u(x){return k;function k(A){x&&x.call(this,A),l.call(this,A)}}function l(x,k){const A=this.stack.pop(),L=this.tokenStack.pop();if(L)L[0].type!==x.type&&(k?k.call(this,x,L[0]):(L[1]||Ue).call(this,x,L[0]));else throw new Error("Cannot close `"+x.type+"` ("+jt({start:x.start,end:x.end})+"): it’s not open");A.position.end=mt(x.end)}function h(){return xr(this.stack.pop())}function p(){this.data.expectingFirstListItemValue=!0}function f(x){if(this.data.expectingFirstListItemValue){const k=this.stack[this.stack.length-2];k.start=Number.parseInt(this.sliceSerialize(x),10),this.data.expectingFirstListItemValue=void 0}}function c(){const x=this.resume(),k=this.stack[this.stack.length-1];k.lang=x}function C(){const x=this.resume(),k=this.stack[this.stack.length-1];k.meta=x}function I(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function F(){const x=this.resume(),k=this.stack[this.stack.length-1];k.value=x.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function b(){const x=this.resume(),k=this.stack[this.stack.length-1];k.value=x.replace(/(\r?\n|\r)$/g,"")}function B(x){const k=this.resume(),A=this.stack[this.stack.length-1];A.label=k,A.identifier=Et(this.sliceSerialize(x)).toLowerCase()}function w(){const x=this.resume(),k=this.stack[this.stack.length-1];k.title=x}function P(){const x=this.resume(),k=this.stack[this.stack.length-1];k.url=x}function v(x){const k=this.stack[this.stack.length-1];if(!k.depth){const A=this.sliceSerialize(x).length;k.depth=A}}function y(){this.data.setextHeadingSlurpLineEnding=!0}function O(x){const k=this.stack[this.stack.length-1];k.depth=this.sliceSerialize(x).codePointAt(0)===61?1:2}function G(){this.data.setextHeadingSlurpLineEnding=void 0}function _(x){const A=this.stack[this.stack.length-1].children;let L=A[A.length-1];(!L||L.type!=="text")&&(L=Cn(),L.position={start:mt(x.start),end:void 0},A.push(L)),this.stack.push(L)}function M(x){const k=this.stack.pop();k.value+=this.sliceSerialize(x),k.position.end=mt(x.end)}function E(x){const k=this.stack[this.stack.length-1];if(this.data.atHardBreak){const A=k.children[k.children.length-1];A.position.end=mt(x.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(k.type)&&(_.call(this,x),M.call(this,x))}function S(){this.data.atHardBreak=!0}function H(){const x=this.resume(),k=this.stack[this.stack.length-1];k.value=x}function W(){const x=this.resume(),k=this.stack[this.stack.length-1];k.value=x}function N(){const x=this.resume(),k=this.stack[this.stack.length-1];k.value=x}function Y(){const x=this.stack[this.stack.length-1];if(this.data.inReference){const k=this.data.referenceType||"shortcut";x.type+="Reference",x.referenceType=k,delete x.url,delete x.title}else delete x.identifier,delete x.label;this.data.referenceType=void 0}function K(){const x=this.stack[this.stack.length-1];if(this.data.inReference){const k=this.data.referenceType||"shortcut";x.type+="Reference",x.referenceType=k,delete x.url,delete x.title}else delete x.identifier,delete x.label;this.data.referenceType=void 0}function et(x){const k=this.sliceSerialize(x),A=this.stack[this.stack.length-2];A.label=fs(k),A.identifier=Et(k).toLowerCase()}function rt(){const x=this.stack[this.stack.length-1],k=this.resume(),A=this.stack[this.stack.length-1];if(this.data.inReference=!0,A.type==="link"){const L=x.children;A.children=L}else A.alt=k}function m(){const x=this.resume(),k=this.stack[this.stack.length-1];k.url=x}function T(){const x=this.resume(),k=this.stack[this.stack.length-1];k.title=x}function q(){this.data.inReference=void 0}function d(){this.data.referenceType="collapsed"}function j(x){const k=this.resume(),A=this.stack[this.stack.length-1];A.label=k,A.identifier=Et(this.sliceSerialize(x)).toLowerCase(),this.data.referenceType="full"}function Q(x){this.data.characterReferenceType=x.type}function $(x){const k=this.sliceSerialize(x),A=this.data.characterReferenceType;let L;A?(L=sn(k,A==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):L=oe(k);const D=this.stack.pop();D.value+=L,D.position.end=mt(x.end)}function xt(x){M.call(this,x);const k=this.stack[this.stack.length-1];k.url=this.sliceSerialize(x)}function it(x){M.call(this,x);const k=this.stack[this.stack.length-1];k.url="mailto:"+this.sliceSerialize(x)}function yt(){return{type:"blockquote",children:[]}}function bt(){return{type:"code",lang:null,meta:null,value:""}}function Mt(){return{type:"inlineCode",value:""}}function bn(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function kn(){return{type:"emphasis",children:[]}}function ce(){return{type:"heading",depth:0,children:[]}}function he(){return{type:"break"}}function pe(){return{type:"html",value:""}}function wn(){return{type:"image",title:null,url:"",alt:null}}function de(){return{type:"link",title:null,url:"",children:[]}}function me(x){return{type:"list",ordered:x.type==="listOrdered",start:null,spread:x._spread,children:[]}}function Sn(x){return{type:"listItem",spread:x._spread,checked:null,children:[]}}function In(){return{type:"paragraph",children:[]}}function En(){return{type:"strong",children:[]}}function Cn(){return{type:"text",value:""}}function zn(){return{type:"thematicBreak"}}}function mt(t){return{line:t.line,column:t.column,offset:t.offset}}function gn(t,e){let n=-1;for(;++n<e.length;){const r=e[n];Array.isArray(r)?gn(t,r):bs(t,r)}}function bs(t,e){let n;for(n in e)if(fn.call(e,n))switch(n){case"canContainEols":{const r=e[n];r&&t[n].push(...r);break}case"transforms":{const r=e[n];r&&t[n].push(...r);break}case"enter":case"exit":{const r=e[n];r&&Object.assign(t[n],r);break}}}function Ue(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+jt({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+jt({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+jt({start:e.start,end:e.end})+") is still open")}function ks(t){const e=this;e.parser=n;function n(r){return xs(r,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}class At extends Error{position;name;constructor(e,n){super(e),this.name="GeneratorError",this.position=n}}const $e=115,Ve=55;function ws(t){const n=pr().use(ks).parse(t),r=[];let i=null;const s=n?.children||[];for(const a of s)if(a.type==="heading"){const o=a.depth;if(o<1||o>2)throw new At("Only (#) and (##) are allowed for node types",a.position);const u=a?.children[0];if(u?.type!=="text")throw new At("Node text must not contain any special formatting",a.position);const l=u.value,h=St();o===1?r.push({id:h,type:"title",label:l}):o===2&&(i={id:h,type:"topic",label:l},r.push(i))}else if(a.type==="list"){const o=a.children;if(i){i.children=[];for(const u of o){const l=St(),h=u.children[0];if(h?.type!=="paragraph")throw new At("Invalid content found in subtopic.",a.position);const p=h?.children[0];if(p?.type!=="text")throw new At("Invalid content found in subtopic",a.position);const f=p.value;i.children.push({id:l,type:"subtopic",label:f})}i=null}}else throw new At("Unknown node type found.",a.position);return r}function xn(t,e){const n=document.createElement("div");n.style.position="absolute",n.style.visibility="hidden",n.style.whiteSpace="nowrap",n.style.fontSize=e==="title"?`${Pt.xxlarge.size}px`:`${Pt.medium.size}px`,n.style.fontFamily='"Balsamiq Sans", sans-serif',n.style.padding="12px 20px",n.style.border="2.7px solid #000",n.style.boxSizing="border-box",n.innerText=t,document.body.appendChild(n);const{width:r,height:i}=n.getBoundingClientRect();return document.body.removeChild(n),{width:r,height:i}}function Ge(t){const{source:e,target:n,sourceHandle:r,targetHandle:i}=t;return{id:St(),source:e,target:n,style:{...Xe.dashed},data:{edgeStyle:"dashed"},sourceHandle:r,targetHandle:i}}function We(t,e,n,r=!1){const i=St(),{label:s,type:a}=t,{width:o,height:u}=xn(s,"topic");let l=e.x;n==="left"&&(l=e.x-o);const h={id:i,type:a,position:{x:l,y:e.y},selected:!1,data:{label:s},width:o,...r&&{height:u},style:{width:o,...r&&{height:u}},zIndex:999};return h.data={...h.data,style:{...h.data.style,fontSize:Pt.medium.size,justifyContent:"flex-start",textAlign:"center"}},h}const Ss=41;function Qe(t){const e=ws(t),n=[],r=[];let i;const s={x:0,y:0};for(const a of e){const o=St(),u=a.type,{width:l,height:h}=xn(a.label,u),p={id:o,type:a.type,position:{x:s.x-l/2,y:s.y},selected:!1,data:{label:`${a.label}`},width:l,height:h,style:{width:l,height:h},zIndex:999};if(u==="title")p.data={...p.data,style:{...p.data.style,fontSize:Pt.xxlarge.size,justifyContent:"flex-start",textAlign:"center"}},s.y+=200;else if(u==="topic"){let f=h;if(p.data={...p.data,style:{...p.data.style,fontSize:Pt.medium.size,justifyContent:"flex-start",textAlign:"center"}},i&&r.push({id:St(),source:i.id,target:o,targetHandle:"w1",sourceHandle:"x2",style:{...Xe.solid},data:{edgeStyle:"solid"}}),a?.children?.length!==0){const c=a.children||[],C=c.slice(0,Math.ceil(c.length/2)),I=c.slice(Math.ceil(c.length/2)),F=Math.max(C.length,I.length);for(let b=0;b<F;b++){const B=C[b],w=I[b];if(B){const P=We(B,{x:s.x-$e-l/2,y:s.y+(Ve+2)*b},"left",!0);n.push(P),r.push(Ge({source:o,target:P.id,sourceHandle:"y2",targetHandle:"z1"})),f+=P?.height||Ss}if(w){const P=We(w,{x:s.x+$e+l/2,y:s.y+(Ve+2)*b},"right",!0);n.push(P),r.push(Ge({source:o,target:P.id,sourceHandle:"z2",targetHandle:"y1"}))}}}s.y+=25+f}n.push(p),i=p}return{nodes:n,edges:r}}const X=2.7,Kt=5,Ke=1e3;class Is{options;constructor(e={}){this.options={padding:20,fontFamily:"balsamiq",fontURL:"https://fonts.gstatic.com/s/balsamiqsans/v3/P5sEzZiAbNrN8SB3lQQX7Pncwd4XIA.woff2",shouldLoadFont:!0,...e}}async loadFont(){const{fontFamily:e,fontURL:n,shouldLoadFont:r}=this.options;if(!r)return;const i=new FontFace(e,`url(${n})`);if(document?.fonts){if(Array.from(document.fonts.values()).find(o=>o.family===e&&o.status==="loaded"&&o.style==="normal"))return;await i.load(),document.fonts.add(i)}}async render(e){await this.loadFont();const{x:n,y:r,measuredWidth:i,measuredHeight:s}=this.findDimensions(e),{nodes:a,edges:o}=e,u=this.makeSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:`${n} ${r} ${i} ${s}`,style:"font-family: balsamiq",version:"1.1"});return o?.forEach(l=>{this.renderEdge(l,a,u)}),a?.forEach(l=>{const h=o.find(c=>c.target===l.id)?.source||"",p=a.find(c=>c.id===h),f={...l,parentId:h,parentTitle:p?.data?.label||""};this.renderNode(f,u)}),u}findDimensions(e){const{nodes:n}=e,{padding:r}=this.options;if(!n?.length)return{x:0,y:0,measuredWidth:0,measuredHeight:0};const i=n?.reduce((f,c)=>f.position.x<c.position.x?f:c),s=n?.reduce((f,c)=>f.position.y<c.position.y?f:c),a=n?.reduce((f,c)=>f.position.y>c.position.y?f:c),o=n?.reduce((f,c)=>f.position.x+(f?.width??0)>c.position.x+(c?.width??0)?f:c);let u=Math.round(o?.position?.x+(o?.width??0)-i?.position?.x)+r*2;const l=Math.round(a?.position?.y-s?.position?.y+(a?.height??0))+r*2;let h=Math.floor(i.position.x)-r;const p=Math.round(s.position.y)-r;if(u<1e3){const f=Ke-u;u=Ke,h-=f/2}return{x:h,y:p,measuredWidth:u,measuredHeight:l}}makeSvgElement(e,n={},r){const i=document.createElementNS("http://www.w3.org/2000/svg",e);for(const s in n)n?.hasOwnProperty(s)&&i.setAttribute(s,n[s]);return r&&r.appendChild(i),i}renderNode(e,n){const r=e.type;r in this?this[r](e,n):console.warn(`No renderer for node type: ${r}`)}renderEdge(e,n,r){const[i]=this.getEdgesPath(e,n),s=e?.markerStart?this.renderMarker(e.markerStart,r):"",a=e?.markerEnd?this.renderMarker(e.markerEnd,r):"";this.makeSvgElement("path",{d:i,fill:"none",stroke:e?.style?.stroke??"#000","stroke-width":3.5,"data-edge-id":e.id,"stroke-linecap":"round","stroke-linejoin":"round","stroke-dasharray":e?.style?.strokeDasharray,...a&&{"marker-end":`url(#${a})`},...s&&{"marker-start":`url(#${s})`}},r)}getEdgesPath(e,n){const r=n.find(p=>p.id===e.source),i=n.find(p=>p.id===e.target),s=this.getSourcePosition(e,r),a=this.getTargetPosition(e,i);if(!s||!a)return[""];const o=e.sourceHandle.replace("1","2")||"x2",u=e.targetHandle.replace("2","1")||"x1",l=e.type,h={sourceX:s.x,sourceY:s.y,sourcePosition:this.getSourceEdgePosition(o),targetX:a.x,targetY:a.y,targetPosition:this.getTargetEdgePosition(u)};switch(l){case"default":return fe(h);case"straight":return jn(h);case"step":return ge({...h,borderRadius:0});case"smoothstep":return ge(h);case"simplebezier":return An(h);default:return fe(h)}}renderMarker(e,n){let r=n?.querySelector("defs");r||(r=this.makeSvgElement("defs",{},n));const i=e.width??8,s=e.height??8,a=e.markerUnits??"strokeWidth",o=e.orient??"auto-start-reverse",u=r.querySelector(`marker[orient="${o}"][markerUnits="${a}"][markerWidth="${i}"][markerHeight="${s}"]`);if(u)return u.id;const l=`marker-${St(6)}`,h=this.makeSvgElement("marker",{id:l,markerWidth:i,markerHeight:s,viewBox:"-10 -10 20 20",markerUnits:a,orient:o,refX:1.5,refY:0},r);return this.makeSvgElement("polyline",{stroke:e.color??"#000","stroke-width":e.strokeWidth??2,"stroke-linecap":"round","stroke-linejoin":"round",fill:e?.type==="arrowclosed"?e.color??"#000":"none",points:this.getMarkerPoints(e)},h),l}getMarkerPoints(e){if(e.type==="arrow")return"-5,-4 0,0 -5,4";if(e.type==="arrowclosed")return"-5,-4 0,0 -5,4 -5,-4"}getSourcePosition(e,n){const r=e.sourceHandle.replace("1","2")||"x2",i=this.getSourceEdgePosition(r);if(!n||!i)return null;switch(i){case"top":return{x:n.position.x+(n.width||0)/2,y:n.position.y};case"bottom":return{x:n.position.x+(n.width||0)/2,y:n.position.y+(n.height||0)};case"left":return{x:n.position.x,y:n.position.y+(n.height||0)/2};case"right":return{x:n.position.x+(n.width||0),y:n.position.y+(n.height||0)/2};default:return null}}getTargetPosition(e,n){const r=e.targetHandle.replace("2","1")||"x1",i=this.getTargetEdgePosition(r);if(!n||!i)return null;switch(i){case"top":return{x:n.position.x+(n.width||0)/2,y:n.position.y};case"bottom":return{x:n.position.x+(n.width||0)/2,y:n.position.y+(n.height||0)};case"left":return{x:n.position.x,y:n.position.y+(n.height||0)/2};case"right":return{x:n.position.x+(n.width||0),y:n.position.y+(n.height||0)/2};default:return null}}getSourceEdgePosition(e){switch(e){case"w2":return lt.Top;case"x2":return lt.Bottom;case"y2":return lt.Left;case"z2":return lt.Right;default:return lt.Bottom}}getTargetEdgePosition(e){switch(e){case"w1":return lt.Top;case"x1":return lt.Bottom;case"y1":return lt.Left;case"z1":return lt.Right;default:return lt.Top}}drawRectangle(e,n){let r="transparent";switch(e?.type){case"topic":r="#fdff00";break;case"subtopic":r="#ffe599";break;case"button":r=e?.data?.backgroundColor??"white";break;case"legend":r=e?.data?.backgroundColor??"white";break}this.makeSvgElement("rect",{x:e.position.x+X/2,y:e.position.y+X/2,width:(e.width||e?.style?.width||0)-X,height:(e.height||e?.style?.height||0)-X,rx:e?.data?.radius??Kt,fill:r,stroke:e?.data?.borderColor||e?.data?.backgroundColor||"black","stroke-width":X},n)}title(e,n){const r=this.makeSvgElement("g",{"data-node-id":e.id,"data-type":e.type,"data-title":e.data?.label??"",...e?.parentId&&{"data-parent-id":e?.parentId},...e?.parentTitle&&{"data-parent-title":e?.parentTitle}},n),i=this.makeSvgElement("text",{x:e.position.x+(e?.width||e?.style?.width||0)/2,y:e.position.y+(e?.height||e?.style?.height||0)/2,"text-anchor":"middle","dominant-baseline":"middle","font-size":28,fill:"black"},r),s=this.makeSvgElement("tspan",{},i);s.textContent=e.data?.label??""}renderTopicSubTopic(e,n){const r=this.makeSvgElement("g",{"data-node-id":e.id,"data-type":e.type,"data-title":e.data?.label??"",...e?.parentId&&{"data-parent-id":e?.parentId},...e?.parentTitle&&{"data-parent-title":e?.parentTitle}},n);this.drawRectangle(e,r);let i=e.position.x+(e?.width||e?.style?.width||0)/2;e?.data?.legend&&(i-=10,this.icon({x:e.position.x+(e?.width||0)-32,y:e.position.y+(e?.height||0)/2-10},e?.data?.legend?.color??"black",r));const s=this.makeSvgElement("text",{x:i,y:e.position.y+(e?.height||e?.style?.height||0)/2,"text-anchor":"middle","dominant-baseline":"middle","font-size":e?.data?.style?.fontSize??14,fill:"black"},r),a=this.makeSvgElement("tspan",{},s);a.textContent=e.data?.label??""}topic(e,n){return this.renderTopicSubTopic(e,n)}subtopic(e,n){this.renderTopicSubTopic(e,n)}section(e,n){const r=this.makeSvgElement("g",{"data-node-id":e.id,"data-type":e.type,...e?.parentId&&{"data-parent-id":e?.parentId}},n);this.makeSvgElement("rect",{x:e.position.x+X/2,y:e.position.y+X/2,width:(e.width||e?.style?.width||0)-X,height:(e.height||e?.style?.height||0)-X,rx:e?.data?.style?.borderRadius??Kt,fill:e?.data?.style?.backgroundColor??"transparent",stroke:e?.data?.style?.borderColor||e?.data?.style?.backgroundColor||"black","stroke-width":X},r);const i=this.makeSvgElement("text",{x:e.position.x,y:e.position.y-8,"text-anchor":"left","dominant-baseline":"auto","font-size":e?.data?.style?.fontSize??14,fill:"black"},r),s=this.makeSvgElement("tspan",{},i);s.textContent=e.data?.label??""}legend(e,n){const r=e.data?.legends??[],i=this.makeSvgElement("g",{"data-node-id":e.id,"data-type":e.type,...e?.parentId&&{"data-parent-id":e?.parentId}},n);this.drawRectangle(e,i);const s=e.position.x+25;let a=e.position.y+19;if(e?.data?.label){a+=4;const o=this.makeSvgElement("text",{x:s+1,y:a+8,"text-anchor":"left","dominant-baseline":"middle","font-size":16,fill:"black"},i),u=this.makeSvgElement("tspan",{},o);u.textContent=e.data?.label??""}r.forEach((o,u)=>{const l=s,h=e?.data?.label?a+32*(u+1):a+32*u,p=this.makeSvgElement("g",{"data-node-id":o.id,"data-type":"legend-item","data-parent-id":e.id},i);this.icon({x:l,y:h},o.color??"black",p);const f=this.makeSvgElement("text",{x:l+28,y:h+12,"text-anchor":"left","dominant-baseline":"middle","font-size":16,fill:"black"},p),c=this.makeSvgElement("tspan",{},f);c.textContent=o.label??""})}icon(e,n,r){const{x:i,y:s}=e,a=9.5;this.makeSvgElement("circle",{cx:i+a+1,cy:s+a,r:a,fill:n},r),this.makeSvgElement("path",{d:`M${i+6.5} ${s+a}L${i+9} ${s+a+3} ${i+14} ${s+a-2}`,fill:"none",stroke:"#fff","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"},r)}linksgroup(e,n){const r=this.makeSvgElement("g",{"data-node-id":e.id,"data-type":e.type,...e?.parentId&&{"data-parent-id":e?.parentId}},n);this.drawRectangle(e,r);const i=e.data?.links??[],s=e.position.x+22;let a=e.position.y+22;if(e?.data?.label){a+=6;const o=this.makeSvgElement("text",{x:s+2,y:a+1,"text-anchor":"left","dominant-baseline":"middle","font-size":16,fill:"black"},r),u=this.makeSvgElement("tspan",{},o);u.textContent=e.data?.label??""}i.forEach((o,u)=>{const l=s,h=e?.data?.label?a+30*(u+1):a+30*u,p=this.makeSvgElement("g",{"data-node-id":o.id,"data-type":"link-item","data-parent-id":e.id,"data-link":o.url??""},r);this.icon({x:l,y:h},"#6b7280",p);const f=this.makeSvgElement("text",{x:l+28,y:h+10,"text-anchor":"left","dominant-baseline":"middle","font-size":16,fill:"black"},p),c=this.makeSvgElement("tspan",{},f);c.textContent=o.label??""})}vertical(e,n){const r=e?.data?.style??{},i=this.makeSvgElement("g",{"data-node-id":e.id,"data-type":e.type},n);this.makeSvgElement("line",{x1:e?.position?.x+10||0,y1:e?.position?.y+1||0,x2:e?.position?.x+10||0,y2:e?.position?.y+(e?.height||0)||0,style:`stroke-linecap: round; stroke-width: 3; stroke: ${r?.stroke||"black"}; stroke-dasharray: ${r?.strokeDasharray||0};`},i)}horizontal(e,n){const r=e?.data?.style??{},i=this.makeSvgElement("g",{"data-node-id":e.id,"data-type":e.type},n);this.makeSvgElement("line",{x1:e?.position?.x||0,y1:e?.position?.y||0,x2:e?.position?.x+(e?.width||0)||0,y2:e?.position?.y||0,style:`stroke-linecap: round; stroke-width: 3; stroke: ${r?.stroke||"black"}; stroke-dasharray: ${r?.strokeDasharray??0};`},i)}paragraph(e,n){const{style:r}=e?.data??{},i=this.makeSvgElement("g",{"data-node-id":e.id,"data-type":e.type},n);this.makeSvgElement("rect",{x:e.position.x+X/2,y:e.position.y+X/2,width:e.width||e?.style?.width||0,height:(e.height||e?.style?.height||0)-X,rx:Kt,fill:r?.backgroundColor??"transparent",stroke:r?.borderColor??"transparent","stroke-width":X},i);const s=this.splitTextIntoLines(e.data?.label??"",(e?.width||0)-18*2,r?.fontSize||14,this?.options.fontFamily||"balsamiq","normal"),a=20;let o=e.position.x+a,u=e.position.y+32-X/2,l=26;switch(r?.fontSize){case 24:u+=6,l=36;break;case 12:u-=5,l=19;break;case 20:u+=2,l=30;break;case 28:u+=10,l=42;break}let h="start",p="middle";const f=(r?.fontSize||14)*1;if(r?.textAlign==="center"?(o=e.position.x+(e.width||parseInt(e?.style?.width||"0")||0)/2,h="middle"):r?.textAlign==="right"&&(o=e.position.x+(e.width||parseInt(e?.style?.width||"0")||0)-a,h="end"),r?.justifyContent==="center")u=e.position.y+(e.height||parseInt(e?.style?.height||"0")||0)/2,p="middle",u=u-s.length*f/2;else if(r?.justifyContent==="flex-end"){switch(u=e.position.y+(e.height||parseInt(e?.style?.height||"0")||0)-24,r?.fontSize){case 12:break;case 20:u-=s.length*2;break;case 24:u-=s.length*5;break;case 28:u-=s.length*8;break}p="text-top",u=u-s.length*f}const c=this.makeSvgElement("text",{fill:r?.color??"black"},i);s.forEach((C,I)=>{const F=this.makeSvgElement("tspan",{x:o,y:u,dy:`${I===0?0:l*I}`,"text-anchor":h,"dominant-baseline":p,"font-size":r?.fontSize??15},c);F.textContent=C})}splitTextIntoLines(e,n,r,i,s){const a="http://www.w3.org/2000/svg",o=document.createElementNS(a,"svg"),u=document.createElementNS(a,"text");u.setAttribute("font-size",r.toString()),u.setAttribute("font-family",i),u.setAttribute("font-weight",s),o.appendChild(u),document.body.appendChild(o);const l=[];let h="";for(const p of e.split(" ")){const f=h+(h?" ":"")+p;u.textContent=f,u.getComputedTextLength()<=n?h=f:(l.push(h),h=p)}return h&&l.push(h),document.body.removeChild(o),l}button(e,n){const r=this.makeSvgElement("g",{"data-link":e?.data?.href??"","data-node-id":e?.id??"","data-type":e?.type??"button"},n);this.drawRectangle(e,r);const i=this.makeSvgElement("text",{x:e.position.x+(e?.width||0)/2,y:e.position.y+(e?.height||0)/2,"text-anchor":"middle","dominant-baseline":"middle","font-size":e?.data?.style?.fontSize??14,fill:e?.data?.color??"black"},r),s=this.makeSvgElement("tspan",{},i);s.textContent=e.data?.label??""}}function Es(t,e){return new Is(e).render(t)}const Cs=10;async function zs(t,{onStream:e,onStreamEnd:n}){const r=new TextDecoder("utf-8");let i="";for(;;){const{value:s,done:a}=await t.read();if(a)break;if(s){let o=0;for(let u=0;u<s.length;u++)s[u]===Cs&&(i+=r.decode(s.slice(o,u+1)),e?.(i),o=u+1);o<s.length&&(i+=r.decode(s.slice(o)))}}e?.(i),n?.(i),t.releaseLock()}async function Ts(t,{onStream:e,onStreamEnd:n}){const r=new TextDecoder("utf-8");let i="";for(;;){const{value:s,done:a}=await t.read();if(a)break;s&&(i+=r.decode(s),e?.(i))}e?.(i),n?.(i),t.releaseLock()}function As(t){const{className:e}=t;return g.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",width:"24",height:"24",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:e,children:[g.jsx("path",{d:"M18 6 6 18"}),g.jsx("path",{d:"m6 6 12 12"})]})}function yn(t){const{onClose:e}=t,[n,r]=U.useState(""),[i,s]=U.useState(!1),[a,o]=U.useState(""),[u,l]=U.useState(!1),h=Ye();return U.useEffect(()=>{const p=Bt();o(p||""),r(p||"")},[]),g.jsx(Rn,{onClose:e,children:g.jsxs("div",{className:"p-5",children:[g.jsx("h2",{className:"text-xl font-medium text-gray-800",children:"OpenAI Settings"}),g.jsxs("div",{className:"mt-4",children:[g.jsx("p",{className:"text-gray-700",children:"AI Roadmap generator uses OpenAI's GPT-4 model to generate roadmaps."}),g.jsxs("p",{className:"mt-2",children:[g.jsx("a",{className:"font-semibold underline underline-offset-2",href:"https://platform.openai.com/signup",target:"_blank",children:"Create an account on OpenAI"})," ","and enter your API key below to enable the AI Roadmap generator"]}),g.jsxs("form",{className:"mt-4",onSubmit:async p=>{p.preventDefault(),s(!1);const f=a.trim();if(!f){xe(),h.success("OpenAI API key removed"),e();return}if(!f.startsWith("sk-")){s(!0);return}l(!0);const{response:c,error:C}=await Je("https://api.roadmap.sh/v1-validate-openai-key",{key:f});if(C){s(!0),l(!1);return}Ln(f),h.success("OpenAI API key saved"),e()},children:[g.jsxs("div",{className:"relative",children:[g.jsx("input",{type:"text",name:"openai-api-key",id:"openai-api-key",className:Ct("block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-800 transition-colors focus:border-black focus:outline-none",{"border-red-500 bg-red-100 focus:border-red-500":i}),placeholder:"Enter your OpenAI API key",value:a,onChange:p=>{s(!1),o(p.target.value)}}),a&&g.jsx("button",{type:"button",onClick:()=>{o("")},className:"absolute right-2 top-1/2 flex h-[20px] w-[20px] -translate-y-1/2 items-center justify-center rounded-full bg-gray-400 text-white hover:bg-gray-600",children:g.jsx(As,{className:"h-[13px] w-[13px] stroke-[3.5]"})})]}),i&&g.jsx("p",{className:"mt-2 text-sm text-red-500",children:"Please enter a valid OpenAI API key"}),g.jsxs("button",{disabled:u,type:"submit",className:"mt-2 w-full rounded-md bg-gray-700 px-4 py-2 text-white transition-colors hover:bg-black disabled:cursor-not-allowed disabled:opacity-50",children:[!u&&"Save",u&&"Validating .."]}),!n&&g.jsx("button",{type:"button",onClick:()=>{e()},className:"mt-1 w-full rounded-md bg-red-500 px-4 py-2 text-white transition-colors hover:bg-black hover:bg-red-700",children:"Cancel"}),n&&g.jsx("button",{type:"button",onClick:()=>{xe(),e(),h.success("OpenAI API key removed")},className:"mt-1 w-full rounded-md bg-red-500 px-4 py-2 text-white transition-colors hover:bg-black hover:bg-red-700",children:"Reset to Default Key"})]})]})]})})}function js(t){const{roadmapTerm:e,setRoadmapTerm:n,handleSubmit:r,limit:i=0,limitUsed:s=0,onLoadTerm:a,loadAIRoadmapLimit:o}=t,u=s<i,[l,h]=U.useState(!1),p=Bt(),f=["OAuth","APIs","UX Design","gRPC"];return g.jsxs("div",{className:"flex flex-grow flex-col items-center justify-center px-4 py-6 sm:px-6",children:[l&&g.jsx(yn,{onClose:()=>{h(!1),o()}}),g.jsxs("div",{className:"flex flex-col gap-0 text-center sm:gap-2",children:[g.jsxs("h1",{className:"relative text-2xl font-medium sm:text-3xl",children:[g.jsx("span",{className:"hidden sm:inline",children:"Generate roadmaps with AI"}),g.jsx("span",{className:"inline sm:hidden",children:"AI Roadmap Generator"})]}),g.jsxs("p",{className:"text-base text-gray-500 sm:text-lg",children:[g.jsx("span",{className:"hidden sm:inline",children:"Enter a topic and let the AI generate a roadmap for you"}),g.jsx("span",{className:"inline sm:hidden",children:"Enter a topic to generate a roadmap"})]})]}),g.jsxs("div",{className:"my-3 flex w-full max-w-[600px] flex-col items-center gap-3 sm:my-5",children:[g.jsxs("form",{onSubmit:c=>{i>0&&u?r(c):c.preventDefault()},className:"flex w-full flex-col gap-2 sm:flex-row",children:[g.jsx("input",{autoFocus:!0,type:"text",placeholder:"Enter a topic to generate a roadmap for",className:"w-full rounded-md border border-gray-400 px-3 py-2.5 transition-colors focus:border-black focus:outline-none",value:e,onInput:c=>n(c.target.value)}),g.jsxs("button",{className:Ct("flex min-w-[154px] flex-shrink-0 items-center justify-center gap-2 rounded-md bg-black px-4 py-2 text-white","disabled:cursor-not-allowed disabled:opacity-50"),disabled:!i||!e||s>=i,children:[(!i||u)&&g.jsxs(g.Fragment,{children:[g.jsx(tn,{size:20}),"Generate"]}),i>0&&!u&&g.jsxs("span",{className:"flex items-center text-base",children:[g.jsx(re,{size:15,className:"mr-2"}),"Limit reached"]})]})]}),g.jsxs("div",{className:"flex flex-row items-center justify-center gap-2 flex-wrap",children:[f.map(c=>g.jsxs("button",{disabled:!i||!u,type:"button",onClick:()=>{a(c)},className:"flex items-center gap-1.5 rounded-full border px-2 py-0.5 text-sm transition-colors hover:border-black hover:bg-gray-100 disabled:cursor-not-allowed disabled:opacity-50",children:[c," ",g.jsx(Nn,{size:17})]},c)),g.jsxs("a",{href:"/ai/explore",className:"flex items-center gap-1.5 rounded-full border border-black bg-gray-700 px-2 py-0.5 text-sm text-white transition-colors hover:border-black hover:bg-black",children:["Explore AI Roadmaps ",g.jsx(On,{size:17})]})]})]}),g.jsxs("div",{className:"mt-12 flex flex-col items-center gap-4",children:[g.jsxs("p",{className:"text-gray-500 text-center",children:["You have generated"," ",g.jsxs("span",{className:Ct("inline-block min-w-[50px] rounded-xl border px-1.5 text-center text-sm tabular-nums text-gray-800",{"animate-pulse border-zinc-300 bg-zinc-300 text-zinc-300":!i}),children:[s," of ",i]})," ","roadmaps."]}),g.jsx("p",{className:"flex min-h-[46px] sm:min-h-[26px] items-center text-sm",children:i>0&&!ft()&&g.jsxs("button",{onClick:_t,className:"rounded-xl border border-current px-2 py-0.5 text-sm text-blue-500 transition-colors hover:bg-blue-400 hover:text-white",children:["Generate more by"," ",g.jsx("span",{className:"font-semibold",children:"signing up (free and takes 2 seconds)"})," ","or ",g.jsx("span",{className:"font-semibold",children:"logging in"})]})}),g.jsxs("p",{className:"-mt-[75px] sm:-mt-[45px] flex min-h-[46px] sm:min-h-[26px] items-center text-sm",children:[i>0&&ft()&&!p&&g.jsxs("button",{onClick:()=>h(!0),className:"rounded-xl border border-current px-2 py-0.5 text-sm text-blue-500 transition-colors hover:bg-blue-400 hover:text-white",children:["By-pass all limits by"," ",g.jsx("span",{className:"font-semibold",children:"adding your own OpenAI API key"})]}),i>0&&ft()&&p&&g.jsxs("button",{onClick:()=>h(!0),className:"flex flex-row items-center gap-1 rounded-xl border border-current px-2 py-0.5 text-sm text-blue-500 transition-colors hover:bg-blue-400 hover:text-white",children:[g.jsx(se,{size:15}),"Configure OpenAI key"]})]})]})]})}function Ns(t){const{onClose:e,roadmapId:n,nodeTitle:r,parentTitle:i,topicLimit:s,topicLimitUsed:a,onTopicContentGenerateComplete:o,onConfigureOpenAI:u}=t,[l,h]=U.useState(!1),[p,f]=U.useState(""),[c,C]=U.useState(""),I=U.useRef(null),F=U.useMemo(()=>new AbortController,[]),b=async()=>{if(h(!0),f(""),!n||!r){h(!1),f("Invalid roadmap id or node title");return}const P=await fetch(`https://api.roadmap.sh/v1-generate-ai-roadmap-content/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({nodeTitle:r,parentTitle:i}),signal:F.signal});if(!P.ok){const y=await P.json();f(y?.message||"Something went wrong"),h(!1),y.status===401&&(Ze(),window.location.reload())}const v=P.body?.getReader();if(!v){h(!1),f("Something went wrong");return}h(!1),await Ts(v,{onStream:async y=>{C(Vn(y,!1))}}),o?.()};$n(I,()=>{e?.()}),Un("Escape",()=>{e?.()}),U.useEffect(()=>{if(I?.current)return I?.current?.focus(),b().finally(()=>{}),()=>{F.abort()}},[]);const B=c?.length>0,w=Bt();return g.jsxs("div",{className:"relative z-50",children:[g.jsxs("div",{ref:I,tabIndex:0,className:"fixed right-0 top-0 z-40 h-screen w-full overflow-y-auto bg-white p-4 focus:outline-0 sm:max-w-[600px] sm:p-6",children:[g.jsxs("div",{className:"flex flex-col items-start gap-2 sm:flex-row",children:[g.jsxs("span",{children:[g.jsxs("span",{className:Ct("mr-0.5 inline-block rounded-xl border px-1.5 text-center text-sm tabular-nums text-gray-800",{"animate-pulse border-zinc-300 bg-zinc-300 text-zinc-300":!s}),children:[a," of ",s]})," ","topics generated"]}),!ft()&&g.jsxs("button",{className:"rounded-xl border border-current px-1.5 py-0.5 text-left text-sm font-medium text-blue-500 sm:text-center",onClick:_t,children:["Generate more by ",g.jsx("span",{className:"font-semibold",children:"logging in"})]}),ft()&&!w&&g.jsxs("button",{className:"rounded-xl border border-current px-1.5 py-0.5 text-left text-sm font-medium text-blue-500 sm:text-center",onClick:u,children:["By-pass all limits by"," ",g.jsx("span",{className:"font-semibold",children:"adding your own OpenAI Key"})]}),ft()&&w&&g.jsxs("button",{className:"flex items-center gap-1 rounded-xl border border-current px-1.5 py-0.5 text-left text-sm font-medium text-blue-500 sm:text-center",onClick:u,children:[g.jsx(se,{className:"-mt-0.5 inline-block h-4 w-4"}),"Configure OpenAI Key"]})]}),l&&g.jsx("div",{className:"mt-6 flex w-full justify-center",children:g.jsx(en,{outerFill:"#d1d5db",className:"h-6 w-6 sm:h-12 sm:w-12",innerFill:"#2563eb"})}),!l&&!p&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"mb-2",children:g.jsx("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:e,children:g.jsx(be,{className:"h-5 w-5"})})}),B?g.jsx("div",{className:"prose prose-quoteless prose-h1:mb-2.5 prose-h1:mt-7 prose-h2:mb-3 prose-h2:mt-0 prose-h3:mb-[5px] prose-h3:mt-[10px] prose-p:mb-2 prose-p:mt-0 prose-blockquote:font-normal prose-blockquote:not-italic prose-blockquote:text-gray-700 prose-li:m-0 prose-li:mb-0.5",children:g.jsx("div",{id:"topic-content",dangerouslySetInnerHTML:{__html:c}})}):g.jsxs("div",{className:"flex h-[calc(100%-38px)] flex-col items-center justify-center",children:[g.jsx(Bn,{className:"h-16 w-16 text-gray-300"}),g.jsx("p",{className:"mt-2 text-lg font-medium text-gray-500",children:"Empty Content"})]})]}),!l&&p&&g.jsxs(g.Fragment,{children:[g.jsx("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:e,children:g.jsx(be,{className:"h-5 w-5"})}),g.jsxs("div",{className:"flex h-full flex-col items-center justify-center",children:[g.jsx(re,{className:"h-16 w-16 text-red-500"}),g.jsx("p",{className:"mt-2 text-lg font-medium text-red-500",children:p})]})]})]}),g.jsx("div",{className:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"})]})}const Yt=new RegExp("@ROADMAPID:(\\w+)@");function Ps(t){const e=t?.closest("g")||{},n=e?.dataset?.nodeId,r=e?.dataset?.type,i=e?.dataset?.title,s=e?.dataset?.parentTitle;return!n||!r?null:{nodeId:n,nodeType:r,targetGroup:e,nodeTitle:i,parentTitle:s}}const Ls=["topic","subtopic","button","link-item"];function ma(){const t=U.useRef(null),{id:e}=Mn(),n=Ye(),[r,i]=U.useState(!1),[s,a]=U.useState(!1),[o,u]=U.useState(""),[l,h]=U.useState(""),[p,f]=U.useState(null),[c,C]=U.useState(null),[I,F]=U.useState(0),[b,B]=U.useState(0),[w,P]=U.useState(0),[v,y]=U.useState(0),[O,G]=U.useState(!1),_=Bt(),M=async T=>{const{nodes:q,edges:d}=Qe(T),j=await Es({nodes:q,edges:d});t?.current&&Pn(t?.current,j)},E=async T=>{if(a(!0),i(!0),b>=I){n.error("You have reached your limit of generating roadmaps"),a(!1);return}Dn("id"),f(null);const q=await fetch("https://api.roadmap.sh/v1-generate-ai-roadmap",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({term:T})});if(!q.ok){const j=await q.json();n.error(j?.message||"Something went wrong"),a(!1),j.status===401&&(Ze(),window.location.reload())}const d=q.body?.getReader();if(!d){a(!1),n.error("Something went wrong");return}await zs(d,{onStream:async j=>{if(j.includes("@ROADMAPID")){const Q=j.match(Yt)?.[1]||"";Hn({id:Q}),j=j.replace(Yt,""),f({id:Q,term:o,title:T,data:j})}await M(j)},onStreamEnd:async j=>{j=j.replace(Yt,""),h(j),N().finally(()=>{})}}),a(!1)},S=async T=>{T.preventDefault(),o&&o!==p?.topic&&E(o).finally(()=>null)},H=async()=>{if(!ft()){_t();return}wt.set("Redirecting to Editor");const{nodes:T,edges:q}=Qe(l),{response:d,error:j}=await Je(`https://api.roadmap.sh/v1-save-ai-roadmap/${p?.id}`,{title:o,nodes:T.map(Q=>({...Q,width:void 0,height:void 0,style:{...Q.style,width:void 0,height:void 0}})),edges:q});if(j||!d){n.error(j?.message||"Something went wrong"),wt.set(""),a(!1);return}return a(!1),wt.set(""),d.roadmapId},W=async()=>{wt.set("Downloading Roadmap");const T=document.getElementById("roadmap-container");if(!T){n.error("Something went wrong");return}try{await qn(o,T),wt.set("")}catch(q){console.error(q),n.error("Something went wrong")}},N=async()=>{const{response:T,error:q}=await ye("https://api.roadmap.sh/v1-get-ai-roadmap-limit");if(q||!T){n.error(q?.message||"Something went wrong");return}const{limit:d,used:j,topicLimit:Q,topicUsed:$}=T;F(d),B(j),P(Q),y($)},Y=async T=>{wt.set("Loading Roadmap");const{response:q,error:d}=await ye(`https://api.roadmap.sh/v1-get-ai-roadmap/${T}`);if(d||!q){n.error(d?.message||"Something went wrong"),a(!1);return}const{term:j,title:Q,data:$}=q;await M($),f({id:T,title:Q,term:j,data:$}),u(Q),h($),Fn(T)},K=U.useCallback(T=>{if(s)return;const q=T.target,{nodeId:d,nodeType:j,targetGroup:Q,nodeTitle:$,parentTitle:xt}=Ps(q)||{};if(!(!d||!j||!Ls.includes(j)||!$)){if(j==="button"||j==="link-item"){const it=Q?.dataset?.link||"";it.startsWith("http")?window.open(it,"_blank"):window.location.href=it;return}C({nodeId:d,nodeType:j,nodeTitle:$,...j==="subtopic"&&{parentTitle:xt}})}},[s]);if(U.useEffect(()=>{N().finally(()=>{})},[]),U.useEffect(()=>{!e||e===p?.id||(i(!0),Y(e).finally(()=>{wt.set("")}))},[e,p]),!r)return g.jsx(js,{roadmapTerm:o,setRoadmapTerm:u,handleSubmit:S,limit:I,limitUsed:b,loadAIRoadmapLimit:N,onLoadTerm:T=>{u(T),E(T).finally(()=>{})}});const et=`https://roadmap.sh/ai?id=${e}`,rt=b<I,m=ft();return g.jsxs(g.Fragment,{children:[O&&g.jsx(yn,{onClose:()=>{G(!1),N().finally(()=>null)}}),c&&p&&!s&&g.jsx(Ns,{nodeId:c.nodeId,nodeType:c.nodeType,nodeTitle:c.nodeTitle,parentTitle:c.parentTitle,onConfigureOpenAI:()=>{C(null),G(!0)},onClose:()=>{C(null),N().finally(()=>{})},roadmapId:p?.id||"",topicLimit:w,topicLimitUsed:v,onTopicContentGenerateComplete:async()=>{await N()}}),g.jsxs("section",{className:"flex flex-grow flex-col bg-gray-100",children:[g.jsxs("div",{className:"flex items-center justify-center border-b bg-white py-3 sm:py-6",children:[s&&g.jsxs("span",{className:"flex items-center gap-2 rounded-full bg-black px-3 py-1 text-white",children:[g.jsx(en,{isDualRing:!1,innerFill:"white"}),"Generating roadmap .."]}),!s&&g.jsxs("div",{className:"container flex flex-grow flex-col items-center",children:[g.jsx(_n,{}),g.jsxs("div",{className:"mt-2 flex w-full flex-col items-start justify-between gap-2 text-sm sm:flex-row sm:items-center sm:gap-0",children:[g.jsxs("span",{children:[g.jsxs("span",{className:Ct("mr-0.5 inline-block rounded-xl border px-1.5 text-center text-sm tabular-nums text-gray-800",{"animate-pulse border-zinc-300 bg-zinc-300 text-zinc-300":!I}),children:[b," of ",I]})," ","roadmaps generated."]}),!m&&g.jsxs("button",{className:"rounded-xl border border-current px-1.5 py-0.5 text-left text-sm font-medium text-blue-500 sm:text-center",onClick:_t,children:["Generate more by"," ",g.jsx("span",{className:"font-semibold",children:"signing up (free, takes 2s)"})," ","or ",g.jsx("span",{className:"font-semibold",children:"logging in"})]}),m&&!_&&g.jsxs("button",{onClick:()=>G(!0),className:"text-left rounded-xl border border-current px-2 py-0.5 text-sm text-blue-500 transition-colors hover:bg-blue-400 hover:text-white",children:["By-pass all limits by"," ",g.jsx("span",{className:"font-semibold",children:"adding your own OpenAI API key"})]}),m&&_&&g.jsxs("button",{onClick:()=>G(!0),className:"flex flex-row items-center gap-1 rounded-xl border border-current px-2 py-0.5 text-sm text-blue-500 transition-colors hover:bg-blue-400 hover:text-white",children:[g.jsx(se,{size:15}),"Configure OpenAI key"]})]}),g.jsxs("form",{onSubmit:S,className:"my-3 flex w-full flex-col gap-2 sm:flex-row sm:items-center sm:justify-center",children:[g.jsx("input",{type:"text",autoFocus:!0,placeholder:"e.g. Try searching for Ansible or DevOps",className:"flex-grow rounded-md border border-gray-400 px-3 py-2 transition-colors focus:border-black focus:outline-none",value:o,onInput:T=>u(T.target.value)}),g.jsxs("button",{type:"submit",className:Ct("flex min-w-[127px] flex-shrink-0 items-center justify-center gap-2 rounded-md bg-black px-4 py-2 text-white","disabled:cursor-not-allowed disabled:opacity-50"),disabled:!I||!o||b>=I||o===p?.term,children:[I>0&&rt&&g.jsxs(g.Fragment,{children:[g.jsx(tn,{size:20}),"Generate"]}),I===0&&g.jsx("span",{children:"Please wait.."}),I>0&&!rt&&g.jsxs("span",{className:"flex items-center text-sm",children:[g.jsx(re,{size:15,className:"mr-2"}),"Limit reached"]})]})]}),g.jsxs("div",{className:"flex w-full items-center justify-between gap-2",children:[g.jsxs("div",{className:"flex items-center justify-between gap-2",children:[g.jsxs("button",{className:"inline-flex items-center justify-center gap-2 rounded-md bg-yellow-400 py-1.5 pl-2.5 pr-3 text-xs font-medium transition-opacity duration-300 hover:bg-yellow-500 sm:text-sm",onClick:W,children:[g.jsx(Wn,{size:15}),"Download"]}),e&&g.jsx(vn,{description:`Check out ${o} roadmap I generated on roadmap.sh`,pageUrl:et})]}),g.jsxs("div",{className:"flex items-center justify-between gap-2",children:[g.jsxs("button",{className:"inline-flex items-center justify-center gap-2 rounded-md bg-gray-200 py-1.5 pl-2.5 pr-3 text-xs font-medium text-black transition-colors duration-300 hover:bg-gray-300 sm:text-sm",onClick:async()=>{const T=await H();T&&(window.location.href=`/r?id=${T}`)},disabled:s,children:[g.jsx(Qn,{size:15}),g.jsx("span",{className:"hidden sm:inline",children:"Save and Start Learning"}),g.jsx("span",{className:"inline sm:hidden",children:"Start Learning"})]}),g.jsxs("button",{className:"hidden items-center justify-center gap-2 rounded-md bg-gray-200 py-1.5 pl-2.5 pr-3 text-xs font-medium text-black transition-colors duration-300 hover:bg-gray-300 sm:inline-flex sm:text-sm",onClick:async()=>{const T=await H();T&&window.open(`https://draw.roadmap.sh/${T}`,"_blank")},disabled:s,children:[g.jsx(Gn,{size:15}),"Edit in Editor"]})]})]})]})]}),g.jsx("div",{ref:t,id:"roadmap-container",onClick:K,className:"relative px-4 py-5 [&>svg]:mx-auto [&>svg]:max-w-[1300px]"})]})]})}export{ma as GenerateRoadmap};
