import{c as y}from"./createLucideIcon.3c9fdece.js";import{j as e}from"./jsx-runtime.6940b965.js";import{r as x}from"./index.070054a4.js";import{u as F}from"./use-toast.fb52de5d.js";import{c as j}from"./classname.585fc13a.js";import{a as V,b as z}from"./http.387f5009.js";import{U as O}from"./users-2.dc7091e7.js";import{U as W}from"./users.9673a18c.js";import{u as re}from"./use-copy-text.77785bb1.js";import{C as ne}from"./check-circle.045c0bed.js";import{C as le}from"./copy.2caf0f52.js";import{M as H,L as Y}from"./Modal.5d15d888.js";const ie=y("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),ce=y("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),de=y("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),J=y("Globe2",[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3v0a2 2 0 0 1 2 2v0c0 1.1.9 2 2 2v0a2 2 0 0 0 2-2v0c0-1.1.9-2 2-2h3.17",key:"1fi5u6"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2v0a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"xsiumc"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),oe=y("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),K=y("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Le=y("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),Fe=y("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),me=y("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);function Q(m){const{user:s,onClick:a,isSelected:r}=m;return e.jsxs("button",{className:j("relative flex w-full items-center gap-2.5 rounded-lg border p-2.5",r&&"border-gray-500 bg-gray-300 text-black"),onClick:a,children:[e.jsx("img",{src:s.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${s.avatar}`:"/images/default-avatar.png",alt:s.name||"",className:"relative top-[1px] h-10 w-10 shrink-0 rounded-full"}),e.jsxs("div",{className:"inline-grid w-full",children:[e.jsx("h3",{className:"truncate text-left font-semibold",children:s.name}),e.jsx("p",{className:j("truncate text-left text-sm text-gray-500",r&&"text-gray-700"),children:s.email})]})]})}function he(m){const{setFriends:s,friends:a,sharedFriendIds:r,setSharedFriendIds:d}=m,h=F(),[t,o]=x.useState(!0);async function p(){if(a.length>0)return;o(!0);const{response:n,error:l}=await V("https://api.roadmap.sh/v1-list-friends");if(l||!n){h.error(l?.message||"Something went wrong");return}s(n.filter(i=>i.status==="accepted"))}x.useEffect(()=>{p().finally(()=>{o(!1)})},[]);const f=t&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:[...Array(3)].map((n,l)=>e.jsxs("li",{className:"flex animate-pulse items-center gap-2.5 rounded-md border p-2",children:[e.jsx("div",{className:"relative top-[1px] h-10 w-10 shrink-0 rounded-full bg-gray-200"}),e.jsxs("div",{className:"inline-grid w-full",children:[e.jsx("div",{className:"h-5 w-2/4 rounded bg-gray-200"}),e.jsx("div",{className:"mt-1 h-5 w-3/4 rounded bg-gray-200"})]})]},l))});return e.jsxs(e.Fragment,{children:[(a.length>0||t)&&e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"text-sm",children:"Select Friends to share the roadmap with"}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:r.length===a.length,onChange:n=>{n.target.checked?d(a.map(l=>l.userId)):d([])}}),e.jsx("span",{className:"text-sm",children:"Select all"})]})]}),f,a.length>0&&!t&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:a.map(n=>{const l=r?.includes(n.userId);return e.jsx("li",{children:e.jsx(Q,{user:{name:n.name,avatar:n.avatar,email:n.email},isSelected:l,onClick:()=>{d(l?r.filter(i=>i!==n.userId):[...r,n.userId])}})},n.userId)})}),a.length===0&&!t&&e.jsxs("div",{className:"flex h-full flex-grow flex-col items-center justify-center rounded-md border bg-gray-50 text-center",children:[e.jsx(O,{className:"mb-3 h-10 w-10 text-gray-300"}),e.jsxs("p",{className:"font-semibold text-gray-500",children:["You do not have any friends yet. ",e.jsx("br",{})," ",e.jsx("a",{target:"_blank",className:"underline underline-offset-2",href:`${{}.PUBLIC_ROADMAP_WEB_URL}/account/friends`,children:"Invite your friends to share roadmaps with."})]})]})]})}function xe(m){const{teams:s,setTeams:a,selectedTeamId:r,setSelectedTeamId:d,isTeamMembersLoading:h,setIsTeamMembersLoading:t,onTeamChange:o}=m,p=F(),[f,n]=x.useState(!0);async function l(){if(s.length>0)return;const{response:c,error:g}=await V("https://api.roadmap.sh/v1-get-user-teams");if(g||!c){p.error(g?.message||"Something went wrong");return}a(c.filter(k=>["admin","manager"].includes(k.role)))}x.useEffect(()=>{l().finally(()=>n(!1))},[]);const i=f&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:[...Array(3)].map((c,g)=>e.jsx("li",{children:e.jsxs("div",{className:"relative flex w-full items-center gap-2 rounded-md border p-2",children:[e.jsx("div",{className:"h-6 w-6 shrink-0 animate-pulse rounded-full bg-gray-200"}),e.jsx("div",{className:"inline-grid w-full",children:e.jsx("div",{className:"h-4 animate-pulse rounded bg-gray-200"})})]})},g))});return e.jsxs(e.Fragment,{children:[(s.length>0||f)&&e.jsx("p",{className:"text-sm",children:"Select a team to transfer this roadmap to"}),i,s.length>0&&!f&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-1.5",children:s.map(c=>{const g=c._id===r;return e.jsx("li",{children:e.jsxs("button",{className:j("relative flex w-full items-center gap-2.5 rounded-lg border p-2.5 disabled:cursor-not-allowed disabled:opacity-70",g&&"border-gray-500 bg-gray-100 text-black"),disabled:h,onClick:()=>{d(g?null:c._id),o(c._id)},children:[e.jsx("img",{src:c.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${c.avatar}`:"/images/default-avatar.png",alt:c.name||"",className:"h-6 w-6 shrink-0 rounded-full"}),e.jsx("div",{className:"inline-grid w-full",children:e.jsx("h3",{className:"truncate text-left font-normal",children:c.name})})]})},c._id)})}),s.length===0&&!f&&e.jsxs("div",{className:"flex grow flex-col items-center justify-center gap-2",children:[e.jsx(O,{className:"h-12 w-12 text-gray-500"}),e.jsx("p",{className:"text-gray-500",children:"You are not a member of any team."})]})]})}const ge=[{id:"me",label:"Only me",long:"Only visible to me",icon:K},{id:"public",label:"Public",long:"Anyone can view",icon:J},{id:"friends",label:"Only friends",long:"Only friends can view",icon:W},{id:"team",label:"Only Members",long:"Visible to team members",icon:O}];function ue(m){const{visibility:s,setVisibility:a,teamId:r,onChange:d}=m,h=t=>{a(t),d(t)};return e.jsxs("div",{className:"flex justify-between",children:[e.jsx("ul",{className:"flex w-full items-center gap-1.5",children:ge.map(t=>{if(t.id==="friends"&&r)return null;if(t.id==="team"&&!r)return null;const o=t.id===s;return e.jsx("li",{children:e.jsx(G,{label:t.label,isActive:o,icon:t.icon,onClick:()=>{h(t.id)}})},t.id)})}),!r&&e.jsx("div",{className:"grow",children:e.jsx(G,{label:"Transfer to team",icon:ie,isActive:s==="team",onClick:()=>{h("team")},className:'border-red-300 text-red-600 hover:border-red-200 hover:bg-red-50 data-[active="true"]:border-red-600 data-[active="true"]:bg-red-600 data-[active="true"]:text-white'})})]})}function G(m){const{label:s,isActive:a,onClick:r,icon:d,className:h}=m;return e.jsxs("button",{className:j("flex items-center justify-center gap-2 rounded-md border px-3 py-2 text-sm text-black hover:border-gray-300 hover:bg-gray-100",'data-[active="true"]:border-gray-500 data-[active="true"]:bg-gray-200 data-[active="true"]:text-black',h),"data-active":a,disabled:a,onClick:r,children:[!a&&e.jsx(d,{className:"h-4 w-4"}),a&&e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{className:"whitespace-nowrap",children:s})]})}function q(m){const{teamId:s,title:a="Select Members",sharedTeamMemberIds:r,setSharedTeamMemberIds:d,membersCache:h,isTeamMembersLoading:t,setIsTeamMembersLoading:o}=m,p=F();async function f(){if(h.has(s))return;o(!0);const{response:i,error:c}=await V(`https://api.roadmap.sh/v1-get-team-member-list/${s}`);if(c||!i){p.error(c?.message||"Something went wrong");return}const g=i?.filter(k=>k.status==="joined")||[];h.set(s,g)}x.useEffect(()=>{f().finally(()=>{o(!1)})},[s]);const n=t&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-2.5",children:[...Array(3)].map((i,c)=>e.jsxs("li",{className:"flex min-h-[66px] animate-pulse items-center gap-2 rounded-md border p-2",children:[e.jsx("div",{className:"h-8 w-8 shrink-0 rounded-full bg-gray-200"}),e.jsxs("div",{className:"inline-grid w-full",children:[e.jsx("div",{className:"h-5 w-2/4 rounded bg-gray-200"}),e.jsx("div",{className:"mt-1 h-5 w-3/4 rounded bg-gray-200"})]})]},c))}),l=h.get(s)||[];return e.jsxs(e.Fragment,{children:[(l.length>0||t)&&e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"text-sm",children:a}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:r.length===l.length,onChange:i=>{i.target.checked?d(l.map(c=>c._id)):d([])}}),e.jsx("span",{className:"text-sm",children:"Select all"})]})]}),n,l?.length>0&&!t&&e.jsx("ul",{className:"mt-2 grid grid-cols-3 gap-2.5",children:l?.map(i=>{const c=r?.includes(i._id?.toString());return e.jsx("li",{children:e.jsx(Q,{user:{name:i.name,avatar:i.avatar,email:i.invitedEmail},isSelected:c,onClick:()=>{d(c?r.filter(g=>g!==i._id?.toString()):[...r,i._id?.toString()])}})},i.userId)})}),l.length===0&&!t&&e.jsxs("div",{className:"flex grow flex-col items-center justify-center gap-2",children:[e.jsx(W,{className:"h-12 w-12 text-gray-500"}),e.jsx("p",{className:"text-gray-500",children:"No members have been added yet."})]})]})}function fe(m){const{roadmapId:s,onClose:a,description:r,visibility:d}=m,t=`https://roadmap.sh/r?id=${s}`,{copyText:o,isCopied:p}=re(),f=[{title:"Twitter",href:`https://twitter.com/intent/tweet?text=${r}&url=${t}`,icon:me},{title:"Facebook",href:`https://www.facebook.com/sharer/sharer.php?quote=${r}&u=${t}`,icon:de},{title:"Linkedin",href:`https://www.linkedin.com/sharing/share-offsite/?url=${t}`,icon:oe}];return e.jsxs("div",{className:"flex grow flex-col justify-center",children:[e.jsxs("div",{className:"mt-5 flex grow flex-col items-center justify-center gap-1.5",children:[e.jsx(ne,{className:"h-14 w-14 text-green-500"}),e.jsx("h3",{className:"text-xl font-medium",children:"Sharing Settings Updated"})]}),e.jsx("input",{type:"text",className:"mt-6 w-full rounded-md border bg-gray-50 p-2 px-2.5 text-gray-700 focus:outline-none",value:t,readOnly:!0,onClick:n=>{n.currentTarget.select(),o(t)}}),e.jsx("p",{className:"mt-1 text-sm text-gray-400",children:"You can share the above link with anyone who has access"}),d==="public"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"-mx-4 mt-4 flex items-center gap-1.5",children:[e.jsx("span",{className:"h-px grow bg-gray-300"}),e.jsx("span",{className:"text-xs uppercase text-gray-400 px-2",children:"Or"}),e.jsx("span",{className:"h-px grow bg-gray-300"})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Share with others on"}),e.jsx("ul",{className:"flex items-center gap-1.5",children:f.map(n=>e.jsx("li",{children:e.jsx("a",{href:n.href,target:"_blank",rel:"noopener noreferrer",className:"flex h-8 w-8 items-center justify-center gap-1.5 rounded-md border bg-gray-50 text-sm text-gray-700 hover:bg-gray-100 focus:outline-none",children:e.jsx(n.icon,{className:"h-4 w-4"})})},n.title))})]})]}),e.jsxs("div",{className:"mt-4 flex flex-col items-center justify-end gap-2",children:[e.jsxs("button",{className:j("flex w-full items-center justify-center gap-1.5 rounded bg-black px-4 py-2.5 text-sm font-medium text-white hover:opacity-80",p&&"bg-green-300 text-green-800"),disabled:p,onClick:()=>{o(t)},children:[e.jsx(le,{className:"h-3.5 w-3.5 stroke-[2.5]"}),p?"Copied":"Copy URL"]}),e.jsx("button",{className:j("flex w-full items-center justify-center gap-1.5 rounded border border-black px-4 py-2 text-sm font-medium hover:bg-gray-100"),onClick:a,children:"Close"})]})]})}function $e(m){const{roadmapId:s,onClose:a,isDiscoverable:r=!1,visibility:d,sharedTeamMemberIds:h=[],sharedFriendIds:t=[],teamId:o,onShareSettingsUpdate:p,description:f}=m,n=F(),[l,i]=x.useState(!1),[c,g]=x.useState(!1),[k,X]=x.useState([]),[Z,ee]=x.useState([]),[$,U]=x.useState(!1),D=x.useMemo(()=>new Map,[]),[u,se]=x.useState(d),[S,E]=x.useState(r),[w,v]=x.useState(h),[_,I]=x.useState(t),[C,P]=x.useState(null),M=u==="team"&&!o;let T=!1;(u==="friends"&&_.length===0||M&&!C||u==="team"&&o&&w.length===0)&&(T=!0);const ae=async({sharedFriendIds:b,visibility:N,sharedTeamMemberIds:L})=>{if(i(!0),N==="friends"&&b.length===0){n.error("Please select at least one friend");return}else if(N==="team"&&o&&L.length===0){n.error("Please select at least one member");return}const{response:A,error:R}=await z(`https://api.roadmap.sh/v1-update-roadmap-visibility/${s}`,{visibility:N,sharedFriendIds:b,sharedTeamMemberIds:L,isDiscoverable:S});if(R){n.error(R?.message||"Something went wrong, please try again");return}i(!1),g(!0),p({isDiscoverable:S,sharedFriendIds:b,visibility:N,sharedTeamMemberIds:L})},te=x.useCallback(async(b,N)=>{if(!s)return;i(!0);const{response:L,error:A}=await z(`https://api.roadmap.sh/v1-transfer-roadmap/${s}`,{teamId:b,sharedTeamMemberIds:N,isDiscoverable:S});if(A){i(!1),n.error(A?.message||"Something went wrong, please try again");return}window.location.reload()},[s]);return c?e.jsx(H,{onClose:a,wrapperClassName:"max-w-lg",bodyClassName:"p-4 flex flex-col",children:e.jsx(fe,{visibility:u,roadmapId:s,description:f,onClose:a})}):e.jsxs(H,{onClose:()=>{l||a()},wrapperClassName:"max-w-3xl",bodyClassName:"p-4 flex flex-col min-h-[440px]",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"mb-1 text-xl font-semibold",children:"Update Sharing Settings"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Pick and modify who can access this roadmap."})]}),e.jsx(ue,{visibility:u,setVisibility:se,teamId:o,onChange:b=>{P(null),["me","public"].includes(b)?(v([]),I([])):b==="friends"?I(t.length>0?t:[]):b==="team"&&o?(v(h?.length>0?h:[]),I([])):(I([]),v([])),E(b==="public")}}),e.jsxs("div",{className:"mt-4 flex grow flex-col",children:[u==="public"&&e.jsxs("div",{className:"flex h-full flex-grow flex-col items-center justify-center rounded-md border bg-gray-50 text-center",children:[e.jsx(J,{className:"mb-3 h-10 w-10 text-gray-300"}),e.jsx("p",{className:"font-medium text-gray-500",children:"Anyone with the link can access."})]}),u==="me"&&e.jsxs("div",{className:"flex h-full flex-grow flex-col items-center justify-center rounded-md border bg-gray-50 text-center",children:[e.jsx(K,{className:"mb-3 h-10 w-10 text-gray-300"}),e.jsx("p",{className:"font-medium text-gray-500",children:"Only you will be able to access."})]}),u==="friends"&&e.jsx(he,{friends:k,setFriends:X,sharedFriendIds:_,setSharedFriendIds:I}),u==="team"&&o&&e.jsx(q,{teamId:o,sharedTeamMemberIds:w,setSharedTeamMemberIds:v,membersCache:D,isTeamMembersLoading:$,setIsTeamMembersLoading:U}),M&&e.jsxs(e.Fragment,{children:[e.jsx(xe,{teams:Z,setTeams:ee,selectedTeamId:C,setSelectedTeamId:P,isTeamMembersLoading:$,setIsTeamMembersLoading:U,onTeamChange:()=>{v([])}}),C&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"-mx-4 my-4"}),e.jsx("div",{className:"mb-4",children:e.jsx(q,{title:"Select who can access this roadmap. You can change this later.",teamId:C,sharedTeamMemberIds:w,setSharedTeamMemberIds:v,membersCache:D,isTeamMembersLoading:$,setIsTeamMembersLoading:U})})]})]})]}),u!=="me"&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"-mx-4 my-4"}),e.jsx("div",{className:"mb-2",children:e.jsx(pe,{isDiscoverable:S,setIsDiscoverable:E})})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between gap-1.5",children:[e.jsx("button",{className:"flex items-center justify-center gap-1.5 rounded-md border px-3.5 py-1.5 hover:bg-gray-100 disabled:cursor-not-allowed disabled:opacity-75",disabled:l,onClick:a,children:"Close"}),M&&e.jsxs(B,{disabled:T||l||w.length===0,onClick:()=>{te(C,w).then(()=>null)},children:[l&&e.jsx(Y,{className:"h-4 w-4 animate-spin"}),"Transfer"]}),!M&&e.jsxs(B,{disabled:T||l,onClick:()=>{ae({isDiscoverable:S,visibility:u,sharedTeamMemberIds:u==="team"?w:[],sharedFriendIds:u==="friends"?_:[]})},children:[l&&e.jsx(Y,{className:"h-4 w-4 animate-spin"}),"Update Sharing Settings"]})]})]})}function B(m){const{onClick:s,disabled:a,children:r,className:d}=m;return e.jsx("button",{className:j("flex min-w-[120px] items-center justify-center gap-1.5 rounded-md border border-gray-900 bg-gray-900 px-4 py-2 text-white hover:bg-gray-800 disabled:cursor-not-allowed disabled:opacity-75",a&&"border-gray-700 bg-gray-700 text-white hover:bg-gray-700",d),disabled:a,onClick:s,children:r})}function pe(m){const{isDiscoverable:s,setIsDiscoverable:a}=m;return e.jsxs("label",{className:"group flex items-center gap-1.5",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:r=>a(r.target.checked)}),e.jsx("span",{className:"text-sm text-gray-500 group-hover:text-gray-700",children:"Include on discovery page (when launched)"})]})}export{K as L,Le as M,$e as S,Fe as T};
