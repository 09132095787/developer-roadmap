import{j as e}from"./jsx-runtime.KYujgZxC.js";import{r as s}from"./index.068npczX.js";import{u as N}from"./use-keydown.A5Ei3HxG.js";import{u as D}from"./use-outside-click.8agT9V5u.js";import{a as re}from"./http.FvipgnVD.js";import{i as F}from"./jwt.E7BTUPpl.js";import{g as oe,u as q,a as A,b as G,i as ie}from"./resource-progress.6e21kl_i.js";import{p as R,s as ae}from"./page.WSJoHwTn.js";import{s as _}from"./popup.xZrd6hzK.js";import{u as B}from"./use-toast.g_ZHNYU9.js";import{S as O}from"./Spinner.JIsgQuDp.js";import{C as le}from"./chevron-down.EIXdT033.js";import{s as ce,m as de}from"./markdown.or4ulUFQ.js";import{c as pe}from"./classname.J02y5HY7.js";import{g as me}from"./browser.SKWmFesa.js";import{G as ue}from"./GitHubIcon.S41FbzfH.js";import{X as z}from"./x.P9PArTNO.js";import{c as K}from"./createLucideIcon.vQ5YHosT.js";import"./roadmap.mY9zKeY8.js";import"./index.2T9xAa-2.js";import"./index.rS7vpNfE.js";import"./toast.21LYZN4o.js";import"./bundle-mjs.-_24JQzE.js";function xe(u){s.useEffect(()=>{function n(a){const{resourceType:l,resourceId:o,topicId:p,isCustomResource:b=!1}=a.detail;u({resourceType:l,resourceId:o,topicId:p,isCustomResource:b})}return window.addEventListener("roadmap.topic.click",n),window.addEventListener("best-practice.topic.click",n),window.addEventListener("roadmap.node.click",n),()=>{window.removeEventListener("roadmap.topic.click",n),window.removeEventListener("best-practice.topic.click",n),window.removeEventListener("roadmap.node.click",n)}},[])}function ge(u){s.useEffect(()=>{function n(a){const{resourceType:l,resourceId:o,topicId:p}=a.detail;u({resourceType:l,resourceId:o,topicId:p})}return window.addEventListener("roadmap.topic.toggle",n),window.addEventListener("best-practice.topic.toggle",n),()=>{window.removeEventListener("best-practice.topic.toggle",n)}},[])}/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=K("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=K("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),v={done:"bg-green-500",learning:"bg-yellow-500",pending:"bg-gray-300",skipped:"bg-black",removed:""};function be(u){const{topicId:n,resourceId:a,resourceType:l,onClose:o}=u,p=B(),[b,m]=s.useState(!0),[t,g]=s.useState("pending"),[h,y]=s.useState(!1),S=s.useRef(null);D(S,()=>{y(!1)});const j=s.useMemo(()=>!F(),[]);s.useEffect(()=>{!n||!a||!l||(m(!0),oe({topicId:n,resourceId:a,resourceType:l}).then(d=>{m(!1),g(d)}).catch(console.error))},[n,a,l]),N("d",()=>{if(t==="done"){o();return}i("done")},[t]),N("l",()=>{if(t==="learning"){o();return}i("learning")},[t]),N("s",()=>{if(t==="skipped"){o();return}i("skipped")},[t]),N("r",()=>{if(console.log(t),t==="pending"){o();return}i("pending")},[t]);const i=d=>{if(j){o(),_();return}m(!0),q({topicId:n,resourceId:a,resourceType:l},d).then(()=>{g(d),o(),A(n,d),G()}).catch(E=>{p.error(E.message||"Error updating progress"),console.error(E)}).finally(()=>{m(!1)})},T=["pending","learning","done"].includes(t),I=["skipped","pending","learning"].includes(t),w=["done","skipped","pending"].includes(t),P=["skipped","done","learning"].includes(t);return b?e.jsxs("button",{className:"inline-flex cursor-default items-center rounded-md border border-gray-300 bg-white p-1 px-2 text-sm text-black",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-2",children:"Updating Status.."})]}):e.jsxs("div",{className:"relative inline-flex rounded-md border border-gray-300",children:[e.jsxs("span",{className:"inline-flex cursor-default items-center  p-1 px-2 text-sm text-black",children:[e.jsx("span",{className:"flex h-2 w-2",children:e.jsx("span",{className:`relative inline-flex h-2 w-2 rounded-full ${v[t]}`})}),e.jsx("span",{className:"ml-2 capitalize",children:t==="learning"?"In Progress":t})]}),e.jsxs("button",{className:"inline-flex cursor-pointer items-center rounded-br-md rounded-tr-md border-l border-l-gray-300 bg-gray-100 p-1 px-2 text-sm text-black hover:bg-gray-200",onClick:()=>y(!0),children:[e.jsx("span",{className:"mr-0.5",children:"Update Status"}),e.jsx(le,{className:"h-4 w-4"})]}),h&&e.jsxs("div",{className:"absolute right-0 top-full mt-1 flex min-w-[160px] flex-col divide-y rounded-md border border-gray-200 bg-white shadow-md [&>button:first-child]:rounded-t-md [&>button:last-child]:rounded-b-md",ref:S,children:[I&&e.jsxs("button",{className:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>i("done"),children:[e.jsxs("span",{children:[e.jsx("span",{className:`mr-2 inline-block h-2 w-2 rounded-full ${v.done}`}),"Done"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"D"})]}),w&&e.jsxs("button",{className:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>i("learning"),children:[e.jsxs("span",{children:[e.jsx("span",{className:`mr-2 inline-block h-2 w-2 rounded-full ${v.learning}`}),"In Progress"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"L"})]}),P&&e.jsxs("button",{className:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>i("pending"),children:[e.jsxs("span",{children:[e.jsx("span",{className:`mr-2 inline-block h-2 w-2 rounded-full ${v.pending}`}),"Reset"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"R"})]}),T&&e.jsxs("button",{className:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>i("skipped"),children:[e.jsxs("span",{children:[e.jsx("span",{className:`mr-2 inline-block h-2 w-2 rounded-full ${v.skipped}`}),"Skip"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"S"})]})]})]})}const ye={article:"bg-yellow-200",course:"bg-green-200",opensource:"bg-blue-200",podcast:"bg-purple-200",video:"bg-pink-200",website:"bg-red-200"};function Be(u){const{canSubmitContribution:n,isEmbed:a=!1}=u,[l,o]=s.useState(!1),[p,b]=s.useState(""),[m,t]=s.useState(!1),[g,h]=s.useState(!1),[y,S]=s.useState(!1),[j,i]=s.useState(""),[T,I]=s.useState(""),[w,P]=s.useState(""),[d,E]=s.useState([]),V=B(),{secret:U}=me(),X=s.useMemo(()=>!F(),[]),$=s.useRef(null),[J,Q]=s.useState(""),[W,Y]=s.useState(""),[Z,ee]=s.useState("roadmap");if(D($,()=>{t(!1)}),N("Escape",()=>{t(!1)}),ge(({topicId:r,resourceType:k,resourceId:x})=>{if(X){_();return}R.set("Updating"),ie({topicId:r,resourceId:x,resourceType:k}).then(c=>q({topicId:r,resourceId:x,resourceType:k},c?"pending":"done")).then(({done:c=[]})=>{A(r,c.includes(r)?"done":"pending"),G()}).catch(c=>{V.error(c.message),console.error(c)}).finally(()=>{R.set("")})}),xe(({topicId:r,resourceType:k,resourceId:x,isCustomResource:c})=>{i(""),h(!0),t(!0),ae.set(!0),Q(r),ee(k),Y(x);const M=r.replaceAll(":","/");let H=k==="roadmap"?`/${x}/${M}`:`/best-practices/${x}/${M}`;c&&(H=`https://api.roadmap.sh/v1-get-node-content/${x}/${r}${U?`?secret=${U}`:""}`),re(H,{},{...!c&&{headers:{Accept:"text/html"}}}).then(({response:f})=>{if(!f){i("Topic not found."),h(!1);return}let C="";if(c){E(f?.links||[]),P(f?.title||"");const L=ce(f.description||"");C=de(L,!1)}else{C=f;const L=new DOMParser().parseFromString(C,"text/html"),se=L.querySelectorAll("a"),ne=L.querySelector("[data-github-url]")?.dataset?.githubUrl||"";b(ne),o(se.length>=3)}h(!1),I(C)}).catch(f=>{i("Something went wrong. Please try again later."),h(!1)})}),s.useEffect(()=>{m&&$?.current?.focus()},[m]),!m)return null;const te=T?.length>0||d?.length>0||w;return e.jsxs("div",{className:"relative z-50",children:[e.jsxs("div",{ref:$,tabIndex:0,className:"fixed right-0 top-0 z-40 h-screen w-full overflow-y-auto bg-white p-4 focus:outline-0 sm:max-w-[600px] sm:p-6",children:[g&&e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(O,{outerFill:"#d1d5db",className:"h-6 w-6 sm:h-12 sm:w-12",innerFill:"#2563eb"})}),!y&&!g&&!j&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-2",children:[!a&&e.jsx(be,{topicId:J,resourceId:W,resourceType:Z,onClose:()=>{t(!1)}}),e.jsx("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>{t(!1)},children:e.jsx(z,{className:"h-5 w-5"})})]}),te?e.jsxs("div",{className:"prose prose-quoteless prose-h1:mb-2.5 prose-h1:mt-7 prose-h2:mb-3 prose-h2:mt-0 prose-h3:mb-[5px] prose-h3:mt-[10px] prose-p:mb-2 prose-p:mt-0 prose-blockquote:font-normal prose-blockquote:not-italic prose-blockquote:text-gray-700 prose-li:m-0 prose-li:mb-0.5",children:[w&&e.jsx("h1",{children:w}),e.jsx("div",{id:"topic-content",dangerouslySetInnerHTML:{__html:T}})]}):e.jsxs("div",{className:"flex h-[calc(100%-38px)] flex-col items-center justify-center",children:[e.jsx(fe,{className:"h-16 w-16 text-gray-300"}),e.jsx("p",{className:"mt-2 text-lg font-medium text-gray-500",children:"Empty Content"})]}),d.length>0&&e.jsx("ul",{className:"mt-6 space-y-1",children:d.map(r=>e.jsx("li",{children:e.jsxs("a",{href:r.url,target:"_blank",className:"font-medium underline",children:[e.jsx("span",{className:pe("mr-2 inline-block rounded px-1.5 py-1 text-xs uppercase no-underline",ye[r.type]),children:r.type.charAt(0).toUpperCase()+r.type.slice(1)}),r.title]})}))}),n&&!l&&p&&e.jsxs("div",{className:"mt-8 flex-1 border-t",children:[e.jsx("p",{className:"mb-2 mt-2 text-sm leading-relaxed text-gray-400",children:"Help us improve this introduction and submit a link to a good article, podcast, video, or any other resource that helped you understand this topic better."}),e.jsxs("a",{href:p,target:"_blank",className:"flex w-full items-center justify-center rounded-md bg-gray-800 p-2 text-sm text-white transition-colors hover:bg-black hover:text-white disabled:bg-green-200 disabled:text-black",children:[e.jsx(ue,{className:"mr-2 inline-block h-4 w-4 text-white"}),"Edit this Content"]})]})]}),!y&&!g&&j&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>{t(!1),S(!1)},children:e.jsx(z,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex h-full flex-col items-center justify-center",children:[e.jsx(he,{className:"h-16 w-16 text-red-500"}),e.jsx("p",{className:"mt-2 text-lg font-medium text-red-500",children:j})]})]})]}),e.jsx("div",{className:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"})]})}export{Be as TopicDetail};
