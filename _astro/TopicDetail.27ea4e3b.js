import{j as e}from"./jsx-runtime.6940b965.js";import{r as t}from"./index.070054a4.js";import{u as v}from"./use-keydown.bb1f91bb.js";import{u as F}from"./use-outside-click.5adb83b9.js";import{a as ee}from"./http.968dc426.js";import{i as z}from"./jwt.5556697d.js";import{g as te,u as A,a as q,b as G,i as se}from"./resource-progress.7405950f.js";import{p as R,s as re}from"./page.2efb91d4.js";import{s as B}from"./popup.a359f713.js";import{u as _}from"./use-toast.dbd347db.js";import{S as O}from"./Spinner.799b0955.js";import{C as ne}from"./chevron-down.cc515fa2.js";import{m as oe}from"./markdown.9aebbb7a.js";import{c as ae}from"./classname.0c0e8aac.js";import{g as ie}from"./browser.6245b9a5.js";import{G as le}from"./GitHubIcon.767c6ea0.js";import{X as U}from"./x.c33f2cf5.js";import{c as K}from"./createLucideIcon.3c9fdece.js";import"./roadmap.2126cc25.js";import"./index.1c368e68.js";import"./index.4b590221.js";import"./toast.5b8c89b6.js";import"./bundle-mjs.58d1fad7.js";function ce(u){t.useEffect(()=>{function r(l){const{resourceType:c,resourceId:n,topicId:a,isCustomResource:x=!1}=l.detail;u({resourceType:c,resourceId:n,topicId:a,isCustomResource:x})}return window.addEventListener("roadmap.topic.click",r),window.addEventListener("best-practice.topic.click",r),window.addEventListener("roadmap.node.click",r),()=>{window.removeEventListener("roadmap.topic.click",r),window.removeEventListener("best-practice.topic.click",r),window.removeEventListener("roadmap.node.click",r)}},[])}function de(u){t.useEffect(()=>{function r(l){const{resourceType:c,resourceId:n,topicId:a}=l.detail;u({resourceType:c,resourceId:n,topicId:a})}return window.addEventListener("roadmap.topic.toggle",r),window.addEventListener("best-practice.topic.toggle",r),()=>{window.removeEventListener("best-practice.topic.toggle",r)}},[])}const pe=K("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),me=K("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),k={done:"bg-green-500",learning:"bg-yellow-500",pending:"bg-gray-300",skipped:"bg-black",removed:""};function ue(u){const{topicId:r,resourceId:l,resourceType:c,onClose:n}=u,a=_(),[x,p]=t.useState(!0),[s,N]=t.useState("pending"),[b,h]=t.useState(!1),y=t.useRef(null);F(y,()=>{h(!1)});const C=t.useMemo(()=>!z(),[]);t.useEffect(()=>{!r||!l||!c||(p(!0),te({topicId:r,resourceId:l,resourceType:c}).then(m=>{p(!1),N(m)}).catch(console.error))},[r,l,c]),v("d",()=>{if(s==="done"){n();return}i("done")},[s]),v("l",()=>{if(s==="learning"){n();return}i("learning")},[s]),v("s",()=>{if(s==="skipped"){n();return}i("skipped")},[s]),v("r",()=>{if(console.log(s),s==="pending"){n();return}i("pending")},[s]);const i=m=>{if(C){n(),B();return}p(!0),A({topicId:r,resourceId:l,resourceType:c},m).then(()=>{N(m),n(),q(r,m),G()}).catch(S=>{a.error(S.message||"Error updating progress"),console.error(S)}).finally(()=>{p(!1)})},E=["pending","learning","done"].includes(s),j=["skipped","pending","learning"].includes(s),L=["done","skipped","pending"].includes(s),I=["skipped","done","learning"].includes(s);return x?e.jsxs("button",{className:"inline-flex cursor-default items-center rounded-md border border-gray-300 bg-white p-1 px-2 text-sm text-black",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{className:"ml-2",children:"Updating Status.."})]}):e.jsxs("div",{className:"relative inline-flex rounded-md border border-gray-300",children:[e.jsxs("span",{className:"inline-flex cursor-default items-center  p-1 px-2 text-sm text-black",children:[e.jsx("span",{className:"flex h-2 w-2",children:e.jsx("span",{className:`relative inline-flex h-2 w-2 rounded-full ${k[s]}`})}),e.jsx("span",{className:"ml-2 capitalize",children:s==="learning"?"In Progress":s})]}),e.jsxs("button",{className:"inline-flex cursor-pointer items-center rounded-br-md rounded-tr-md border-l border-l-gray-300 bg-gray-100 p-1 px-2 text-sm text-black hover:bg-gray-200",onClick:()=>h(!0),children:[e.jsx("span",{className:"mr-0.5",children:"Update Status"}),e.jsx(ne,{className:"h-4 w-4"})]}),b&&e.jsxs("div",{className:"absolute right-0 top-full mt-1 flex min-w-[160px] flex-col divide-y rounded-md border border-gray-200 bg-white shadow-md [&>button:first-child]:rounded-t-md [&>button:last-child]:rounded-b-md",ref:y,children:[j&&e.jsxs("button",{className:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>i("done"),children:[e.jsxs("span",{children:[e.jsx("span",{className:`mr-2 inline-block h-2 w-2 rounded-full ${k.done}`}),"Done"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"D"})]}),L&&e.jsxs("button",{className:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>i("learning"),children:[e.jsxs("span",{children:[e.jsx("span",{className:`mr-2 inline-block h-2 w-2 rounded-full ${k.learning}`}),"In Progress"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"L"})]}),I&&e.jsxs("button",{className:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>i("pending"),children:[e.jsxs("span",{children:[e.jsx("span",{className:`mr-2 inline-block h-2 w-2 rounded-full ${k.pending}`}),"Reset"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"R"})]}),E&&e.jsxs("button",{className:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>i("skipped"),children:[e.jsxs("span",{children:[e.jsx("span",{className:`mr-2 inline-block h-2 w-2 rounded-full ${k.skipped}`}),"Skip"]}),e.jsx("span",{className:"text-xs text-gray-500",children:"S"})]})]})]})}const xe={article:"bg-yellow-200",course:"bg-green-200",opensource:"bg-blue-200",podcast:"bg-purple-200",video:"bg-pink-200",website:"bg-red-200"};function Ae(u){const{canSubmitContribution:r}=u,[l,c]=t.useState(!1),[n,a]=t.useState(!1),[x,p]=t.useState(!1),[s,N]=t.useState(!1),[b,h]=t.useState(""),[y,C]=t.useState(""),[i,E]=t.useState(""),[j,L]=t.useState([]),I=_(),{secret:m}=ie(),S=t.useMemo(()=>!z(),[]),P=t.useRef(null),[V,X]=t.useState(""),[$,J]=t.useState(""),[D,Q]=t.useState("roadmap");if(F(P,()=>{a(!1)}),v("Escape",()=>{a(!1)}),de(({topicId:o,resourceType:w,resourceId:g})=>{if(S){B();return}R.set("Updating"),se({topicId:o,resourceId:g,resourceType:w}).then(d=>A({topicId:o,resourceId:g,resourceType:w},d?"pending":"done")).then(({done:d=[]})=>{q(o,d.includes(o)?"done":"pending"),G()}).catch(d=>{I.error(d.message),console.error(d)}).finally(()=>{R.set("")})}),ce(({topicId:o,resourceType:w,resourceId:g,isCustomResource:d})=>{h(""),p(!0),a(!0),re.set(!0),X(o),Q(w),J(g);const H=o.replaceAll(":","/");let M=w==="roadmap"?`/${g}/${H}`:`/best-practices/${g}/${H}`;d&&(M=`https://api.roadmap.sh/v1-get-node-content/${g}/${o}${m?`?secret=${m}`:""}`),ee(M,{},{...!d&&{headers:{Accept:"text/html"}}}).then(({response:f})=>{if(!f){h("Topic not found."),p(!1);return}let T="";if(d)L(f?.links||[]),E(f?.title||""),T=oe(f?.description||"",!1);else{T=f;const Z=new DOMParser().parseFromString(T,"text/html").querySelectorAll("a");c(Z.length>=3)}p(!1),C(T)}).catch(f=>{h("Something went wrong. Please try again later."),p(!1)})}),t.useEffect(()=>{n&&P?.current?.focus()},[n]),!n)return null;const W=y?.length>0||j?.length>0||i,Y=`https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/${D==="roadmap"?"roadmaps":"best-practices"}/${$}/content`;return e.jsxs("div",{className:"relative z-50",children:[e.jsxs("div",{ref:P,tabIndex:0,className:"fixed right-0 top-0 z-40 h-screen w-full overflow-y-auto bg-white p-4 focus:outline-0 sm:max-w-[600px] sm:p-6",children:[x&&e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(O,{outerFill:"#d1d5db",className:"h-6 w-6 sm:h-12 sm:w-12",innerFill:"#2563eb"})}),!s&&!x&&!b&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-2",children:[e.jsx(ue,{topicId:V,resourceId:$,resourceType:D,onClose:()=>{a(!1)}}),e.jsx("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>{a(!1)},children:e.jsx(U,{className:"h-5 w-5"})})]}),W?e.jsxs("div",{className:"prose prose-quoteless prose-h1:mb-2.5 prose-h1:mt-7 prose-h2:mb-3 prose-h2:mt-0 prose-h3:mb-[5px] prose-h3:mt-[10px] prose-p:mb-2 prose-p:mt-0 prose-blockquote:font-normal prose-blockquote:not-italic prose-blockquote:text-gray-700 prose-li:m-0 prose-li:mb-0.5",children:[i&&e.jsx("h1",{children:i}),e.jsx("div",{id:"topic-content",dangerouslySetInnerHTML:{__html:y}})]}):e.jsxs("div",{className:"flex h-[calc(100%-38px)] flex-col items-center justify-center",children:[e.jsx(me,{className:"h-16 w-16 text-gray-300"}),e.jsx("p",{className:"mt-2 text-lg font-medium text-gray-500",children:"Empty Content"})]}),j.length>0&&e.jsx("ul",{className:"mt-6 space-y-1",children:j.map(o=>e.jsx("li",{children:e.jsxs("a",{href:o.url,target:"_blank",className:"font-medium underline",children:[e.jsx("span",{className:ae("mr-2 inline-block rounded px-1.5 py-1 text-xs uppercase no-underline",xe[o.type]),children:o.type.charAt(0).toUpperCase()+o.type.slice(1)}),o.title]})}))}),r&&!l&&e.jsxs("div",{className:"mt-8 flex-1 border-t",children:[e.jsx("p",{className:"mb-2 mt-2 text-sm leading-relaxed text-gray-400",children:"Help us improve this introduction and submit a link to a good article, podcast, video, or any other resource that helped you understand this topic better."}),e.jsxs("a",{href:Y,target:"_blank",className:"flex w-full items-center justify-center rounded-md bg-gray-800 p-2 text-sm text-white transition-colors hover:bg-black hover:text-white disabled:bg-green-200 disabled:text-black",children:[e.jsx(le,{className:"mr-2 inline-block h-4 w-4 text-white"}),"Edit this Content"]})]})]}),!s&&!x&&b&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>{a(!1),N(!1)},children:e.jsx(U,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex h-full flex-col items-center justify-center",children:[e.jsx(pe,{className:"h-16 w-16 text-red-500"}),e.jsx("p",{className:"mt-2 text-lg font-medium text-red-500",children:b})]})]})]}),e.jsx("div",{className:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"})]})}export{Ae as TopicDetail};
