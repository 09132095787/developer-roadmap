import{a as k,T as S}from"./jwt.f0e0aa9c.js";import{h as E,a as L}from"./http.12b0c277.js";async function v(r){const{topicId:e,resourceType:o,resourceId:c}=r,{done:t=[]}=await p(o,c)||{};return t?.includes(e)}async function A(r){const{topicId:e,resourceType:o,resourceId:c}=r,t=await p(o,c);return t?.done?.includes(e)?"done":t?.learning?.includes(e)?"learning":t?.skipped?.includes(e)?"skipped":"pending"}async function I(r,e){const{topicId:o,resourceType:c,resourceId:t}=r,{response:s,error:n}=await E("https://api.roadmap.sh/v1-update-resource-progress",{topicId:o,resourceType:c,resourceId:t,progress:e});if(n||!s?.done||!s?.learning)throw new Error(n?.message||"Something went wrong");return h(c,t,s.done,s.learning,s.skipped),s}async function p(r,e){if(!k.get(S))return{done:[],learning:[],skipped:[]};const o=`${r}-${e}-progress`,c=localStorage.getItem(o),t=JSON.parse(c||"null"),s=t?.timestamp,i=new Date().getTime()-parseInt(s||"0",10)>15*60*1e3;return!t||i?$(r,e):t}async function $(r,e){const{response:o,error:c}=await L("https://api.roadmap.sh/v1-get-user-resource-progress",{resourceType:r,resourceId:e});return c||!o?(console.error(c),{done:[],learning:[],skipped:[]}):(h(r,e,o?.done||[],o?.learning||[],o?.skipped||[]),o)}function h(r,e,o,c,t){localStorage.setItem(`${r}-${e}-progress`,JSON.stringify({done:o,learning:c,skipped:t,timestamp:new Date().getTime()}))}function l(r,e){const o=e==="learning",c=e==="skipped",t=e==="done",s=[];document.querySelectorAll(`[data-group-id$="-${r}"]`).forEach(n=>{const i=n?.dataset?.groupId||"";new RegExp(`^\\d+-${r}$`).test(i)&&s.push(n)}),document.querySelectorAll(`[data-group-id="${r}"]`).forEach(n=>{s.push(n)}),document.querySelectorAll(`[data-group-id="check:${r}"]`).forEach(n=>{s.push(n)}),s.forEach(n=>{t?(n.classList.add("done"),n.classList.remove("learning","skipped")):o?(n.classList.add("learning"),n.classList.remove("done","skipped")):c?(n.classList.add("skipped"),n.classList.remove("done","learning")):n.classList.remove("done","skipped","learning")})}async function P(r,e){const{done:o=[],learning:c=[],skipped:t=[]}=await p(r,e)||{};o.forEach(s=>{l(s,"done")}),c.forEach(s=>{l(s,"learning")}),t.forEach(s=>{l(s,"skipped")}),q()}function q(){const r=document.getElementById("progress-nums-container"),e=document.getElementById("progress-nums");if(!r||!e)return;const o=document.querySelectorAll(".clickable-group").length,c=document.querySelectorAll('[data-group-id^="ext_link:"]').length,t=document.querySelectorAll('[data-group-id^="json:"]').length,s=o-c-t,n=document.querySelectorAll(".clickable-group.done").length,i=document.querySelectorAll(".clickable-group.learning").length,a=document.querySelectorAll(".clickable-group.skipped").length,d=document.querySelector(".progress-done");d&&(d.innerHTML=`${n}`);const u=document.querySelector(".progress-learning");u&&(u.innerHTML=`${i}`);const g=document.querySelector(".progress-skipped");g&&(g.innerHTML=`${a}`);const m=document.querySelector(".progress-total");m&&(m.innerHTML=`${s}`);const y=Math.round((n+a)/s*100),f=document.querySelector(".progress-percentage");f&&(f.innerHTML=`${y}`),r.classList.remove("striped-loader"),e.classList.remove("opacity-0"),e.classList.remove("opacity-100")}export{q as a,P as b,A as g,v as i,l as r,I as u};
