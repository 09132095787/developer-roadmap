import{j as e}from"./jsx-runtime.6940b965.js";import{r as t}from"./index.070054a4.js";import{u as E}from"./use-keydown.bb1f91bb.js";import{u as I}from"./use-outside-click.5adb83b9.js";import{C as U}from"./close.bb7a0ac2.js";import{D as $}from"./index.es.ebad3893.js";import{S as k}from"./Spinner.799b0955.js";import{d as z}from"./http.408ee04f.js";import{a as R}from"./resource-progress.8f66df23.js";/* empty css                       */import{u as D}from"./use-toast.dbd347db.js";function S(f){const{isSelected:l,onClick:r,title:n}=f;return e.jsxs("button",{className:`group flex min-h-[35px] items-stretch overflow-hidden rounded-md text-sm ${l?"bg-black text-white transition-colors hover:bg-gray-700":"border border-gray-300 hover:bg-gray-100"}`,onClick:r,children:[e.jsx("span",{className:"flex items-center px-3",children:n}),l&&e.jsx("span",{className:"flex items-center bg-gray-700 px-3 text-xs text-white transition-colors",children:"Ã—"}),!l&&e.jsx("span",{className:"flex items-center bg-gray-100 px-2.5 text-xs text-gray-500",children:"+"})]})}function V(f){const{onClose:l,allRoadmaps:r,onRoadmapAdd:n,onRoadmapRemove:p,teamResourceConfig:v}=f,d=t.useRef(null),i=t.useRef(null),[x,h]=t.useState(r),[u,y]=t.useState("");E("Escape",()=>{l()}),I(d,()=>{l()}),t.useEffect(()=>{i.current&&i.current.focus()},[i]),t.useEffect(()=>{if(u.length===0){h(r);return}const s=r.filter(a=>a.title.toLowerCase().includes(u.toLowerCase())||a.id.toLowerCase().includes(u.toLowerCase()));h(s)},[u,r]);const g=x.filter(s=>s?.metadata?.tags?.includes("role-roadmap")),w=x.filter(s=>s?.metadata?.tags?.includes("skill-roadmap"));return e.jsx("div",{className:"fixed left-0 right-0 top-0 z-50 h-full items-center justify-center overflow-y-auto overflow-x-hidden overscroll-contain bg-black/50",children:e.jsx("div",{className:"relative mx-auto h-full w-full max-w-2xl p-4 md:h-auto",children:e.jsxs("div",{ref:d,className:"popup-body relative mt-4 overflow-hidden rounded-lg bg-white shadow",children:[e.jsxs("button",{type:"button",className:"popup-close absolute right-2.5 top-3 ml-auto inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-100 hover:text-gray-900",onClick:l,children:[e.jsx("img",{alt:"close",src:U.src,className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close modal"})]}),e.jsx("input",{ref:i,type:"text",placeholder:"Search roadmaps",className:"block w-full border-b px-5 pb-3.5 pt-4 outline-none placeholder:text-gray-400",value:u,onInput:s=>y(s.target.value)}),e.jsxs("div",{className:"min-h-[200px] p-4",children:[e.jsx("span",{className:"block pb-3 text-xs uppercase text-gray-400",children:"Role Based Roadmaps"}),g.length===0&&e.jsx("p",{className:"mb-1 flex h-full items-start text-sm italic text-gray-400"}),g.length>0&&e.jsx("div",{className:"mb-5 flex flex-wrap items-center gap-2",children:g.map(s=>{const a=!!v?.find(c=>c.resourceId===s.id);return e.jsx(S,{title:s.title,isSelected:a,onClick:()=>{a?p(s.id):n(s.id)}},s.id)})}),e.jsx("span",{className:"block pb-3 text-xs uppercase text-gray-400",children:"Skill Based Roadmaps"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:w.map(s=>{const a=!!v.find(c=>c.resourceId===s.id);return e.jsx(S,{title:s.title,isSelected:a,onClick:()=>{a?p(s.id):n(s.id)}},s.id)})})]})]})})})}function W(f){const{defaultRemovedItems:l=[],resourceId:r,resourceType:n,teamId:p,setTeamResourceConfig:v,onClose:d}=f,i=t.useRef(null),x=t.useRef(null),h=D(),[u,y]=t.useState(!0),[g,w]=t.useState(!1),[s,a]=t.useState(l);t.useEffect(()=>{function o(b){const j=b.target.closest(".clickable-group")?.dataset?.groupId;if(!j)return;const m=j.replace(/^\d+-/,"");s.includes(m)?(a(N=>N.filter(B=>B!==m)),R(m,"reset")):(a(N=>[...N,m]),R(m,"removed"))}return document.addEventListener("click",o),()=>{document.removeEventListener("click",o)}},[s]);let c="https://roadmap.sh";n==="roadmap"?c+=`/${r}.json`:c+=`/best-practices/${r}.json`;async function L(o){const C=await(await fetch(o)).json(),j=await $(C,{fontURL:"/fonts/balsamiq.woff2"});i.current?.replaceChildren(j),s.forEach(m=>{R(m,"removed")})}E("Escape",()=>{d()}),I(x,()=>{d()});async function T(){if(s.length===0)return;w(!0);const{error:o,response:b}=await z(`https://api.roadmap.sh/v1-update-team-resource-config/${p}`,{teamId:p,resourceId:r,resourceType:n,removed:s});if(o||!b){h.error(o?.message||"Error adding roadmap");return}v(b),d()}return t.useEffect(()=>{!i.current||!c||!r||!n||!p||L(c).catch(o=>{console.error(o),h.error("Something went wrong. Please try again!")}).finally(()=>{y(!1)})},[]),e.jsx("div",{className:"fixed left-0 right-0 top-0 z-50 h-full items-center justify-center overflow-y-auto overflow-x-hidden overscroll-contain bg-black/50",children:e.jsx("div",{className:"relative mx-auto h-full w-full max-w-4xl p-4 md:h-auto",children:e.jsxs("div",{id:"customized-roadmap",ref:x,className:"popup-body relative rounded-lg bg-white shadow",children:[e.jsxs("div",{className:"sticky top-0 mb-3 rounded-2xl border-4 border-white bg-black p-4",children:[e.jsx("p",{className:"mb-2 text-gray-300",children:"Click and select the items to remove from the roadmap."}),e.jsxs("div",{className:"flex flex-row items-center gap-1.5",children:[e.jsx("button",{disabled:s.length===0,onClick:()=>T().finally(()=>w(!1)),className:"rounded-md bg-blue-600 px-2.5 py-1.5 text-sm text-white hover:bg-blue-700 disabled:cursor-not-allowed disabled:bg-blue-400",children:g?e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(k,{className:"h-3 w-3",innerFill:"white",isDualRing:!1})," ","Saving .."]}):"Save Changes"}),e.jsx("button",{onClick:d,className:"rounded-md bg-gray-600 px-2.5 py-1.5 text-sm text-white hover:bg-gray-700",children:"Cancel"})]})]}),e.jsx("div",{id:"resource-svg-wrap",ref:i,className:"px-4"}),u&&e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(k,{isDualRing:!1,className:"mb-4 mt-2 h-4 w-4 animate-spin fill-blue-600 text-gray-200 sm:h-8 sm:w-8"})})]})})})}export{V as S,W as U};
