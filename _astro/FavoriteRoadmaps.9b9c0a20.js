import{j as e}from"./jsx-runtime.6940b965.js";import{r as c}from"./index.070054a4.js";import{C as f}from"./CheckIcon.1124cdab.js";import{a as b}from"./http.387f5009.js";import{MarkFavorite as w}from"./MarkFavorite.93211abf.js";import{S as I}from"./Spinner.799b0955.js";import{CreateRoadmapButton as C}from"./CreateRoadmapButton.7753f04b.js";import{C as N}from"./CreateRoadmapModal.4f9f6a65.js";import{M as T}from"./map.07b8754f.js";import{i as E}from"./jwt.ab9b7b25.js";import"./popup.a359f713.js";import"./use-toast.fb52de5d.js";import"./toast.1fe7142d.js";import"./index.a98c85f5.js";import"./classname.585fc13a.js";import"./plus.cedba9fe.js";import"./createLucideIcon.3c9fdece.js";import"./roadmap.9c1903ec.js";import"./use-outside-click.d7ce4a3d.js";import"./use-keydown.bb1f91bb.js";import"./index.3e34842a.js";function S(n){const{title:r="Start learning ..",message:a="Your progress and favorite roadmaps will show up here."}=n;return e.jsxs("div",{className:"relative flex min-h-full flex-col items-start sm:items-center justify-center py-6",children:[e.jsxs("h2",{className:"mb-1 flex items-center text-lg sm:text-2xl text-gray-200",children:[e.jsx(f,{additionalClasses:"mr-2 top-[0.5px] w-[16px] h-[16px] sm:w-[20px] sm:h-[20px]"}),"Start learning .."]}),e.jsx("p",{className:"text-gray-400 text-sm sm:text-base",children:a})]})}function u(n){const{url:r,percentageDone:a,resourceType:s,resourceId:l,resourceTitle:i,isFavorite:t,allowFavorite:d=!0}=n;return e.jsxs("a",{href:r,className:"relative flex flex-col overflow-hidden rounded-md border border-slate-800 bg-slate-900 p-3 text-sm text-slate-400 hover:border-slate-600 hover:text-slate-300",children:[e.jsx("span",{className:"relative z-20",children:i}),e.jsx("span",{className:"absolute bottom-0 left-0 top-0 z-10 bg-[#172a3a]",style:{width:`${a}%`}}),d&&e.jsx(w,{resourceId:l,resourceType:s,favorite:t})]})}function x(n){const{isLoading:r=!1,title:a,icon:s}=n;return e.jsxs("p",{className:"mb-4 flex items-center text-sm text-gray-400",children:[!r&&s,r&&e.jsx("span",{className:"mr-1.5",children:e.jsx(I,{})}),a]})}function $(n){const{progress:r,isLoading:a=!1,customRoadmaps:s}=n,[l,i]=c.useState(!1);return e.jsxs("div",{className:"relative pb-12 pt-4 sm:pt-7",children:[l&&e.jsx(N,{onClose:()=>i(!1)}),e.jsx(x,{icon:e.jsx(f,{additionalClasses:"mr-1.5 h-[14px] w-[14px]"}),isLoading:a,title:"Your progress and favorite roadmaps."}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:r.map(t=>e.jsx(u,{resourceId:t.resourceId,resourceType:t.resourceType,resourceTitle:t.resourceTitle,isFavorite:t.isFavorite,percentageDone:(t.skipped+t.done)/t.total*100,url:t.resourceType==="roadmap"?`/${t.resourceId}`:`/best-practices/${t.resourceId}`},t.resourceId))}),e.jsxs("div",{className:"mt-5",children:[e.jsx(x,{icon:e.jsx(T,{className:"mr-1.5 h-[14px] w-[14px]"}),title:"Your custom roadmaps"}),s.length===0&&e.jsxs("p",{className:"rounded-md border border-dashed border-gray-800 p-2 text-sm text-gray-600",children:["You haven't created any custom roadmaps yet."," ",e.jsx("button",{className:"text-gray-500 underline underline-offset-2 hover:text-gray-400",onClick:()=>i(!0),children:"Create one!"})]}),s.length>0&&e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:[s.map(t=>e.jsx(u,{resourceId:t.resourceId,resourceType:"roadmap",resourceTitle:t.resourceTitle,percentageDone:(t.skipped+t.done)/t.total*100,url:`/r?id=${t.resourceId}`,allowFavorite:!1},t.resourceId)),e.jsx(C,{})]})]})]})}function F(n){n.forEach(r=>{const a=r.resourceType==="best-practice"?`/best-practices/${r.resourceId}`:`/${r.resourceId}`,s=document.querySelector(`a[href="${a}"]`);if(!s)return;window.dispatchEvent(new CustomEvent("mark-favorite",{detail:{resourceId:r.resourceId,resourceType:r.resourceType,isFavorite:r.isFavorite}}));const i=(r.done+r.skipped)/r.total*100,t=s.querySelector("[data-progress]");t&&(t.style.width=`${i}%`)})}function Z(){if(!E())return null;const[r,a]=c.useState(!0),[s,l]=c.useState(!0),[i,t]=c.useState([]),[d,h]=c.useState(0);function g(){const o=document.getElementById("hero-text");o&&(o.classList.add("opacity-0"),setTimeout(()=>{o.parentElement?.removeChild(o),a(!1),setTimeout(()=>{h(100)},50)},0))}async function m(){l(!0);const{response:o,error:y}=await b("https://api.roadmap.sh/v1-get-hero-roadmaps");y||!o||(t(o),l(!1),g(),F(o))}if(c.useEffect(()=>{m().finally(()=>{l(!1)})},[]),c.useEffect(()=>(window.addEventListener("refresh-favorites",m),()=>window.removeEventListener("refresh-favorites",m)),[]),r)return null;const p=i?.length>0,v=i?.filter(o=>o.isCustomResource),j=i?.filter(o=>!o.isCustomResource);return e.jsx("div",{className:`flex min-h-[192px] bg-gradient-to-b transition-opacity duration-500 sm:min-h-[280px] opacity-${d} ${p&&"border-t border-t-[#1e293c]"}`,children:e.jsxs("div",{className:"container min-h-full",children:[!s&&i?.length==0&&e.jsx(S,{}),p&&e.jsx($,{showCustomRoadmaps:!0,customRoadmaps:v,progress:j,isLoading:s})]})})}export{Z as FavoriteRoadmaps};
